<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="A community-maintained index of known ROS packages.
">

    <link rel="canonical" href="http://rosindex.github.io/p/rtt_actionlib/rosdistro/">
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">

    <script type="text/javascript" src="/js/jquery.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="/js/jquery-cookie-1.4.1/jquery.cookie.js" type="text/javascript"></script>

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">ROS Index</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <!--<a class="page-link" href="/p/rtt_actionlib/rosdistro/index.html"></a>-->
        <a class="page-link" href="/packages">Packages</a>
        <a class="page-link" href="/repos">Repositories</a>
        <a class="page-link" href="/search">Search</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin:20px">
  <div class="row">
    <ol class="breadcrumb">
      <li><a href="/">Home</a></li>
      <li><a href="/packages">Packages</a></li>
      <li><a href="/packages/rtt_actionlib">rtt_actionlib</a></li>
      <li class="active">rosdistro</li>
    </ol>
  </div>
  <div class="row">
    <div class="well well-sm">
  <table class="table-condensed">
    <tbody>
      <tr>
        <!--<td><span class="pull-right">description</span></td>-->
        <td>
          <h4>rtt_ros_integration <small></small></h4>
          
        </td>
      </tr>
      
        <tr>
          <td>
<div id="repo-switch" class="btn-group btn-group-justified" role="group">
  <div class="btn-group" role="group">
    <div class="dropdown">
      <! -- TODO: add disabled when only 1 version is known -->
      <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
        <span class="pull-left">
          <span class="glyphicon glyphicon-star"></span>
          rosdistro ( https://github.com/orocos/rtt_ros_integration.git )
        </span>
        <span class="pull-right"><span class="caret"></span></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        
          <li role="presentation">
          <a id="rosdistro" role="menuitem" tabindex="-1" href="/p/rtt_actionlib/rosdistro" data="rosdistro">
              <span class="glyphicon glyphicon-star"></span>
              rosdistro ( https://github.com/orocos/rtt_ros_integration.git )
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
</td>
        </tr>
      
      
        <tr>
          <td>
            

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
  <label id="indigo-option" class="distro-button btn btn-xs btn-default" href="#indigo" data="indigo">
      <input type="radio" name="options" id="indigo-radio" autocomplete="off"> indigo
    </label>
  
  <label id="hydro-option" class="distro-button btn btn-xs btn-primary" href="#hydro" data="hydro">
      <input type="radio" name="options" id="hydro-radio" autocomplete="off"> hydro
    </label>
  
  <label id="groovy-option" class="distro-button btn btn-xs btn-primary" href="#groovy" data="groovy">
      <input type="radio" name="options" id="groovy-radio" autocomplete="off"> groovy
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
    <input type="radio" name="options" autocomplete="off">
    <span id="older-label">Older</span>
    <span class="caret"></span>
  </label>
  <ul class="dropdown-menu" role="menu">
    
      <li data="fuerte" id="fuerte-option" class=" older-distro-option"  href="#fuerte">
      <a href="#fuerte" data="fuerte" id="fuerte-button">fuerte</a>
      </li>
    
      <li data="electric" id="electric-option" class=" older-distro-option"  href="#electric">
      <a href="#electric" data="electric" id="electric-button">electric</a>
      </li>
    
      <li data="diamondback" id="diamondback-option" class="disabled older-distro-option"  href="#diamondback">
      <a href="#diamondback" data="diamondback" id="diamondback-button">diamondback</a>
      </li>
    
      <li data="c-turtle" id="c-turtle-option" class="disabled older-distro-option"  href="#c-turtle">
      <a href="#c-turtle" data="c-turtle" id="c-turtle-button">c-turtle</a>
      </li>
    
  </ul>
</div>
</div>

          </td>
        </tr>
      
    </tbody>
  </table>
</div>

  </div>
  <div class="row">
    
      <div class="distro distro-indigo">
        
        <em>No branch for distro <strong>indigo</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-hydro">
        
          
          <div class="panel panel-default">
            <div class="panel-heading">README</div>
            <div class="readme-" style="margin: 20px">
              <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="rendered-markdown">
<h1>RTT Actionlib</h1>

<p>Actionlib action servers provide the following interfaces, and actionlib action
clients reciprocate:
* Inputs:
  * Goal topic
  * Cancel topic
* Outputs: 
  * Status topic
  * Feedback topic
  * Result topic (per goal)</p>

<p>For an Orocos RTT component to provide an actionlib interface, it needs to
provide the topics described above. In order to expose actionlib interfaces
to components running in real-time threads, we should use the rtt data ports
to connect to these topics. In order to make it easy to connect these ports,
this package provides a C++ API for constructing the appropriate RTT data ports
and an RTT service for connecting those ports to ROS topics if necessary.</p>

<h2>Contents</h2>

<p>This package provides a C++ API and RTT service for constructing and connecting
several RTT ports to a ROS actionlib action namespace.</p>

<h3>Providng Actions from Orocos</h3>

<p>In the standard ROS actionlib server, subscribing and publishing ROS messages on
the actionlib topics are handled automatiaclly by the ActionServer class, and
users are meant to delegate to an instance of this class. ActionServer then
calls short-running "goal" and "cancel" callbacks when it receives the
appropriate messages. It is in these user-supplied callbacks that goal
handlesare set to be accepted/rejected or preempted, respectively. </p>

<p>The user sets the status of these handles by calling member functions
<code>setSucceeded()</code>, <code>setAborted()</code> etc. on the handles. These calls then call the
parent ActionServer's <code>publishResult()</code>,<code>publishStatus()</code> etc. member functions.
The "normal" ActionServer implements these functions with ROS publishers and
subscribers, but for RTT, we want these to use data ports.</p>

<p>To this end, we implement an RTTActionServer C++ class which inherits from
ActionServerBase and implements the "publish" functions with RTT data ports and
binds the goal and cancel callbacks to RTT event ports.</p>

<h3>Calling Actions from Orocos</h3>

<p>TBD</p>

<h2>Usage</h2>

<p>First the appropriate RTT ports need to be created in a given service (or
subservice) of a TaskContext. These can be easily creted by delegating to an
RTTActionServer. The RTTActionServer will create the necessary RTT ports and
bind them to the user-supplied callbacks. For example, to add an actionlib
interface to a given compnent, you could do something similar to the following:</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="k">class</span> <span class="nc">SomeComponent</span> <span class="o">:</span> <span class="k">public</span> <span class="n">RTT</span><span class="o">::</span><span class="n">TaskContext</span> <span class="p">{</span>
<span class="k">private</span><span class="o">:</span>

  <span class="c1">// Convenience typedefs</span>
  <span class="k">typedef</span> <span class="n">actionlib</span><span class="o">::</span><span class="n">ServerGoalHandle</span><span class="o">&lt;</span><span class="n">some_msgs</span><span class="o">::</span><span class="n">SomeAction</span><span class="o">&gt;</span> <span class="n">GoalHandle</span><span class="p">;</span>

  <span class="c1">// RTT action server</span>
  <span class="n">rtt_actionlib</span><span class="o">::</span><span class="n">RTTActionServer</span><span class="o">&lt;</span><span class="n">some_msgs</span><span class="o">::</span><span class="n">SomeAction</span><span class="o">&gt;</span> <span class="n">rtt_action_server_</span><span class="p">;</span>

<span class="k">public</span><span class="o">:</span>

  <span class="c1">// Component constructor</span>
  <span class="n">SomeComponent</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">name</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">TaskContext</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">RTT</span><span class="o">::</span><span class="n">PreOperational</span><span class="p">)</span>
  <span class="p">{</span> 
    <span class="c1">// Add action server ports to this task's root service</span>
    <span class="n">rtt_action_server_</span><span class="p">.</span><span class="n">addPorts</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">provides</span><span class="p">());</span>

    <span class="c1">// Bind action server goal and cancel callbacks (see below)</span>
    <span class="n">rtt_action_server_</span><span class="p">.</span><span class="n">registerGoalCallback</span><span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">SomeComponent</span><span class="o">::</span><span class="n">goalCallback</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">_1</span><span class="p">));</span>
    <span class="n">rtt_action_server_</span><span class="p">.</span><span class="n">registerCancelCallback</span><span class="p">(</span><span class="n">boost</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="o">&amp;</span><span class="n">SomeComponent</span><span class="o">::</span><span class="n">cancelCallback</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">_1</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="c1">// RTT start hook</span>
  <span class="kt">bool</span> <span class="n">startHook</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Start action server</span>
    <span class="n">rtt_action_server_</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// RTT update hook</span>
  <span class="kt">void</span> <span class="n">updateHook</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Pursue goal here</span>
  <span class="p">}</span>

  <span class="c1">// Called by rtt_action_server_ when a new goal is received</span>
  <span class="kt">void</span> <span class="n">goalCallback</span><span class="p">(</span><span class="n">GoalHandle</span> <span class="n">gh</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Accept/reject goal requests here</span>
  <span class="p">}</span>

  <span class="c1">// Called by rtt_action_server_ when a goal is cancelled / preempted</span>
  <span class="kt">void</span> <span class="n">cancelCallback</span><span class="p">(</span><span class="n">GoalHandle</span> <span class="n">gh</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Handle preemption here</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div>
<p>Second, the ports need to be connected to ROS topics. This can either be done
in C++ with hard-coded action topic names, or with the "actionlib" RTT service
similarly to the following:</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">## Imports</span>
<span class="n">import</span><span class="p">(</span><span class="s">"rtt_ros"</span><span class="p">);</span>
<span class="n">ros</span><span class="o">.</span><span class="n">import</span><span class="p">(</span><span class="s">"rtt_actionlib"</span><span class="p">);</span>

<span class="c">## Load some application-specific component</span>
<span class="n">loadComponent</span><span class="p">(</span><span class="s">"some_component_name"</span><span class="p">,</span><span class="s">"some_component_package::SomeComponent"</span><span class="p">)</span>

<span class="c">## Load the actionlib service</span>
<span class="n">loadService</span><span class="p">(</span><span class="s">"some_component_name"</span><span class="p">,</span><span class="s">"actionlib"</span><span class="p">)</span>

<span class="c">## Connect an actionlib interface to the task's root service</span>
<span class="c">## This requires that the following ports exist with directions (server/client):</span>
<span class="c">##  some_component_name._action_goal (in/out)</span>
<span class="c">##  some_component_name._action_cancel (in/out)</span>
<span class="c">##  some_component_name._action_status (out/in)</span>
<span class="c">##  some_component_name._action_result (out/in)</span>
<span class="c">##  some_component_name._action_feedback (out/in)</span>
<span class="c">## These ports can be created by the RTTActionServer or RTTActionClient.</span>

<span class="n">some_component_name</span><span class="o">.</span><span class="n">actionlib</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">"/some/ros/namespace/my_action"</span><span class="p">)</span>

<span class="c">## Alternatively, connect an actionlib interface to a provided sub-service:</span>

<span class="n">some_component_name</span><span class="o">.</span><span class="n">actionlib</span><span class="o">.</span><span class="n">connectSub</span><span class="p">(</span>
  <span class="s">"some_prov.ided_service"</span><span class="p">,</span>
  <span class="s">"/some/ros/namespace/my_other_action"</span><span class="p">)</span>
</code></pre></div>
<h2>Future Work</h2>

<ul>
<li>Add operation to actionlib service which connects goal/cancel callbacks to
given RTT operations so that any RTT component with operations with the right
types can be bound to an actionlib service</li>
<li>Add action client support.</li>
<li>Add a "simple" mode which implememnts a policy like SimpleActionServer</li>
</ul>
</div></body></html>

            </div>
          </div>
        
      </div>
    
      <div class="distro distro-groovy">
        
        <em>No branch for distro <strong>groovy</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-fuerte">
        
        <em>No branch for distro <strong>fuerte</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-electric">
        
        <em>No branch for distro <strong>electric</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-diamondback">
        
        <em>No branch for distro <strong>diamondback</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-c-turtle">
        
        <em>No branch for distro <strong>c-turtle</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
  </div>
</div>

<script src="/js/distro_switch.js"></script>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>ROS Index</li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/rosindex">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">rosindex</span>
            </a>
          </li>
          

        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">A community-maintained index of known ROS packages.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
