<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="A community-maintained index of known ROS packages.
">

    <link rel="canonical" href="http://rosindex.github.io/p/rtt_rosclock/rosdistro/">
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">

    <script type="text/javascript" src="/js/jquery.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="/js/jquery-cookie-1.4.1/jquery.cookie.js" type="text/javascript"></script>

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">ROS Index</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <!--<a class="page-link" href="/p/rtt_rosclock/rosdistro/index.html"></a>-->
        <a class="page-link" href="/packages">Packages</a>
        <a class="page-link" href="/repos">Repositories</a>
        <a class="page-link" href="/search">Search</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin:20px">
  <div class="row">
    <ol class="breadcrumb">
      <li><a href="/">Home</a></li>
      <li><a href="/packages">Packages</a></li>
      <li><a href="/packages/rtt_rosclock">rtt_rosclock</a></li>
      <li class="active">rosdistro</li>
    </ol>
  </div>
  <div class="row">
    <div class="well well-sm">
  <table class="table-condensed">
    <tbody>
      <tr>
        <!--<td><span class="pull-right">description</span></td>-->
        <td>
          <h4>rtt_ros_integration <small></small></h4>
          
        </td>
      </tr>
      
        <tr>
          <td>
<div id="repo-switch" class="btn-group btn-group-justified" role="group">
  <div class="btn-group" role="group">
    <div class="dropdown">
      <! -- TODO: add disabled when only 1 version is known -->
      <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
        <span class="pull-left">
          <span class="glyphicon glyphicon-star"></span>
          rosdistro ( https://github.com/orocos/rtt_ros_integration.git )
        </span>
        <span class="pull-right"><span class="caret"></span></span>
      </button>
      <ul class="dropdown-menu" role="menu">
        
          <li role="presentation">
          <a id="rosdistro" role="menuitem" tabindex="-1" href="/p/rtt_rosclock/rosdistro" data="rosdistro">
              <span class="glyphicon glyphicon-star"></span>
              rosdistro ( https://github.com/orocos/rtt_ros_integration.git )
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
</td>
        </tr>
      
      
        <tr>
          <td>
            

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
  <label id="indigo-option" class="distro-button btn btn-xs btn-default" href="#indigo" data="indigo">
      <input type="radio" name="options" id="indigo-radio" autocomplete="off"> indigo
    </label>
  
  <label id="hydro-option" class="distro-button btn btn-xs btn-primary" href="#hydro" data="hydro">
      <input type="radio" name="options" id="hydro-radio" autocomplete="off"> hydro
    </label>
  
  <label id="groovy-option" class="distro-button btn btn-xs btn-primary" href="#groovy" data="groovy">
      <input type="radio" name="options" id="groovy-radio" autocomplete="off"> groovy
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
    <input type="radio" name="options" autocomplete="off">
    <span id="older-label">Older</span>
    <span class="caret"></span>
  </label>
  <ul class="dropdown-menu" role="menu">
    
      <li data="fuerte" id="fuerte-option" class=" older-distro-option"  href="#fuerte">
      <a href="#fuerte" data="fuerte" id="fuerte-button">fuerte</a>
      </li>
    
      <li data="electric" id="electric-option" class=" older-distro-option"  href="#electric">
      <a href="#electric" data="electric" id="electric-button">electric</a>
      </li>
    
      <li data="diamondback" id="diamondback-option" class="disabled older-distro-option"  href="#diamondback">
      <a href="#diamondback" data="diamondback" id="diamondback-button">diamondback</a>
      </li>
    
      <li data="c-turtle" id="c-turtle-option" class="disabled older-distro-option"  href="#c-turtle">
      <a href="#c-turtle" data="c-turtle" id="c-turtle-button">c-turtle</a>
      </li>
    
  </ul>
</div>
</div>

          </td>
        </tr>
      
    </tbody>
  </table>
</div>

  </div>
  <div class="row">
    
      <div class="distro distro-indigo">
        
        <em>No branch for distro <strong>indigo</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-hydro">
        
          
          <div class="panel panel-default">
            <div class="panel-heading">README</div>
            <div class="readme-" style="margin: 20px">
              <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="rendered-markdown">
<h1>RTT ROSClock</h1>

<p>This package contains helpful functions for measuring time according to
different sources on a realtime operating system. </p>

<p>When running Orocos components in a ROS network, it's important to keep
time synchronized between different machines. If you use the standard
<code>RTT::TimeService</code> calls to query time, this might be <strong>tens of seconds</strong>
different from the NTP-corrected time and any timestamped messages published
to ROS will be dramatically delayed.</p>

<p>To avoid these problems while staying realtime-safe (and portable), you can 
use the <code>rtt_rosclock::host_now()</code> function to get a ROS time structure
that uses the <code>CLOCK_HOST_REALTIME</code> realtime time source on a Xenomai system. 
On a gnu/linux system, this call will just return the result of the standard
<code>ros::Time::now()</code> function.</p>

<h3>Use host_now() for broadcasting ROS Header Stamps</h3>

<p>The <code>rtt_rosclock::host_now()</code> function is the time source that should always be used
with ROS header timestamps because it is the time that you want to use to
broadcast ROS messages to other machines or processes. It is assumed that
if the <code>/clock</code> topic is active, then any ROS messages broadcasted are
based on that time source.</p>

<p>When compiled against Xenomai and not running in simulation mode, this function
will return the NTP-synchronized clock time via the <code>CLOCK_HOST_REALTIME</code> clock
source. <em>Note that this is only supported under Xenomai 2.6 and above.</em></p>

<p>When <strong>not</strong> compiled against Xenomai and not running in simulation mode, it is
a pass-through to <code>ros::Time::now()</code>.</p>

<p>When running in simulation mode, this will always use the simulation clock,
which is based off of the ROS <code>/clock</code> topic. It is a pass-through to
<code>rtt_rosclock::rtt_now()</code>.</p>

<h3>RTT Services</h3>

<h4>Clock Service</h4>

<p>The "rosclock" RTT service also provides a sub-service of the global "ros"
service called "ros.clock" which provides the following operations:</p>

<ul>
<li>
<code>ros::Time ros.clock.host_now(void)</code> Get a ROS time structure from the NTP-adjusted realtime clock or the sim clock.</li>
<li>
<code>ros::Time ros.clock.host_wall_now(void)</code> Get a ROS time structure from the NTP-adjusted realtime clock or the wall clock.</li>
<li>
<code>ros::Time ros.clock.rtt_now(void)</code> Get a ROS time structure from the RTT clock or the sim clock.</li>
<li>
<code>ros::Time ros.clock.rtt_wall_now(void)</code> Get a ROS time structure from the RTT wall clock.</li>
<li>
<code>RTT::Seconds ros.clock.host_offset_from_rtt(void)</code> Get the differences from the RTT wall clock source to the NTP-adjusted realtime clock source.</li>
</ul>
<h4>C++ API</h4>

<p>The calls are also available via the <code>rtt_rosclock/rtt_rosclock.h</code> header:</p>

<ul>
<li><code>ros::Time rtt_rosclock::host_now(void)</code></li>
<li><code>ros::Time rtt_rosclock::host_wall_now(void)</code></li>
<li><code>ros::Time rtt_rosclock::rtt_now(void)</code></li>
<li><code>ros::Time rtt_rosclock::rtt_wall_now(void)</code></li>
<li><code>RTT::Seconds rtt_rosclock::host_offset_from_rtt(void)</code></li>
</ul>
<h3>Simulation Clock Activity</h3>

<p>This package also provides an RTT <code>SimClockActivity</code> which will periodically execute
a task subject to the progression of a simulated clock source. This clock source can
either be the ROS <code>/clock</code> topic if it exists and the <code>/use_sim_time</code> parameter is
set to <code>true</code>, or it can use a manual time update from some other in-process source.</p>

<p>The simulation clock activity is implemented with three classes:</p>

<ul>
<li>
<code>SimClockActivity</code> The actual activity which executes a given task.</li>
<li>
<code>SimClockActivityManager</code> A singleton class which is responsible for
coordinating execution of all <code>SimClockActivity</code> periodically (subject to
their minimum desired periods).</li>
<li>
<code>SimClockThread</code> A singleton thread which is responsible for the acutal
updates to the <code>RTT::os::TimeService</code> and optinally subscribing to ROS
messages on the <code>/clock</code> topic.</li>
</ul>
<p>By default, <code>SimClockThread</code> is not running, but when it is started, it will
override the normal RTT <code>TimeService</code> and update it based on the update rate of
whatever <code>SimClockThread</code> is using as a clock source.</p>

<h4>Usage</h4>

<p>The <code>SimClockActivity</code> is used similarly to the <code>RTT::PeriodicActivity</code>. Once
the <code>rtt_rosclock</code> service plugin has been loaded, you can set a number of
tasks' activities to SimClockActivities, set the clock source, and then enable
the <code>SimClockThread</code>.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">import</span><span class="p">(</span><span class="s">"rtt_ros"</span><span class="p">);</span>
<span class="n">ros</span><span class="p">.</span><span class="n">import</span><span class="p">(</span><span class="s">"rtt_rosclock"</span><span class="p">);</span>

<span class="c1">// ... create components ...</span>

<span class="n">my_component_1</span><span class="p">.</span><span class="n">setPeriod</span><span class="p">(</span><span class="mf">0.01</span><span class="p">);</span>
<span class="n">my_component_2</span><span class="p">.</span><span class="n">setPeriod</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>

<span class="c1">// Set simulation clock activities</span>
<span class="n">ros</span><span class="p">.</span><span class="n">clock</span><span class="p">.</span><span class="n">setSimClockActivity</span><span class="p">(</span><span class="n">my_component_1</span><span class="p">);</span>
<span class="n">ros</span><span class="p">.</span><span class="n">clock</span><span class="p">.</span><span class="n">setSimClockActivity</span><span class="p">(</span><span class="n">my_component_2</span><span class="p">);</span>

<span class="c1">// Set the SimClockThread to use the ROS /clock topic for time</span>
<span class="n">ros</span><span class="p">.</span><span class="n">clock</span><span class="p">.</span><span class="n">useROSClockTopic</span><span class="p">();</span>

<span class="c1">// Start simulation clock thread and override RTT clock</span>
<span class="n">ros</span><span class="p">.</span><span class="n">clock</span><span class="p">.</span><span class="n">enableSim</span><span class="p">();</span>
</code></pre></div>
</div></body></html>

            </div>
          </div>
        
      </div>
    
      <div class="distro distro-groovy">
        
        <em>No branch for distro <strong>groovy</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-fuerte">
        
        <em>No branch for distro <strong>fuerte</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-electric">
        
        <em>No branch for distro <strong>electric</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-diamondback">
        
        <em>No branch for distro <strong>diamondback</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
      <div class="distro distro-c-turtle">
        
        <em>No branch for distro <strong>c-turtle</strong>. Known supported distros are highlighted in the buttons above.</em>
        
      </div>
    
  </div>
</div>

<script src="/js/distro_switch.js"></script>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>ROS Index</li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/rosindex">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">rosindex</span>
            </a>
          </li>
          

        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">A community-maintained index of known ROS packages.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
