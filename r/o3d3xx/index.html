<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    <link rel="canonical" href="http://rosindex.github.io/r/o3d3xx/">
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    <script type="text/javascript" src="/js/jquery.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="/js/jquery-cookie-1.4.1/jquery.cookie.js" type="text/javascript"></script>

    <script type="text/javascript" src="/js/ga.js"></script>
    <script type="text/javascript" src="/js/toc.js"></script>

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">


        <div class="col-sm-12 col-md-9" style="margin-top: 8px">
          <div class="row">
            <!-- title -->
            <div class="col-xs-12 col-sm-3 col-md-3" style="white-space:nowrap;">
              <a class="site-title" href="/">ROS Index</a> <sup><a href="https://github.com/rosindex/rosindex.github.io/issues/new" style="vertical-align:super;" class="label label-warning" target="_blank">BETA</a></sup>
            </div>

            <!-- main links -->
            <div class="col-xs-12 col-sm-9 col-md-9 text-right">
              <a class="btn btn-link" href="/about">About</a>
              <a class="btn btn-link" href="/packages">Packages</a>
              <a class="btn btn-link" href="/repos">Repos</a>
              <a class="btn btn-link" href="/contribute">Contribute</a>
              <a class="btn btn-link" href="/stats">Stats</a>
            </div>
          </div>
        </div>

        <!-- searchbox -->
        <div class="col-sm-12 col-md-3" style="margin-top: 12px">
          <form action="/search/" role="form">
            <div class="input-group input-group-sm">
              <input type="text" class="form-control" name="q" placeholder="Search">
              <span class="input-group-btn">
                <button class="btn btn-default btn-sm" type="submit"><span class="glyphicon glyphicon-search"></span></button>
              </span>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--
    <a class="site-title" href="/">ROS Index</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/packages">Packages</a>
        <a class="page-link" href="/repos">Repositories</a>
        <a class="page-link" href="/search">Search</a>
      </div>
    </nav>
    -->

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">o3d3xx</li>
        <!--<li class="active">o3d3xx</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="jade-option" class="distro-button btn btn-xs btn-default" href="#jade" data="jade">
      <input type="radio" name="options" id="jade-radio" autocomplete="off"> jade
    </label>
  
    <label id="indigo-option" class="distro-button btn btn-xs btn-primary" href="#indigo" data="indigo">
      <input type="radio" name="options" id="indigo-radio" autocomplete="off"> indigo
    </label>
  
    <label id="hydro-option" class="distro-button btn btn-xs btn-default" href="#hydro" data="hydro">
      <input type="radio" name="options" id="hydro-radio" autocomplete="off"> hydro
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-default" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="groovy" id="groovy-option" class="disabled older-distro-option"  href="#groovy">
          <a href="#groovy" data="groovy" id="groovy-button">groovy</a>
        </li>
      
        <li data="fuerte" id="fuerte-option" class="disabled older-distro-option"  href="#fuerte">
          <a href="#fuerte" data="fuerte" id="fuerte-button">fuerte</a>
        </li>
      
        <li data="electric" id="electric-option" class="disabled older-distro-option"  href="#electric">
          <a href="#electric" data="electric" id="electric-button">electric</a>
        </li>
      
        <li data="diamondback" id="diamondback-option" class="disabled older-distro-option"  href="#diamondback">
          <a href="#diamondback" data="diamondback" id="diamondback-button">diamondback</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
    <div class="row">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/o3d3xx">o3d3xx</a> <small>repository</small></h3>
        
      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 50px">
          <a type="button" class="btn btn-xs btn-default" data-toggle="tooltip" data-placement="left" title="View Instances" 
            href="/repos/o3d3xx"><span class="glyphicon glyphicon-th"></span></a>
        </div>
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-lovepark-o3d3xx-ros
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-lovepark-o3d3xx-ros" role="menuitem" tabindex="-1" href="/r/o3d3xx/github-lovepark-o3d3xx-ros" data="github-lovepark-o3d3xx-ros">
                    <span class="glyphicon glyphicon-star"></span>
                    github-lovepark-o3d3xx-ros
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

    </div>
  </div>
</div>


  <div class="distro distro-jade">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jade</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-indigo">
    <div class="container-fluid">
      
        <div class="panel panel-default">
          
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/lovepark/o3d3xx-ros.git">https://github.com/lovepark/o3d3xx-ros.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">master</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2014-12-09
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNMAINTAINED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-default">UNRELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/o3d3xx/github-lovepark-o3d3xx-ros">o3d3xx</a></td>
                    <td>0.1.0</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="rendered-markdown">
<h1 id="o3d3xx-ros">o3d3xx-ros</h1>

<p>o3d3xx-ros is a wrapper around
<a href="https://github.com/lovepark/libo3d3xx">libo3d3xx</a> enabling the usage of IFM
Efector O3D3xx ToF cameras from within <a href="http://ros.org">ROS</a> software
systems.</p>

<h2 id="software-compatibility-matrix">Software Compatibility Matrix</h2>

<table>
<tr>
<th>libo3d3xx version</th>
               <th>o3d3xx-ros</th>
               <th>ROS distribution</th>
         </tr>
<tr>
<td>0.1.3</td>
             <td>0.1.0</td>
             <td>Indigo</td>
         </tr>
</table>
<h2 id="prerequisites">Prerequisites</h2>

<ol>
<li><a href="http://www.ubuntu.com">Ubuntu 14.04</a></li>
<li><a href="http://wiki.ros.org/indigo">ROS Indigo</a></li>
<li><a href="https://github.com/lovepark/libo3d3xx">libo3d3xx</a></li>
</ol>
<p>Additionally, your compiler must support C++11. This package was initially
developed and tested using g++ 4.8.2 on Ubuntu 14.04 LTS. This is the stock
gcc-based C++ compiler on Ubuntu 14.04.</p>

<h2 id="building-and-installing-the-software">Building and Installing the Software</h2>

<p><strong>NOTE</strong>: Since we are talking about ROS here, we assume you are on Ubuntu
Linux.</p>

<p>You should first ensure that you have installed ROS by following
<a href="http://wiki.ros.org/ROS/Installation">these</a> instructions. The
<code>desktop-full</code> installation is highly recommended.</p>

<p>Next, you should be sure to install
<a href="https://github.com/lovepark/libo3d3xx">libo3d3xx</a>. This ROS package assumes
you have installed libo3d3xx via the supported debian installer. Step-by-step
instructions for that process now follows:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ git clone https://github.com/lovepark/libo3d3xx.git
$ cd libo3d3xx
$ mkdir build
$ cd build
$ cmake ..
$ make
$ make check
$ make package
$ sudo dpkg -i libo3d3xx_0.1.3_amd64.deb
</code></pre></div>
<p><strong>NOTE</strong>: The version string in the deb file may be different based upon the
version of libo3d3xx that you are building.</p>

<p>If everything above went successfully, you should have libo3d3xx installed at
<code>/opt/libo3d3xx</code>. Per the libo3d3xx README, it is also recommended that you add
the following to your <code>~/.bash_profile</code>:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">if [ -f /opt/libo3d3xx/etc/setup.bash ]; then
    source /opt/libo3d3xx/etc/setup.bash
fi
</code></pre></div>
<p>We now move on to building o3d3xx-ros.</p>

<p>Building and installing o3d3xx-ros is accomplished by utilizing the ROS
<a href="http://wiki.ros.org/catkin">catkin</a> tool. There are many tutorials and other
pieces of advice available on-line advising how to most effectively utilize
catkin. However, the basic idea is to provide a clean separation between your
source code repository and your build and runtime environments. The
instructions that now follow represent how we choose to use catkin to build and
<em>permanently install</em> a ROS package from source.</p>

<p>First, we need to decide where we want our software to ultimately be
installed. For purposes of this document, we will assume that we will install
our ROS packages at <code>~/ros</code>. For convenience, we add the following to our
<code>~/.bash_profile</code>:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">if [ -f /opt/ros/indigo/setup.bash ]; then
    source /opt/ros/indigo/setup.bash
fi

cd ${HOME}

export LPR_ROS=${HOME}/ros

if [ -d ${LPR_ROS} ]; then
    for i in $(ls ${LPR_ROS}); do
        if [ -d ${LPR_ROS}/${i} ]; then
            if [ -f ${LPR_ROS}/${i}/setup.bash ]; then
                source ${LPR_ROS}/${i}/setup.bash --extend
            fi
        fi
    done
fi
</code></pre></div>
<p>Next, we need to get the code from github. We assume we keep all of our git
repositories in <code>~/dev</code>.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ cd ~/dev
$ git clone https://github.com/lovepark/o3d3xx-ros.git
</code></pre></div>
<p>We now have the code in <code>~/dev/o3d3xx-ros</code>. Next, we want to create a <em>catkin
workspace</em> that we can use to build and install that code from. It is the
catkin philosophy that we do not do this directly in the source directory.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ cd ~/dev
$ mkdir o3d3xx-catkin
$ cd o3d3xx-catkin
$ mkdir src
$ cd src
$ catkin_init_workspace
$ ln -s ~/dev/o3d3xx-ros o3d3xx
</code></pre></div>
<p>So, you should have a catkin workspace set up to build the o3d3xx-ros code that
looks basically like:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">[ ~/dev/o3d3xx-catkin/src ]
tpanzarella@jelly: $ pwd
/home/tpanzarella/dev/o3d3xx-catkin/src

[ ~/dev/o3d3xx-catkin/src ]
tpanzarella@jelly: $ ls -l
total 0
lrwxrwxrwx 1 tpanzarella tpanzarella 49 Dec  2 15:26 CMakeLists.txt -&gt; /opt/ros/indigo/share/catkin/cmake/toplevel.cmake
lrwxrwxrwx 1 tpanzarella tpanzarella 32 Dec  2 15:24 o3d3xx -&gt; /home/tpanzarella/dev/o3d3xx-ros
</code></pre></div>
<p>Now we are ready to build the code:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ cd ~/dev/o3d3xx-catkin
$ catkin_make -DCMAKE_INSTALL_PREFIX=${LPR_ROS}/o3d3xx
$ catkin_make install
</code></pre></div>
<p>The ROS package should now be installed in <code>~/ros/o3d3xx</code>. To test everything
out you should open a fresh bash shell, and start up a ROS core:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ roscore
</code></pre></div>
<p>Open another shell and start the primary camera node:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ roslaunch o3d3xx camera.launch ip:=192.168.10.69
</code></pre></div>
<p><strong>NOTE</strong>: The IP address of your camera may differ. If you are using the
factory default (192.168.0.69), you do not need to specify it on the above
<code>roslaunch</code> line.</p>

<p>Open another shell and start the rviz node to visualize the data coming from
the camera:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ optirun roslaunch o3d3xx rviz.launch
</code></pre></div>
<p><strong>NOTE</strong>: You will likely not need to specify the <code>optirun</code> piece of the above
command. We utilize that to manage an Optimus-based NVIDIA GPU via the linux
<code>bumblebee</code> package.</p>

<p>At this point, you should see an rviz window that looks something like:</p>

<p><img src="https://raw.githubusercontent.com//lovepark/o3d3xx-ros/master//doc/figures/rviz1.png" alt="rviz1"></p>

<p>Congratulations! You can now utilize o3d3xx-ros.</p>

<h2 id="nodes">Nodes</h2>

<h3 id="/o3d3xx/camera">/o3d3xx/camera</h3>

<p>This node provides a real-time feed to the camera data. This node is started
from the primary <code>camera.launch</code> file:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ roslaunch o3d3xx camera.launch
</code></pre></div>
<p>The naming of the camera can be customized via the <code>ns</code> (namespace) and <code>nn</code>
(node name) command line arguments passed to the <code>camera.launch</code> file. For
example, if you specify your roslaunch command as:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ roslaunch o3d3xx camera.launch ns:=robot nn:=front_camera
</code></pre></div>
<p>The node will have the name <code>/robot/front_camera</code> in the ROS computation
graph.</p>

<h4 id="published-topics">Published Topics</h4>

<table>
<tr>
<th>Topic</th>
             <th>Message</th>
             <th>Description</th>
         </tr>
<tr>
<td>/o3d3xx/camera/amplitude</td>
             <td>sensor_msgs/Image</td>
             <td>16-bit gray scale encoding of the sensor Amplitude image </td>
         </tr>
<tr>
<td>/o3d3xx/camera/cloud</td>
             <td>sensor_msgs/PointCloud2</td>
             <td>
             A 3D PCL point cloud of point type `XYZI`. In this encoding the
             intensity channel is represented by the corresponding pixel's
             amplitude data. The units of this point cloud are in meters.
             </td>
         </tr>
<tr>
<td>/o3d3xx/camera/confidence</td>
             <td>sensor_msgs/Image</td>
             <td>
             An 8-bit mono image encoding of the confidence image. The meaning
             of each bit of each pixel value is discussed in the official IFM
             documentation for the camera.
             </td>
         </tr>
<tr>
<td>/o3d3xx/camera/depth</td>
             <td>sensor_msgs/Image</td>
             <td>
             A 16-bit mono image encoding of the radial depth map from the
             camera. The depth units are in millimeters.
             </td>
         </tr>
<tr>
<td>/o3d3xx/camera/depth_viz</td>
             <td>sensor_msgs/Image</td>
             <td>
             A rendering of the depth image utilizing a colormap more
             human-friendly for visualization purposes. For performance
             reasons, messages are only published to this topic when the
             `publish_viz_images` parameter is set to true at launch time.
             </td>
         </tr>
<tr>
<td>/o3d3xx/camera/good_bad_pixels</td>
             <td>sensor_msgs/Image</td>
             <td>
             A binary image showing good vs. bad pixels on the pixel array. Bad
             pixels can be caused by numerous reasons (e.g., motion blur over
             an integration/exposure timestep). Visualizing this data is useful
             for when you are tuning your imager parameters. For performance
             reasons, messages are only published to this topic when the
             `publish_viz_images` parameter is set to true at launch time.
             </td>
         </tr>
<tr>
<td>/o3d3xx/camera/hist</td>
             <td>sensor_msgs/Image</td>
             <td>
             An image showing gray level distribution of the pixels in the
             amplitude image. This is a simple way to visualize the dynamic
             range of the current imager settings. For performance
             reasons, messages are only published to this topic when the
             `publish_viz_images` parameter is set to true at launch time.
             </td>
         </tr>
</table>
<h4 id="advertised-services">Advertised Services</h4>

<table>
<tr>
<th>Service Name</th>
        <th>Service Definition</th>
        <th>Description</th>
    </tr>
<tr>
<td>/o3d3xx/camera/Config</td>
        <td><a href="srv/Config.srv">Config.srv</a></td>
        <td>
        Mutates camera settings based upon an input JSON file. <b>NOTE:</b> Due
        to what appears to be limitations in the YAML parsing of the stock ROS
        `rosservice` command line tool (i.e., it does not handle JSON as string
        payload well) you will have to use the
        <i>/o3d3xx/camera/config_node</i> to configure the camera. This is
        explained in further detail below.
        </td>
    </tr>
<tr>
<td>/o3d3xx/camera/Dump</td>
        <td><a href="srv/Dump.srv">Dump.srv</a></td>
        <td>
        Dumps the current configuration of the camera to a JSON string. The
        output of this dump is suitable for editing and passing to the `Config`
        service for configuring the camera.
        </td>
    </tr>
<tr>
<td>/o3d3xx/camera/GetVersion</td>
        <td><a href="srv/GetVersion.srv">GetVersion.srv</a></td>
        <td>
        Returns the current version of the underlying
        <a href="https://github.com/lovepark/libo3d3xx">libo3d3xx</a> library
        that this ROS node is linked to.
        </td>
    </tr>
<tr>
<td>/o3d3xx/camera/Rm</td>
        <td><a href="srv/Rm.srv">Rm.srv</a></td>
        <td>Removes an application from the camera. This service will restrict
        removing the current active application.
        </td>
    </tr>
</table>
<h4 id="parameters">Parameters</h4>

<table>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Description</th>
</tr>
<tr>
<td>ip</td>
        <td>string</td>
        <td>IP address of the camera</td>
    </tr>
<tr>
<td>xmlrpc_port</td>
        <td>int</td>
        <td>TCP port the camera's XMLRPC server is listening on</td>
    </tr>
<tr>
<td>password</td>
        <td>string</td>
        <td>Password to use to connect to the camera</td>
    </tr>
<tr>
<td>timeout_millis</td>
        <td>int</td>
        <td>Time, in milliseconds, to block when waiting for a frame from the
        camera before timing out.</td>
    </tr>
<tr>
<td>publish_viz_images</td>
        <td>bool</td>
        <td>
        In general, for a runtime system, the core data a system will want from
        this camera include the `cloud`, `depth`, `amplitude`, and `confidence`
        images. This node will always publish those data. However, if you set
        this parameter to `true` a few additional images are published. These
        are `depth_viz`, `good_bad_pixels`, and `hist` (they are described
        above in the `Topics` section). These <i>viz images</i> are intended
        for human analysis and visualization in `rviz`.
        </td>
    </tr>
</table>
<h3 id="/o3d3xx/camera_tf">/o3d3xx/camera_tf</h3>

<p>This node is of type <code>tf/static_transform_publisher</code>. It establishes a frame_id
for the camera in the global tf tree. This node is launched from the primary
<code>camera.launch</code> file:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ roslaunch o3d3xx camera.launch
</code></pre></div>
<p>When run as above, the tf publishing node would be named <code>/o3d3xx/camera_tf</code>
and the camera coordinate frame would be <code>/o3d3xx/camera_link</code> in the tf tree.</p>

<p>You can customize this naming (to an extent) via the <code>ns</code> (namespace) and <code>nn</code>
(node name) command line arguments passed to the <code>camera.launch</code> file. For
example, if you specify your roslaunch command as:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ roslaunch o3d3xx camera.launch ns:=robot nn:=front_camera
</code></pre></div>
<p>The node name will be <code>/robot/front_camera_tf</code> and the camera frame will
be <code>/robot/front_camera_link</code> in the tf tree.</p>

<h3 id="/o3d3xx/camera/config_node">/o3d3xx/camera/config_node</h3>

<p>This node is used as a proxy to simplify calling the <code>/o3d3xx/camera/Config</code>
service offered by the <code>/o3d3xx/camera</code> node. It was noted above that there
appears to be a limitation in the YAML parser of the ROS <code>rosservice</code> command
line tool. Specifically, it seems that it is not capable of assigning a JSON
string to a variable. This is the reason for this node. This is not a
long-running node but rather works like a typical command-line tool would: you
invoke it, it runs, and exits. The following command line will launch this
node:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ roslaunch o3d3xx config.launch
</code></pre></div>
<h4 id="parameters">Parameters</h4>

<table>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Description</th>
</tr>
<tr>
<td>infile</td>
        <td>string</td>
        <td>
        By default, this node will read `stdin` for a JSON string to use to
        pass to the `/o3d3xx/camera/Config` service. However, if this parameter
        is specified it will read the JSON from this file.
        </td>
    </tr>
</table>
<h3 id="/rviz">/rviz</h3>

<p>This package offers a launch script that wraps the execution of <code>rviz</code> so that
the display will be conveniently configured for visualizing the
<code>/o3d3xx/camera</code> data. To launch this node:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ optirun roslaunch o3d3xx rviz.launch
</code></pre></div>
<p><strong>NOTE</strong>: You will likely not need to specify the <code>optirun</code> piece of the above
command. We utilize that to manage an Optimus-based NVIDIA GPU via the linux
<code>bumblebee</code> package.</p>

<p>The rviz window should look something like:</p>

<p><img src="https://raw.githubusercontent.com//lovepark/o3d3xx-ros/master//doc/figures/rviz1.png" alt="rviz1"></p>

<h2 id="configuring-camera-settings">Configuring Camera Settings</h2>

<p>Configuring the camera is accomplished by passing a JSON string to the
<code>/o3d3xx/camera/config_node</code> which will call the <code>/o3d3xx/camera/Config</code>
service to mutate the camera settings. Using a JSON string to configure the
camera has the following primary benefits:</p>

<ol>
<li>Configuration is declarative. The camera configuration will reflect that
which is described by the JSON file.</li>
<li>The JSON data is human-consumable and easily edited in a text editor. This
makes it very convenient for headless embedded systems.</li>
<li>The JSON data is machine parsable, so configuring the camera on the fly via
programmable logic is also possible.</li>
</ol>
<p>There are also a few downfalls to using JSON. Most notably the lack of comments
and an enforceable schema. One could argue that the latter keeps things
flexible. None-the-less, JSON is the format used by <code>libo3d3xx</code> and, by
extension, this ROS package.</p>

<p>An exemplary JSON file is shown <a href="json/ex_camera.json">here</a> (this is the result
of calling the <code>/o3d3xx/camera/Dump</code> service on a development system). When
passing a JSON string (like the previously linked to file) to the
<code>/o3d3xx/camera/Config</code> service (or to the <code>/o3d3xx/camera/config_node</code>) the
following rules are used to configure the camera:</p>

<ol>
<li>The <code>Device</code> section is processed and saved on the camera.</li>
<li>The <code>Apps</code> section is processed. For each app:

<ol>
<li>If the <code>Index</code> key is present, a current app at that <code>Index</code> is looked
up. If present, it is edited to reflect the data in the JSON file. If an
app at that <code>Index</code> is not present, a new app is created with the
parameters from the JSON file. It is not guaranteed that the new app will
have the specified <code>Index</code>.</li>
<li>If the <code>Index</code> key is not present, a new app is created with the
parameters as specified in the JSON file.</li>
</ol>
</li>
<li>The active application is set by consulting the desired index of the
<code>ActiveApplication</code> from the <code>Device</code> section of the JSON. If the specified
<code>Index</code> does not exist, the active application is not set.</li>
<li>The <code>Net</code> section is processed. A reboot of the camera may be necessary
after changing the camera's network parameters. Additionally, you will
likely need to restart the <code>/o3d3xx/camera</code> node pointing it to the new IP
address (if that is what you changed).</li>
</ol>
<p>It should also be noted that any portion of the JSON tree can be specfied to
configure only that part of the camera. The only rule to follow is that all
keys should be fully qualified. For example, to simply set the active
application, you can use a JSON snippet like this:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{
    "o3d3xx":
    {
        "Device":
        {
            "ActiveApplication": "2"
        }
    }
}
</code></pre></div>
<p>The above snippet is provided as an example <a href="json/ex_set_active.json">here</a>. To
apply this to your camera, you can:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ roslaunch o3d3xx config.launch infile:=/path/to/ex_set_active.json
</code></pre></div>
<p>It was also noted above that the <code>/o3d3xx/camera/config_node</code> will read <code>stdin</code>
by default, so you could also:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ echo '{"o3d3xx":{"Device":{"ActiveApplication":"2"}}}' | roslaunch o3d3xx config.launch
</code></pre></div>
<p><a href="json/ex_add_app.json">Here</a> is another example JSON file. This one will add a
new application to the camera, using the default values for the high-dynamic
range imager. We note that this application is <em>added</em> to the camera because no
<code>Index</code> is specified for the application. If an <code>Index</code> were specfied, the
application at the specified <code>Index</code>, if present, would be edited to reflect
this configuration.</p>

<p>In general, a simple way to configure camera settings without having to
memorize the JSON syntax would be to simply dump the current camera settings to
a file:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ rosservice call /o3d3xx/camera/Dump &gt; /tmp/camera.json
</code></pre></div>
<p>Then, open <code>/tmp/camera.json</code> with a text editor to create a declarative JSON
configuration for your camera. You should be sure to delete the variable names
from the <code>rosservice</code> output if you are following this example
<em>word-for-word</em>. Additionally, you can delete any unnecessary keys if you would
like, however it is not strictly necessary as the <code>/o3d3xx/camera/Config</code>
service will leave unedited values unchanged on the camera. Once you have a
configuration that you like, you can:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ roslaunch o3d3xx config.launch infile:=/tmp/camera.json
</code></pre></div>
<p>You can check that your configuration is active by calling the
<code>/o3d3xx/camera/Dump</code> service again.</p>

<h2 id="todo">TODO</h2>

<p>Please see the <a href="https://github.com/lovepark/o3d3xx-ros/issues">Github Issues</a>.</p>

<h2 id="license">LICENSE</h2>

<p>Please see the file called LICENSE.</p>

<h2 id="authors">AUTHORS</h2>

<p>Tom Panzarella <a href="mailto:tom@loveparkrobotics.com">tom@loveparkrobotics.com</a></p>
</div></body></html>

            
          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-hydro">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>hydro</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-groovy">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>groovy</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-fuerte">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>fuerte</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-electric">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>electric</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-diamondback">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>diamondback</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script src="/js/distro_switch.js"></script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-4 col-md-4">
          
            <a href="https://github.com/rosindex">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>

            <span class="username">rosindex</span>
          </a>
          |
          <em>generated on 2015-01-30</em>
        
        </div>
        <div class="col-sm-8 col-md-8 text-right">
          <p class="text">a community-maintained index of robotics software
 | <a href="/privacy.txt">privacy</a></p>
        </div>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
