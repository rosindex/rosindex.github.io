<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ROS Index</title>
    <meta name="description" content="a community-maintained index of robotics software
">

    <link rel="canonical" href="http://rosindex.github.io/r/ardrone_autonomy/github-AutonomyLab-ardrone_autonomy/">
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/main.css">
    

    <script type="text/javascript" src="/js/jquery.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="/js/jquery-cookie-1.4.1/jquery.cookie.js" type="text/javascript"></script>

    <script type="text/javascript" src="/js/ga.js"></script>
    <script type="text/javascript" src="/js/toc.js"></script>

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="container-fluid" style="margin-bottom: 10px">
      <div class="row">


        <div class="col-sm-12 col-md-9" style="margin-top: 8px">
          <div class="row">
            <!-- title -->
            <div class="col-xs-12 col-sm-3 col-md-3" style="white-space:nowrap;">
              <a class="site-title" href="/">ROS Index</a> <sup><a href="https://github.com/rosindex/rosindex.github.io/issues/new" style="vertical-align:super;" class="label label-warning" target="_blank">BETA</a></sup>
            </div>

            <!-- main links -->
            <div class="col-xs-12 col-sm-9 col-md-9 text-right">
              <a class="btn btn-link" href="/about">About</a>
              <a class="btn btn-link" href="/packages">Packages</a>
              <a class="btn btn-link" href="/repos">Repos</a>
              <a class="btn btn-link" href="/contribute">Contribute</a>
              <a class="btn btn-link" href="/stats">Stats</a>
            </div>
          </div>
        </div>

        <!-- searchbox -->
        <div class="col-sm-12 col-md-3" style="margin-top: 12px">
          <form action="/search/" role="form">
            <div class="input-group input-group-sm">
              <input type="text" class="form-control" name="q" placeholder="Search">
              <span class="input-group-btn">
                <button class="btn btn-default btn-sm" type="submit"><span class="glyphicon glyphicon-search"></span></button>
              </span>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--
    <a class="site-title" href="/">ROS Index</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/packages">Packages</a>
        <a class="page-link" href="/repos">Repositories</a>
        <a class="page-link" href="/search">Search</a>
      </div>
    </nav>
    -->

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="container-fluid" style="margin-top:20px">
  <div class="container-fluid">
    <div class="row">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/repos">Repos</a></li>
        <li class="active">ardrone_autonomy</li>
        <!--<li class="active">ardrone_autonomy</li>-->
      </ol>
    </div>
    <div class="row">
      

<div id="distro-switch" class="btn-group btn-group-justified" data-toggle="buttons">
  
    <label id="jade-option" class="distro-button btn btn-xs btn-default" href="#jade" data="jade">
      <input type="radio" name="options" id="jade-radio" autocomplete="off"> jade
    </label>
  
    <label id="indigo-option" class="distro-button btn btn-xs btn-primary" href="#indigo" data="indigo">
      <input type="radio" name="options" id="indigo-radio" autocomplete="off"> indigo
    </label>
  
    <label id="hydro-option" class="distro-button btn btn-xs btn-primary" href="#hydro" data="hydro">
      <input type="radio" name="options" id="hydro-radio" autocomplete="off"> hydro
    </label>
  

  <!-- Older distros -->
  <div class="btn-group dropdown">
    <label type="button" class="btn btn-xs dropdown-toggle btn-primary" data-toggle="dropdown" id="older-distro-button">
        <input type="radio" name="options" autocomplete="off">
      <span id="older-label">Older</span>
      <span class="caret"></span>
    </label>
    <ul class="dropdown-menu" role="menu">
      
        <li data="groovy" id="groovy-option" class=" older-distro-option"  href="#groovy">
          <a href="#groovy" data="groovy" id="groovy-button">groovy</a>
        </li>
      
        <li data="fuerte" id="fuerte-option" class=" older-distro-option"  href="#fuerte">
          <a href="#fuerte" data="fuerte" id="fuerte-button">fuerte</a>
        </li>
      
        <li data="electric" id="electric-option" class="disabled older-distro-option"  href="#electric">
          <a href="#electric" data="electric" id="electric-button">electric</a>
        </li>
      
        <li data="diamondback" id="diamondback-option" class="disabled older-distro-option"  href="#diamondback">
          <a href="#diamondback" data="diamondback" id="diamondback-button">diamondback</a>
        </li>
      
    </ul>
  </div>
</div>

    </div>
    <div class="row">
      &nbsp;
    </div>
    <div class="row">
      <div class="well well-sm">
  <div>
    
  </div>
  
  <table class="table">
    <tr>
      <td width="100px" class="text-center">
        <img style="width: 80px;" src="/assets/repo.png">
      </td>
      <td>
        <h3><a style="text-decoration:none;" href="/r/ardrone_autonomy">ardrone_autonomy</a> <small>repository</small></h3>
        
      </td>
    </tr>
  </table>
  <div class="top-buffer">
    
    
<table class="table table-condensed instance-switch">
  <tr>
    <td>
      <div id="repo-switch" class="btn-group btn-group-justified" role="group">
        <div class="btn-group" style="width: 50px">
          <a type="button" class="btn btn-xs btn-default" data-toggle="tooltip" data-placement="left" title="View Instances" 
            href="/repos/ardrone_autonomy"><span class="glyphicon glyphicon-th"></span></a>
        </div>
        <div class="btn-group" style="width: 90%" role="group">
          <div class="dropdown">
            <!-- TODO: add disabled when only 1 version is known? -->
            <button class="btn btn-xs btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
              <span class="pull-left" style="width: 100%; text-align: left">
                <span class="pull-right"><span class="caret"></span></span> 
              <span class="glyphicon glyphicon-star"></span>
                  github-AutonomyLab-ardrone_autonomy
              </span>
            </button>
            <ul class="dropdown-menu" role="menu">
              
                <li role="presentation">
                  <a id="github-AutonomyLab-ardrone_autonomy" role="menuitem" tabindex="-1" href="/r/ardrone_autonomy/github-AutonomyLab-ardrone_autonomy" data="github-AutonomyLab-ardrone_autonomy">
                    <span class="glyphicon glyphicon-star"></span>
                    github-AutonomyLab-ardrone_autonomy
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    </td>
  </tr>
</table>

  </div>
  <div class="top-buffer">
  </div>
</div>

    </div>
  </div>
</div>


  <div class="distro distro-jade">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>jade</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-indigo">
    <div class="container-fluid">
      
        <div class="panel panel-default">
          
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/AutonomyLab/ardrone_autonomy.git">https://github.com/AutonomyLab/ardrone_autonomy.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">indigo-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2015-01-25
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNMAINTAINED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ardrone_autonomy/github-AutonomyLab-ardrone_autonomy">ardrone_autonomy</a></td>
                    <td>1.3.7</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="rendered-markdown">
<h1 id="ardrone_autonomy-:-a-ros-driver-for-ardrone-1.0-&amp;-2.0">ardrone_autonomy : A ROS Driver for ARDrone 1.0 &amp; 2.0</h1>

<p><a href="http://jenkins.ros.org/job/devel-indigo-ardrone_autonomy"><img src="http://jenkins.ros.org/buildStatus/icon?job=devel-indigo-ardrone_autonomy" alt=""></a></p>

<p>ardrone_autonomy is a <a href="http://ros.org/" title="Robot Operating System">ROS</a> driver for <a href="http://ardrone2.parrot.com/">Parrot AR-Drone</a> quadrocopter. This driver is based on official <a href="https://projects.ardrone.org/">AR-Drone SDK</a> version 2.0.1. The driver supports both AR-Drone 1.0 and 2.0. "ardrone_autonomy" is a fork of <a href="http://code.google.com/p/brown-ros-pkg/wiki/ardrone_brown">AR-Drone Brown</a> driver. This package has been developed in <a href="http://autonomy.cs.sfu.ca">Autonomy Lab</a> of <a href="http://www.sfu.ca">Simon Fraser University</a> by <a href="http://sfu.ca/%7Emmonajje">Mani Monajjemi</a> ( +other <a href="#contributors">contributors</a>).</p>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
<li><a href="#updates">Updates</a></li>
<li>
<a href="#installation">Installation</a>

<ul>
<li><a href="#binary-install">Binary Install</a></li>
<li><a href="#compile-and-install-from-source">Compile and Install from Source</a></li>
</ul>
</li>
<li><a href="#how-to-run">How to Run</a></li>
<li>
<a href="#reading-from-ar-drone">Reading from AR-Drone</a>

<ul>
<li><a href="#update-frequencies-new">Update Frequencies </a></li>
<li><a href="#legacy-navigation-data">Legacy Navigation Data</a></li>
<li><a href="#imu-data">IMU data</a></li>
<li><a href="#magnetometer-data">Magnetometer Data</a></li>
<li><a href="#selective-navdata-advanced-new">Selective Navdata (Advanced) </a></li>
<li><a href="#cameras">Cameras</a></li>
<li><a href="#tag-detection">Tag Detection</a></li>
<li><a href="#update-frequencies">Update Frequencies</a></li>
</ul>
</li>
<li>
<a href="#sending-commands-to-ar-drone">Sending Commands to AR-Drone</a>

<ul>
<li>
<a href="#hover-modes-new">Hover Modes </a> :new:</li>
</ul>
</li>
<li><a href="#coordinate-frames">Coordinate Frames</a></li>
<li>
<a href="#services">Services</a>

<ul>
<li><a href="#toggle-ar-drones-camera">Toggle AR-Drone's Camera</a></li>
<li><a href="#led-animations">LED Animations</a></li>
<li><a href="#flight-animations-new">Flight Animations </a></li>
<li><a href="#imu-calibration">IMU Calibration</a></li>
<li><a href="#flat-trim">Flat Trim</a></li>
<li>
<a href="#record-to-usb-stick">Record to USB Stick</a> :new:</li>
</ul>
</li>
<li>
<a href="#parameters">Parameters</a>

<ul>
<li><a href="#ar-drone-specific-parameters">AR-Drone Specific Parameters</a></li>
<li><a href="#other-parameters">Other Parameters</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
<li><a href="#contributors">Contributors</a></li>
<li>
<a href="#faq">FAQ</a> :new:</li>
</ul>
<h2 id="updates">Updates</h2>

<ul>
<li>
<em>September 3 2014</em>: 1.3.5 <a href="https://github.com/AutonomyLab/ardrone_autonomy/milestones/1.3.5">Bug Fixes &amp; Minor Improvements</a>
</li>
<li>
<em>March 14 2014</em>: The binary packages of the driver are now built on <a href="http://wiki.ros.org/BuildFarm">ROS build farm</a>. You can install the driver for ROS <em>Hydro</em> and <em>Groovy</em> using <code>apt-get</code> on <em>Ubuntu</em>.</li>
<li>
<em>January 17 2014</em>: Fully <em>catkinized</em> package (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/75">#75</a> &amp; <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/79">#79</a>). ARDroneLib has been configured to be built as an external project. The ARDroneLib is replaced by the vanilla SDK's stripped tarball. (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/80">More info</a>).</li>
<li>
<em>October 22 2013</em>: Update to Parrot SDK 2.0.1 (Fixes crashes on 2.4.x firmwares, no support for flight recorder (yet). <strong>Please check the FAQ section for instructions on how to re-compile the SDK</strong>. (Tested on 2.3.3 and 2.4.x firmwares) </li>
<li>
<em>February 13 2013</em>: Support for USB key recording (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/53">More info</a>). Motor PWM added to legacy Navdata.</li>
<li>
<em>January 9 2013</em>: ROS Groovy support. Support for zero-command without hovering (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/34">More info</a>). Full configurable Navdata support (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/31">More info</a>). Support for "Flight Animations". Support for Real-time navdata and video publishing (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/44">More info</a>). Support for configurable data publishing rate.</li>
<li>
<em>November 9 2012</em>: Critical Bug in sending configurations to drone fixed and more parameters are supported (<a href="https://github.com/AutonomyLab/ardrone_autonomy/issues/24">More info</a>). Separate topic for magnetometer data added (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/25">More info</a>).</li>
<li>
<em>September 5 2012</em>: Experimental automatic IMU bias removal.</li>
<li>
<em>August 27 2012</em>: Thread-safe SDK data access. Synchronized <code>navdata</code> and <code>camera</code> topics.</li>
<li>
<em>August 20 2012</em>: The driver is now provides ROS standard camera interface.</li>
<li>
<em>August 17 2012</em>: Experimental <code>tf</code> support added. New published topic <code>imu</code>.</li>
<li>
<em>August 1 2012</em>: Enhanced <code>Navdata</code> message. <code>Navdata</code> now includes magnetometer data, barometer data, temperature and wind information for AR-Drone 2. <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/2">Issue #2</a>
</li>
<li>
<em>July 27 2012</em>: LED Animation Support added to the driver as a service</li>
<li>
<em>July 19 2012</em>: Initial Public Release</li>
</ul>
<h2 id="installation">Installation</h2>

<h3 id="binary-install">Binary Install</h3>

<p>On supported <em>Ubuntu</em> platform and for ROS <em>Hydro</em> and <em>Groovy</em> you can install the driver using <code>apt-get install ros-*-ardrone-autonomy</code> e.g. <code>apt-get install ros-hydro-ardrone-autonomy</code>.</p>

<h3 id="compile-and-install-from-source">Compile and Install from Source</h3>

<p>The bundled AR-Drone SDK has its own build system which usually handles system wide dependencies itself. The ROS package depends on these standard ROS packages: <code>roscpp</code>, <code>image_transport</code>, <code>sensor_msgs</code>, <code>tf</code>, <code>camera_info_manager</code> and <code>std_srvs</code>.</p>

<p>The installation follows the same steps needed usually to compile a ROS driver using <a href="http://wiki.ros.org/catkin">catkin</a>. Clone (or download and unpack) the driver to the <code>src</code> folder of a new or existing catkin <a href="http://wiki.ros.org/catkin/Tutorials/create_a_workspace">workspace</a> (e.g <code>~/catkin_ws/src</code>) and use <code>catkin_make</code> to compile. Assuming you are compiling for ROS <em>Hydro</em>:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws/src
<span class="nv">$ </span>git clone https://github.com/AutonomyLab/ardrone_autonomy.git -b hydro-devel
<span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws
<span class="nv">$ </span>catkin_make
</code></pre></div>
<p>If you need to compile for older ROS distros or you are bound to use <code>rosbuild</code>, please check the <code>fuerte-devel</code> branch.</p>

<h2 id="how-to-run">How to Run</h2>

<p>The driver's executable node is <code>ardrone_driver</code>. You can either use <code>rosrun ardrone_autonomy ardrone_driver</code> or put it in a custom launch file with your desired parameters.</p>

<h2 id="reading-from-ar-drone">Reading from AR-Drone</h2>

<h3 id="update-frequencies-:new:">Update Frequencies :new:</h3>

<p><strong>Drone Update Frequencies</strong>: The drone's data transmission update frequency depends on <code>navdata_demo</code> parameter. When it is 1, the transmission frequency will be 15Hz, otherwise it will be 200Hz. (<code>navdata_demo</code> is a numeric parameter not Boolean, so use 1 and 0 (not True/False) to set/unset it)</p>

<p><strong>Driver Update Frequencies</strong>: The driver can operate in two modes: real-time or fixed rate. When the <code>realtime_navdata</code> parameter is set to True, the driver will publish the received information instantly. However when it is set to False, the driver will cache the most recent received data, then it will publish that at a fixed rate, configured by <code>looprate</code> parameter. The default configuration is: <code>realtime_navdata=False</code> and <code>looprate=50</code>. </p>

<p>Please note that if the <code>looprate</code> is smaller than the drone's transmission frequency, there will be data loss. The driver's start-up output shows the current configuration. You can also use <code>rostopic hz</code> command to check the publish rate of the driver.</p>

<pre>
# Default Setting - 50Hz non-realtime update, the drone transmission rate is 200Hz
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=False  _navdata_demo:=0

# 200Hz real-time update
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=True _navdata_demo:=0

# 15Hz real-rime update
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=True _navdata_demo:=1
</pre>

<h3 id="legacy-navigation-data">Legacy Navigation Data</h3>

<p>Information received from the drone will be published to the <code>ardrone/navdata</code> topic. The message type is <code>ardrone_autonomy::Navdata</code> and contains the following information:</p>

<ul>
<li>
<code>header</code>: ROS message header</li>
<li>
<code>batteryPercent</code>: The remaining charge of the drone's battery (%)</li>
<li>
<code>state</code>: The Drone's current state:
    * 0: Unknown
    * 1: Inited
    * 2: Landed
    * 3,7: Flying
    * 4: Hovering
    * 5: Test (?)
    * 6: Taking off
    * 8: Landing
    * 9: Looping (?)</li>
<li>
<code>rotX</code>: Left/right tilt in degrees (rotation about the X axis)</li>
<li>
<code>rotY</code>: Forward/backward tilt in degrees (rotation about the Y axis)</li>
<li>
<code>rotZ</code>: Orientation in degrees (rotation about the Z axis)</li>
<li>
<code>magX</code>, <code>magY</code>, <code>magZ</code>: Magnetometer readings (AR-Drone 2.0 Only) (TBA: Convention)</li>
<li>
<code>pressure</code>: Pressure sensed by Drone's barometer (AR-Drone 2.0 Only) (Pa)</li>
<li>
<code>temp</code> : Temperature sensed by Drone's sensor (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_speed</code>: Estimated wind speed (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_angle</code>: Estimated wind angle (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_comp_angle</code>: Estimated wind angle compensation (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>altd</code>: Estimated altitude (mm)</li>
<li>
<code>motor1..4</code>: Motor PWM values</li>
<li>
<code>vx</code>, <code>vy</code>, <code>vz</code>: Linear velocity (mm/s) [TBA: Convention]</li>
<li>
<code>ax</code>, <code>ay</code>, <code>az</code>: Linear acceleration (g) [TBA: Convention]</li>
<li>
<code>tm</code>: Timestamp of the data returned by the Drone returned as number of micro-seconds passed since Drone's boot-up.</li>
</ul>
<p><strong>NOTE:</strong> The legacy Navdata publishing can be disabled by setting the <code>enable_legacy_navdata</code> parameter to <code>False</code> (legacy navdata is enabled by default).</p>

<h3 id="imu-data">IMU data</h3>

<p>The linear acceleration, angular velocity and orientation from the <code>Navdata</code> is also published to a standard ROS <a href="http://www.ros.org/doc/api/sensor_msgs/html/msg/Imu.html"><code>sensor_msgs/Imu</code></a> message. The units are all metric and the reference frame is in <code>Base</code> frame. This topic is experimental. The covariance values are specified by specific parameters.</p>

<h3 id="magnetometer-data">Magnetometer Data</h3>

<p>The normalized magnetometer readings are also published to <code>ardrone/mag</code> topic as a standard ROS <a href="http://www.ros.org/doc/api/geometry_msgs/html/msg/Vector3Stamped.html"><code>geometry_msgs/Vector3Stamped</code></a> message.</p>

<h3 id="selective-navdata-(advanced)-:new:">Selective Navdata (Advanced) :new:</h3>

<p>You can access almost all sensor readings, debug values and status reports sent from the AR-Drone by using "Selective Navdata". If you set any of following parameters to "True", their corresponding <code>Navdata</code> information will be published to a separate topic. For example if you enable <code>enable_navdata_time</code>, the driver will publish AR-Drone time information to <code>ardrone/navdata_time</code> topic. Most of the names are self-explanatory. Please consult AR-Drone SDK 2.0's documentation (or source code) for more information. All parameters are set to False by default.</p>

<pre>
enable_navdata_trims            enable_navdata_rc_references    enable_navdata_pwm              enable_navdata_altitude 
enable_navdata_vision_raw       enable_navdata_vision_of        enable_navdata_vision           enable_navdata_vision_perf  
enable_navdata_trackers_send    enable_navdata_vision_detect    enable_navdata_watchdog         enable_navdata_adc_data_frame   
enable_navdata_video_stream     enable_navdata_games            enable_navdata_pressure_raw     enable_navdata_magneto  
enable_navdata_wind_speed       enable_navdata_kalman_pressure  enable_navdata_hdvideo_stream   enable_navdata_wifi enable_navdata_zimmu_3000   
</pre>

<p><strong>HINT:</strong> You can <code>rostopic type ardrone/navdata_time | rosmsg show</code> command for each topic to inspect its published message's data structure.</p>

<h3 id="cameras">Cameras</h3>

<p>Both AR-Drone 1.0 and 2.0 are equipped with two cameras. One frontal camera pointing forward and one vertical camera pointing downward. This driver will create three topics for each drone: <code>ardrone/image_raw</code>, <code>ardrone/front/image_raw</code> and <code>ardrone/bottom/image_raw</code>. Each of these three are standard <a href="http://ros.org/wiki/camera_drivers">ROS camera interface</a> and publish messages of type <a href="http://www.ros.org/wiki/image_transport">image transport</a>. The driver is also a standard <a href="http://www.ros.org/wiki/camera_drivers">ROS camera driver</a>, therefor if camera calibration information is provided either as a set of ROS parameters or appropriate <code>ardrone_front.yaml</code> and/or <code>ardrone_bottom.yaml</code>, the information will be published in appropriate <code>camera_info</code> topics. Please check the FAQ section for more information.</p>

<ul>
<li><p>The <code>ardrone/*</code> will always contain the selected camera's video stream and information.</p></li>
<li>
<p>The way that the other two streams work depend on the type of Drone.</p>

<ul>
<li>Drone 1</li>
</ul>
<p>Drone 1 supports four modes of video streams: Front camera only, bottom camera only, front camera with bottom camera inside (picture in picture) and bottom camera with front camera inside (picture in picture). According to active configuration mode, the driver decomposes the PIP stream and publishes pure front/bottom streams to corresponding topics. The <code>camera_info</code> topic will include the correct image size.
* Drone 2</p>

<p>Drone 2 does not support PIP feature anymore, therefore only one of <code>ardrone/front</code> or <code>ardrone/bottom</code> topics will be updated based on which camera is selected at the time.</p>
</li>
</ul>
<h3 id="tag-detection">Tag Detection</h3>

<p>The <code>Navdata</code> message also returns the special tags that are detected by the Drone's on-board vision processing system. To learn more about the system and the way it works please consult AR-Drone SDK 2.0's <a href="https://projects.ardrone.org/projects/show/ardrone-api/">developers guide</a>. These tags are being detected on both drone's video cameras on-board at 30fps. To configure (or disable) this feature look at the "Parameters" section in this documentation.</p>

<p>The detected tags' type and position in Drone's camera frame will be published to the following variables in <code>Navdata</code> message:</p>

<ul>
<li>
<code>tags_count</code>: The number of detected tags.</li>
<li>
<code>tags_type[]</code>: Vector of types of detected tags (details below)</li>
<li>
<code>tags_xc[]</code>, <code>tags_yc[]</code>, <code>tags_width[]</code>, <code>tags_height[]</code>: Vector of position components and size components for each tag. These numbers are expressed in numbers between [0,1000]. You need to convert them back to pixel unit using the corresponding camera's resolution (can be obtained front <code>camera_info</code> topic).</li>
<li>
<code>tags_orientation[]</code>: For the tags that support orientation, this is the vector that contains the tag orientation expressed in degrees [0..360).</li>
</ul>
<p>By default, the driver will configure the drone to look for <em>oriented roundels</em> using bottom camera and <em>2D tags v2</em> on indoor shells (<em>orange-yellow</em>) using front camera. For information on how to extract information from <code>tags_type</code> field. Check the FAQ section in the end.</p>

<h3 id="update-frequencies">Update Frequencies</h3>

<p>TBA.</p>

<h2 id="sending-commands-to-ar-drone">Sending Commands to AR-Drone</h2>

<p>The drone will <em>takeoff</em>, <em>land</em> or <em>emergency stop/reset</em> by publishing an <code>Empty</code> ROS messages to the following topics: <code>ardrone/takeoff</code>, <code>ardrone/land</code> and <code>ardrone/reset</code> respectively.</p>

<p>In order to fly the drone after takeoff, you can publish a message of type <a href="http://www.ros.org/doc/api/geometry_msgs/html/msg/Twist.html"><code>geometry_msgs::Twist</code></a> to the <code>cmd_vel</code> topic.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    -linear.x: move backward
    +linear.x: move forward
    -linear.y: move right
    +linear.y: move left
    -linear.z: move down
    +linear.z: move up

    -angular.z: turn left
    +angular.z: turn right
</code></pre></div>
<p>The range for each component should be between -1.0 and 1.0. The maximum range can be configured using ROS parameters discussed later in this document. </p>

<h3 id="hover-modes-:new:">Hover Modes :new:</h3>

<p><code>geometry_msgs::Twist</code> has two other member variable called <code>angular.x</code> and <code>angular.y</code> which can be used to enable/disable "auto-hover" mode. "auto-hover" is enabled when all six components are set to <strong>zero</strong>. If you want the drone not to enter "auto hover" mode in cases you set the first four components to zero, set <code>angular.x</code> and <code>angular.y</code> to arbitrary <strong>non-zero</strong> values.</p>

<h2 id="coordinate-frames">Coordinate Frames</h2>

<p>The driver publishes two <a href="http://www.ros.org/wiki/tf"><code>tf</code></a> transforms between three reference frames: <code>${tf_prefix}/${base_prefix}_link</code>, <code>${tf_prefix}/${base_prefix}_frontcam</code> and <code>${tf_prefix}/${base_prefix}_bottomcam</code>. The <code>${tf_prefix}</code> is ROS standard way to handle multi-robot <code>tf</code> trees and can be set using <code>tf_prefix</code> parameters, by default it is empty. The <code>${base_link}</code> is the shared name prefix of all three reference frames and can also be set using parameters, by default it has the value of <code>ardrone_base</code>. Using default parameters, the three frames would be: <code>ardrone_base_link</code>, <code>ardrone_base_frontcam</code> and <code>ardrone_base_bottomcam</code>. By default the root frame is  <code>ardrone_base_link</code>. Therefor <code>ardrone_base_frontcam</code> and <code>ardrone_base_bottomcam</code> are children of <code>ardrone_base_link</code> in the published <code>tf</code> tree. This can be changed using <code>root_frame</code> parameter.</p>

<p>The <code>frame_id</code> field in header of all published topics (navdata, imu, cameras) will have the appropriate frame names. All frames are <a href="http://www.ros.org/reps/rep-0103.html">ROS REP 103</a> compatible.</p>

<h2 id="services">Services</h2>

<h3 id="toggle-ar-drone's-camera">Toggle AR-Drone's Camera</h3>

<p>Calling <code>ardrone/togglecam</code> service with no parameters will change the active video camera stream. (e.g <code>rosservice call /ardrone/togglecam</code>).</p>

<p><code>ardrone/setcamchannel</code> service directly sets the current active camera channel. One parameter (<code>uint8 channel
</code>) should be sent to this service. For AR-Drone 1.0 the valid values are [0..3] and for AR-Drone 2.0 the valid values are [0..1]. The order is similar to the order described in "Cameras" section.</p>

<h3 id="led-animations">LED Animations</h3>

<p>Calling <code>ardrone/setledanimation</code> service will invoke one of 14 pre-defined LED animations for the drone. The parameters are</p>

<ul>
<li>
<code>uint8 type</code>: The type of animation which is a number in range [0..13]</li>
<li>
<code>float32 freq</code>: The frequency of the animation in Hz</li>
<li>
<code>uint8 duration</code>: The duration of the animation in Seconds.</li>
</ul>
<p>The <code>type</code> parameter will map [in order] to one of these animations (check <code>srv/LedAnim.srv</code> for more details):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    BLINK_GREEN_RED, BLINK_GREEN, BLINK_RED, BLINK_ORANGE,
    SNAKE_GREEN_RED, FIRE, STANDARD, RED, GREEN, RED_SNAKE,BLANK,
    LEFT_GREEN_RIGHT_RED, LEFT_RED_RIGHT_GREEN, BLINK_STANDARD`
</code></pre></div>
<p>You can test these animations in command line using commands like <code>rosservice call /ardrone/setledanimation 1 4 5</code></p>

<h3 id="flight-animations-:new:">Flight Animations :new:</h3>

<p>Calling <code>ardrone/setflightanimation</code> service will execute one of 20 pre-defined flight animations for the drone. The parameters are:</p>

<ul>
<li>
<code>uint8 type</code>: The type of flight animation, a number in range [0..19]</li>
<li>
<code>uint16 duration</code>: The duration of the animation. Use 0 for default duration (recommended)</li>
</ul>
<p>The <code>type</code> parameter will map [in order] to one of these pre-defined animations (check <code>srv/FlightAnim.srv</code> for more details):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">ARDRONE_ANIM_PHI_M30_DEG, ARDRONE_ANIM_PHI_30_DEG, ARDRONE_ANIM_THETA_M30_DEG, ARDRONE_ANIM_THETA_30_DEG,
ARDRONE_ANIM_THETA_20DEG_YAW_200DEG, ARDRONE_ANIM_THETA_20DEG_YAW_M200DEG, ARDRONE_ANIM_TURNAROUND,
ARDRONE_ANIM_TURNAROUND_GODOWN, ARDRONE_ANIM_YAW_SHAKE, ARDRONE_ANIM_YAW_DANCE, ARDRONE_ANIM_PHI_DANCE,
ARDRONE_ANIM_THETA_DANCE, ARDRONE_ANIM_VZ_DANCE, ARDRONE_ANIM_WAVE, ARDRONE_ANIM_PHI_THETA_MIXED,
ARDRONE_ANIM_DOUBLE_PHI_THETA_MIXED, ARDRONE_ANIM_FLIP_AHEAD, ARDRONE_ANIM_FLIP_BEHIND, ARDRONE_ANIM_FLIP_LEFT,
ARDRONE_ANIM_FLIP_RIGHT
</code></pre></div>
<p>You can test these animations in command line using commands like <code>rosservice call /ardrone/setflightanimation 1 0</code> while drone is flying.</p>

<p>Please be extra cautious about using animations, especially flip animations.</p>

<h3 id="imu-calibration">IMU Calibration</h3>

<p>If <code>do_imu_caliberation</code> parameter is set to true, calling <code>ardrone/imu_recalib</code> service will make the driver recalculate the biases in IMU data based on data from a short sampling period.</p>

<h3 id="flat-trim">Flat Trim</h3>

<p>Calling <code>ardrone/flattrim</code> service without any parameter will send a "Flat Trim" request to AR-Drone to re-calibrate its rotation estimates assuming that it is on a flat surface. Do not call this service while Drone is flying or while the drone is not actually on a flat surface.</p>

<h3 id="record-to-usb-stick">Record to USB Stick</h3>

<p>Calling <code>ardrone/setrecord</code> service will enable and disable recording to the USB stick. The service takes a simple <code>1</code> to enable or <code>0</code> to disable. So you can turn on recording to the USB stick with <code>rosservice call /ardrone/setrecord 1</code></p>

<h2 id="parameters">Parameters</h2>

<h3 id="ar-drone-specific-parameters">AR-Drone Specific Parameters</h3>

<p>The parameters listed below are named according to AR-Drone's SDK 2.0 configuration. Unless you set the parameters using <code>rosparam</code> or in your <code>launch</code> file, the default values will be used. These values are applied during driver's initialization phase. Please refer to AR-Drone SDK 2.0's <a href="https://projects.ardrone.org/projects/show/ardrone-api/">developer's guide</a> for information about valid values. Not all the parameters will be needed during regular usage of the AR-Drone, please consult the example launch file <code>launch/ardrone.launch</code> for frequent parameters.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">altitude, altitude_max, altitude_min, ardrone_name, autonomous_flight, bitrate, bitrate_ctrl_mode, 
bitrate_storage, codec_fps, com_watchdog, control_iphone_tilt, control_level, control_vz_max, 
control_yaw, detect_type, detections_select_h, detections_select_v, detections_select_v_hsync, 
enemy_colors, enemy_without_shell, euler_angle_max, flight_anim, flight_without_shell, flying_mode, 
groundstripe_colors, hovering_range, indoor_control_vz_max, indoor_control_yaw, indoor_euler_angle_max, 
latitude, leds_anim, longitude, manual_trim, max_bitrate, max_size, navdata_demo, navdata_options, 
nb_files, outdoor, outdoor_control_vz_max, outdoor_control_yaw, outdoor_euler_angle_max, output, 
owner_mac, ssid_multi_player, ssid_single_player, travelling_enable, travelling_mode, ultrasound_freq, 
ultrasound_watchdog, userbox_cmd, video_channel, video_codec, video_enable, video_file_index, 
video_live_socket, video_on_usb, video_slices, vision_enable, wifi_mode, wifi_rate
</code></pre></div>
<p><a href="https://github.com/AutonomyLab/ardrone_autonomy/wiki/AR-Drone-Parameters">This wiki page</a> includes more information about each of above parameters.</p>

<h3 id="other-parameters">Other Parameters</h3>

<p>These parameters control the behaviour of the driver.</p>

<ul>
<li>
<code>drone_frame_id</code> - The "frame_id" prefix to be used in all <code>tf</code> frame names - default: "ardrone_base"</li>
<li>
<code>root_frame</code> - The default root in drone's <code>tf</code> tree (0: _link, 1: _frontcam, 2: _bottomcam) - Default: 0</li>
<li>
<code>cov/imu_la</code>, <code>cov/imu_av</code> &amp; <code>cov/imu_or</code>: List of 9 covariance values to be used in <code>imu</code>'s topic linear acceleration, angular velocity and orientation fields respectively - Default: 0.0 for all members (Please check the FAQ section for a sample launch file that shows how to set these values)</li>
<li>
<code>do_imu_calibration</code>: [EXPERIMENTAL] Should the drone cancel the biases in IMU data - Default: 0</li>
<li>
<code>enable_legacy_navdata</code>: Enable legacy <code>Navdata</code> publish - Default: True</li>
</ul>
<h2 id="license">License</h2>

<ul>
<li>[The Parrot's license, copyright and disclaimer for <code>ARDroneLib</code>]<a href="https://github.com/AutonomyLab/ardronelib/blob/master/LICENSE">https://github.com/AutonomyLab/ardronelib/blob/master/LICENSE</a>) </li>
<li>Other parts of the code are subject to <code>BSD</code> license.</li>
</ul>
<h2 id="contributors">Contributors</h2>

<p><a href="http://autonomylab.org/ardrone_autonomy/contribution.html">List of all commiters to the repository</a>.</p>

<ul>
<li>@mikehamer - Added support for proper SDK2 way of configuring the Drone via parameter (critical bug fix) (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/26">More Info</a>). Support for zero-command without hovering (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/34">More info</a>). Full configurable Navdata support (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/31">More info</a>). Support for Real-time navdata and video publishing (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/44">More info</a>). Support for configurable data publishing rate.</li>
<li>@JakobEngel</li>
<li>@sameerparekh - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/53">Turn on and off USB stick recording</a> - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/25">Seperate Magnetometer Topic</a>
</li>
<li>@devmax - <a href="https://github.com/AutonomyLab/ardrone_autonomy/issues/18">Flat Trim</a> + Various comments for enhancements</li>
<li>@younata - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/2">Enhanced Navdata for AR-Drone 2.0</a>
</li>
<li>@boris-il-forte &amp; @lesire - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/79">Catkinization</a> <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/82">+</a>
</li>
<li>@kbogert - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/80">Move ARDroneLIB to an external project</a>
</li>
<li>@garyservin - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/109">Fix ffmpeg library link order</a>, <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/110">Moved header files to include directory</a>, <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/117">Add pressure unit</a>
</li>
</ul>
<h2 id="faq">FAQ</h2>

<h3 id="where-should-i-go-next?-is-there-any-ros-package-or-stack-that-can-be-used-as-a-tutorial/sample-to-use-ardrone_autonomy?">Where should I go next? Is there any ROS package or stack that can be used as a tutorial/sample to use ardrone_autonomy?</h3>

<p>Absolutely. Here are some examples:</p>

<ul>
<li><a href="https://github.com/FalkorSystems/falkor_ardrone">falkor_ardrone</a></li>
</ul>
<p>"falkor_ardrone" is a ROS package which uses the "ardrone_autonomy" package to implement autonomous control functionality on an AR.Drone.</p>

<ul>
<li><a href="http://www.ros.org/wiki/tum_ardrone">tum_ardrone</a></li>
</ul>
<p>State Estimation, Autopilot and GUI for ardrone.</p>

<ul>
<li><a href="https://github.com/parcon/arl_ardrone_examples">arl_ardrone_examples</a></li>
</ul>
<p>This ROS stack includes a series of very basic nodes to show users how to develop applications that use the ardrone_autonomy drivers for the AR drone 1.0 and 2.0 quadrotor robot.</p>

<ul>
<li><a href="https://github.com/mikehamer/ardrone_tutorials">AR Drone Tutorials</a></li>
</ul>
<p>This repository contains the source-code for the Up and flying with the AR.Drone and ROS tutorial series, published on <a href="http://www.robohub.org">Robohub</a>.</p>

<h3 id="how-can-i-report-a-bug,-submit-patches-or-ask-for-a-feature?">How can I report a bug, submit patches or ask for a feature?</h3>

<p><code>github</code> offers a nice and convenient issue tracking and social coding platform, it can be used for bug reports and pull/feature request. This is the preferred method. You can also contact the author directly.</p>

<p>If you want to submit a pull request, please submit to <code>dev-unstable</code> branch.</p>

<h3 id="why-the-ardronelib-has-been-patched?">Why the <code>ARDroneLib</code> has been patched?</h3>

<p>The ARDrone 2.0.1 SDK has been patched to 1) Enable the lib only build 2) Make its command line parsing compatible with ROS and 3) To fix its weird <code>main()</code> function issue. The patched SDK is being hosted on an <a href="https://github.com/AutonomyLab/ardronelib">external repository</a>.</p>

<h3 id="why-the-wifi-bandwidth-usage-is-too-much?">Why the wifi bandwidth usage is too much?</h3>

<p>The driver has been configured by default to use the maximum bandwidth allowed to ensure the best quality video stream possible (please take a look at default values in parameters section). That is the reason why the picture quality received from Drone 2.0 using this driver is far better than what you usually get using other software. If for any reason you prefer the lower quality* video stream, change <code>bitrate_ctrl_mode</code>, <code>max_bitrate</code> and <code>bitrate</code> parameters to the default values provided by the AR-Drone developer guide.</p>

<p>(*) Please note that lower quality does not mean lower resolution. By configuring AR-Drone to use bitrate control with limits, the picture gets blurry when there is a movement.</p>

<h3 id="what-is-the-default-configuration-for-the-front-camera-video-stream?">What is the default configuration for the front camera video stream?</h3>

<p><em>Drone 1</em>: 320x240@15fps UVLC Codec
<em>Drone 2</em>: 640x360@20fps H264 codec with no record stream</p>

<h3 id="how-can-i-extract-camera-information-and-tag-type-from-tags_type[]?">How can I extract camera information and tag type from <code>tags_type[]</code>?</h3>

<p><code>tag_type</code> contains information for both source and type of each detected tag. In order to extract information from them you can use the following c macros and enums (taken from <code>ardrone_api.h</code>)</p>
<div class="highlight"><pre><code class="language-c++" data-lang="c++"><span class="cp">#define DETECTION_EXTRACT_SOURCE(type)  ( ((type)&gt;&gt;16) &amp; 0x0FF )</span>
<span class="cp">#define DETECTION_EXTRACT_TAG(type)     ( (type) &amp; 0x0FF )</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <span class="n">DETECTION_SOURCE_CAMERA_HORIZONTAL</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="cm">/*&lt;! Tag was detected on the front camera picture */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_VERTICAL</span><span class="p">,</span>       <span class="cm">/*&lt;! Tag was detected on the vertical camera picture at full speed */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_VERTICAL_HSYNC</span><span class="p">,</span> <span class="cm">/*&lt;! Tag was detected on the vertical camera picture inside the horizontal pipeline */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_NUM</span><span class="p">,</span>
<span class="p">}</span> <span class="n">DETECTION_SOURCE_CAMERA</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <span class="n">TAG_TYPE_NONE</span>             <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">TAG_TYPE_SHELL_TAG</span>        <span class="p">,</span>
  <span class="n">TAG_TYPE_ROUNDEL</span>          <span class="p">,</span>
  <span class="n">TAG_TYPE_ORIENTED_ROUNDEL</span> <span class="p">,</span>
  <span class="n">TAG_TYPE_STRIPE</span>           <span class="p">,</span>
  <span class="n">TAG_TYPE_CAP</span>              <span class="p">,</span>
  <span class="n">TAG_TYPE_SHELL_TAG_V2</span>     <span class="p">,</span>
  <span class="n">TAG_TYPE_TOWER_SIDE</span>       <span class="p">,</span>
  <span class="n">TAG_TYPE_BLACK_ROUNDEL</span>    <span class="p">,</span>
  <span class="n">TAG_TYPE_NUM</span>
<span class="p">}</span> <span class="n">TAG_TYPE</span><span class="p">;</span>
</code></pre></div>
<h3 id="how-can-i-calibrate-the-ardrone-front/bottom-camera?">How can I calibrate the ardrone front/bottom camera?</h3>

<p>It is easy to calibrate both cameras using ROS <a href="http://www.ros.org/wiki/camera_calibration">Camera Calibration</a> package.</p>

<p>First, run the camera_calibration node with appropriate arguments: (For the bottom camera, replace front with bottom)</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">rosrun camera_calibration cameracalibrator.py --size <span class="o">[</span>SIZE<span class="o">]</span> --square <span class="o">[</span>SQUARESIZE<span class="o">]</span> image:<span class="o">=</span>/ardrone/front/image_raw camera:<span class="o">=</span>/ardrone/front
</code></pre></div>
<p>After successful calibration, press the <code>commit</code> button in the UI. The driver will receive the data from the camera calibration node, then will save the information by default in <code>~/.ros/camera_info/ardrone_front.yaml</code>. From this point on, whenever you run the driver on the same computer this file will be loaded automatically by the driver and its information will be published to appropriate <code>camera_info</code> topic. Sample calibration files for AR-Drone 2.0's cameras are provided in <code>data/camera_info</code> folder.</p>

<h3 id="can-i-see-a-sample-ardrone-node-in-a-launch-file-to-learn-how-to-set-parameters?">Can I see a sample ardrone node in a launch file to learn how to set parameters?</h3>

<p>Yes, you can check the <code>launch</code> folder for sample lanuch file.</p>

<h3 id="can-i-control-multiple-drones-using-a-single-pc?-or-can-i-make-my-drone-connect-to-a-wireless-router?">Can I control multiple drones using a single PC? or can I make my drone connect to a wireless router?</h3>

<p>With some hacking yes! This <a href="https://github.com/AutonomyLab/ardrone_autonomy/wiki/Multiple-AR-Drones">wiki page</a> contains some information regarding this issue.</p>

<h3 id="how-to-re-compile-parrot-sdk?">How to re-compile parrot SDK?</h3>

<p>If the <code>git</code> updates include a SDK upgrade, you'd better cleanup previous vuild files.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd </span>ARDroneLib/Soft/Build
make clean
rm -rf targets_versions
</code></pre></div>
<p>Build the SDK and driver again.</p>

<h2 id="todo">TODO</h2>

<ul>
<li>Make the <code>tf</code> publish optional.</li>
<li>Add the currently selected camera name to <code>Navdata</code>
</li>
<li>[DONE] Add separate topic for drone's debug stream (<code>navdata_demo</code>)</li>
<li>[DONE] Make the <code>togglecam</code> service accept parameters</li>
<li>[DONE] Enrich <code>Navdata</code> with magneto meter and baro meter information</li>
</ul>
</div></body></html>

            
          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-hydro">
    <div class="container-fluid">
      
        <div class="panel panel-default">
          
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/AutonomyLab/ardrone_autonomy.git">https://github.com/AutonomyLab/ardrone_autonomy.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">hydro-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2015-01-26
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNMAINTAINED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ardrone_autonomy/github-AutonomyLab-ardrone_autonomy">ardrone_autonomy</a></td>
                    <td>1.3.7</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="rendered-markdown">
<h1 id="ardrone_autonomy-:-a-ros-driver-for-ardrone-1.0-&amp;-2.0">ardrone_autonomy : A ROS Driver for ARDrone 1.0 &amp; 2.0</h1>

<p><a href="http://jenkins.ros.org/job/devel-hydro-ardrone_autonomy/"><img src="http://jenkins.ros.org/buildStatus/icon?job=devel-hydro-ardrone_autonomy" alt="Build Status"></a></p>

<p>ardrone_autonomy is a <a href="http://ros.org/" title="Robot Operating System">ROS</a> driver for <a href="http://ardrone2.parrot.com/">Parrot AR-Drone</a> quadrocopter. This driver is based on official <a href="https://projects.ardrone.org/">AR-Drone SDK</a> version 2.0.1. The driver supports both AR-Drone 1.0 and 2.0. "ardrone_autonomy" is a fork of <a href="http://code.google.com/p/brown-ros-pkg/wiki/ardrone_brown">AR-Drone Brown</a> driver. This package has been developed in <a href="http://autonomy.cs.sfu.ca">Autonomy Lab</a> of <a href="http://www.sfu.ca">Simon Fraser University</a> by <a href="http://sfu.ca/%7Emmonajje">Mani Monajjemi</a> ( +other <a href="#contributors">contributors</a>).</p>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
<li><a href="#updates">Updates</a></li>
<li>
<a href="#installation">Installation</a>

<ul>
<li><a href="#binary-install">Binary Install</a></li>
<li><a href="#compile-and-install-from-source">Compile and Install from Source</a></li>
</ul>
</li>
<li><a href="#how-to-run">How to Run</a></li>
<li>
<a href="#reading-from-ar-drone">Reading from AR-Drone</a>

<ul>
<li><a href="#update-frequencies-new">Update Frequencies </a></li>
<li><a href="#legacy-navigation-data">Legacy Navigation Data</a></li>
<li><a href="#imu-data">IMU data</a></li>
<li><a href="#magnetometer-data">Magnetometer Data</a></li>
<li><a href="#selective-navdata-advanced-new">Selective Navdata (Advanced) </a></li>
<li><a href="#cameras">Cameras</a></li>
<li><a href="#tag-detection">Tag Detection</a></li>
<li><a href="#update-frequencies">Update Frequencies</a></li>
</ul>
</li>
<li>
<a href="#sending-commands-to-ar-drone">Sending Commands to AR-Drone</a>

<ul>
<li>
<a href="#hover-modes-new">Hover Modes </a> :new:</li>
</ul>
</li>
<li><a href="#coordinate-frames">Coordinate Frames</a></li>
<li>
<a href="#services">Services</a>

<ul>
<li><a href="#toggle-ar-drones-camera">Toggle AR-Drone's Camera</a></li>
<li><a href="#led-animations">LED Animations</a></li>
<li><a href="#flight-animations-new">Flight Animations </a></li>
<li><a href="#imu-calibration">IMU Calibration</a></li>
<li><a href="#flat-trim">Flat Trim</a></li>
<li>
<a href="#record-to-usb-stick">Record to USB Stick</a> :new:</li>
</ul>
</li>
<li>
<a href="#parameters">Parameters</a>

<ul>
<li><a href="#ar-drone-specific-parameters">AR-Drone Specific Parameters</a></li>
<li><a href="#other-parameters">Other Parameters</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
<li><a href="#contributors">Contributors</a></li>
<li>
<a href="#faq">FAQ</a> :new:</li>
</ul>
<h2 id="updates">Updates</h2>

<ul>
<li>
<em>September 3 2014</em>: 1.3.5 <a href="https://github.com/AutonomyLab/ardrone_autonomy/milestones/1.3.5">Bug Fixes &amp; Minor Improvements</a>
</li>
<li>
<em>March 14 2014</em>: The binary packages of the driver are now built on <a href="http://wiki.ros.org/BuildFarm">ROS build farm</a>. You can install the driver for ROS <em>Hydro</em> and <em>Groovy</em> using <code>apt-get</code> on <em>Ubuntu</em>.</li>
<li>
<em>January 17 2014</em>: Fully <em>catkinized</em> package (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/75">#75</a> &amp; <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/79">#79</a>). ARDroneLib has been configured to be built as an external project. The ARDroneLib is replaced by the vanilla SDK's stripped tarball. (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/80">More info</a>).</li>
<li>
<em>October 22 2013</em>: Update to Parrot SDK 2.0.1 (Fixes crashes on 2.4.x firmwares, no support for flight recorder (yet). <strong>Please check the FAQ section for instructions on how to re-compile the SDK</strong>. (Tested on 2.3.3 and 2.4.x firmwares) </li>
<li>
<em>February 13 2013</em>: Support for USB key recording (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/53">More info</a>). Motor PWM added to legacy Navdata.</li>
<li>
<em>January 9 2013</em>: ROS Groovy support. Support for zero-command without hovering (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/34">More info</a>). Full configurable Navdata support (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/31">More info</a>). Support for "Flight Animations". Support for Real-time navdata and video publishing (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/44">More info</a>). Support for configurable data publishing rate.</li>
<li>
<em>November 9 2012</em>: Critical Bug in sending configurations to drone fixed and more parameters are supported (<a href="https://github.com/AutonomyLab/ardrone_autonomy/issues/24">More info</a>). Separate topic for magnetometer data added (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/25">More info</a>).</li>
<li>
<em>September 5 2012</em>: Experimental automatic IMU bias removal.</li>
<li>
<em>August 27 2012</em>: Thread-safe SDK data access. Synchronized <code>navdata</code> and <code>camera</code> topics.</li>
<li>
<em>August 20 2012</em>: The driver is now provides ROS standard camera interface.</li>
<li>
<em>August 17 2012</em>: Experimental <code>tf</code> support added. New published topic <code>imu</code>.</li>
<li>
<em>August 1 2012</em>: Enhanced <code>Navdata</code> message. <code>Navdata</code> now includes magnetometer data, barometer data, temperature and wind information for AR-Drone 2. <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/2">Issue #2</a>
</li>
<li>
<em>July 27 2012</em>: LED Animation Support added to the driver as a service</li>
<li>
<em>July 19 2012</em>: Initial Public Release</li>
</ul>
<h2 id="installation">Installation</h2>

<h3 id="binary-install">Binary Install</h3>

<p>On supported <em>Ubuntu</em> platform and for ROS <em>Hydro</em> and <em>Groovy</em> you can install the driver using <code>apt-get install ros-*-ardrone-autonomy</code> e.g. <code>apt-get install ros-hydro-ardrone-autonomy</code>.</p>

<h3 id="compile-and-install-from-source">Compile and Install from Source</h3>

<p>The bundled AR-Drone SDK has its own build system which usually handles system wide dependencies itself. The ROS package depends on these standard ROS packages: <code>roscpp</code>, <code>image_transport</code>, <code>sensor_msgs</code>, <code>tf</code>, <code>camera_info_manager</code> and <code>std_srvs</code>.</p>

<p>The installation follows the same steps needed usually to compile a ROS driver using <a href="http://wiki.ros.org/catkin">catkin</a>. Clone (or download and unpack) the driver to the <code>src</code> folder of a new or existing catkin <a href="http://wiki.ros.org/catkin/Tutorials/create_a_workspace">workspace</a> (e.g <code>~/catkin_ws/src</code>) and use <code>catkin_make</code> to compile. Assuming you are compiling for ROS <em>Hydro</em>:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws/src
<span class="nv">$ </span>git clone https://github.com/AutonomyLab/ardrone_autonomy.git -b hydro-devel
<span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws
<span class="nv">$ </span>catkin_make
</code></pre></div>
<p>If you need to compile for older ROS distros or you are bound to use <code>rosbuild</code>, please check the <code>fuerte-devel</code> branch.</p>

<h2 id="how-to-run">How to Run</h2>

<p>The driver's executable node is <code>ardrone_driver</code>. You can either use <code>rosrun ardrone_autonomy ardrone_driver</code> or put it in a custom launch file with your desired parameters.</p>

<h2 id="reading-from-ar-drone">Reading from AR-Drone</h2>

<h3 id="update-frequencies-:new:">Update Frequencies :new:</h3>

<p><strong>Drone Update Frequencies</strong>: The drone's data transmission update frequency depends on <code>navdata_demo</code> parameter. When it is 1, the transmission frequency will be 15Hz, otherwise it will be 200Hz. (<code>navdata_demo</code> is a numeric parameter not Boolean, so use 1 and 0 (not True/False) to set/unset it)</p>

<p><strong>Driver Update Frequencies</strong>: The driver can operate in two modes: real-time or fixed rate. When the <code>realtime_navdata</code> parameter is set to True, the driver will publish the received information instantly. However when it is set to False, the driver will cache the most recent received data, then it will publish that at a fixed rate, configured by <code>looprate</code> parameter. The default configuration is: <code>realtime_navdata=False</code> and <code>looprate=50</code>. </p>

<p>Please note that if the <code>looprate</code> is smaller than the drone's transmission frequency, there will be data loss. The driver's start-up output shows the current configuration. You can also use <code>rostopic hz</code> command to check the publish rate of the driver.</p>

<pre>
# Default Setting - 50Hz non-realtime update, the drone transmission rate is 200Hz
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=False  _navdata_demo:=0

# 200Hz real-time update
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=True _navdata_demo:=0

# 15Hz real-rime update
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=True _navdata_demo:=1
</pre>

<h3 id="legacy-navigation-data">Legacy Navigation Data</h3>

<p>Information received from the drone will be published to the <code>ardrone/navdata</code> topic. The message type is <code>ardrone_autonomy::Navdata</code> and contains the following information:</p>

<ul>
<li>
<code>header</code>: ROS message header</li>
<li>
<code>batteryPercent</code>: The remaining charge of the drone's battery (%)</li>
<li>
<code>state</code>: The Drone's current state:
    * 0: Unknown
    * 1: Inited
    * 2: Landed
    * 3,7: Flying
    * 4: Hovering
    * 5: Test (?)
    * 6: Taking off
    * 8: Landing
    * 9: Looping (?)</li>
<li>
<code>rotX</code>: Left/right tilt in degrees (rotation about the X axis)</li>
<li>
<code>rotY</code>: Forward/backward tilt in degrees (rotation about the Y axis)</li>
<li>
<code>rotZ</code>: Orientation in degrees (rotation about the Z axis)</li>
<li>
<code>magX</code>, <code>magY</code>, <code>magZ</code>: Magnetometer readings (AR-Drone 2.0 Only) (TBA: Convention)</li>
<li>
<code>pressure</code>: Pressure sensed by Drone's barometer (AR-Drone 2.0 Only) (Pa)</li>
<li>
<code>temp</code> : Temperature sensed by Drone's sensor (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_speed</code>: Estimated wind speed (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_angle</code>: Estimated wind angle (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_comp_angle</code>: Estimated wind angle compensation (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>altd</code>: Estimated altitude (mm)</li>
<li>
<code>motor1..4</code>: Motor PWM values</li>
<li>
<code>vx</code>, <code>vy</code>, <code>vz</code>: Linear velocity (mm/s) [TBA: Convention]</li>
<li>
<code>ax</code>, <code>ay</code>, <code>az</code>: Linear acceleration (g) [TBA: Convention]</li>
<li>
<code>tm</code>: Timestamp of the data returned by the Drone returned as number of micro-seconds passed since Drone's boot-up.</li>
</ul>
<p><strong>NOTE:</strong> The legacy Navdata publishing can be disabled by setting the <code>enable_legacy_navdata</code> parameter to <code>False</code> (legacy navdata is enabled by default).</p>

<h3 id="imu-data">IMU data</h3>

<p>The linear acceleration, angular velocity and orientation from the <code>Navdata</code> is also published to a standard ROS <a href="http://www.ros.org/doc/api/sensor_msgs/html/msg/Imu.html"><code>sensor_msgs/Imu</code></a> message. The units are all metric and the reference frame is in <code>Base</code> frame. This topic is experimental. The covariance values are specified by specific parameters.</p>

<h3 id="magnetometer-data">Magnetometer Data</h3>

<p>The normalized magnetometer readings are also published to <code>ardrone/mag</code> topic as a standard ROS <a href="http://www.ros.org/doc/api/geometry_msgs/html/msg/Vector3Stamped.html"><code>geometry_msgs/Vector3Stamped</code></a> message.</p>

<h3 id="selective-navdata-(advanced)-:new:">Selective Navdata (Advanced) :new:</h3>

<p>You can access almost all sensor readings, debug values and status reports sent from the AR-Drone by using "Selective Navdata". If you set any of following parameters to "True", their corresponding <code>Navdata</code> information will be published to a separate topic. For example if you enable <code>enable_navdata_time</code>, the driver will publish AR-Drone time information to <code>ardrone/navdata_time</code> topic. Most of the names are self-explanatory. Please consult AR-Drone SDK 2.0's documentation (or source code) for more information. All parameters are set to False by default.</p>

<pre>
enable_navdata_trims            enable_navdata_rc_references    enable_navdata_pwm              enable_navdata_altitude 
enable_navdata_vision_raw       enable_navdata_vision_of        enable_navdata_vision           enable_navdata_vision_perf  
enable_navdata_trackers_send    enable_navdata_vision_detect    enable_navdata_watchdog         enable_navdata_adc_data_frame   
enable_navdata_video_stream     enable_navdata_games            enable_navdata_pressure_raw     enable_navdata_magneto  
enable_navdata_wind_speed       enable_navdata_kalman_pressure  enable_navdata_hdvideo_stream   enable_navdata_wifi enable_navdata_zimmu_3000   
</pre>

<p><strong>HINT:</strong> You can <code>rostopic type ardrone/navdata_time | rosmsg show</code> command for each topic to inspect its published message's data structure.</p>

<h3 id="cameras">Cameras</h3>

<p>Both AR-Drone 1.0 and 2.0 are equipped with two cameras. One frontal camera pointing forward and one vertical camera pointing downward. This driver will create three topics for each drone: <code>ardrone/image_raw</code>, <code>ardrone/front/image_raw</code> and <code>ardrone/bottom/image_raw</code>. Each of these three are standard <a href="http://ros.org/wiki/camera_drivers">ROS camera interface</a> and publish messages of type <a href="http://www.ros.org/wiki/image_transport">image transport</a>. The driver is also a standard <a href="http://www.ros.org/wiki/camera_drivers">ROS camera driver</a>, therefor if camera calibration information is provided either as a set of ROS parameters or appropriate <code>ardrone_front.yaml</code> and/or <code>ardrone_bottom.yaml</code>, the information will be published in appropriate <code>camera_info</code> topics. Please check the FAQ section for more information.</p>

<ul>
<li><p>The <code>ardrone/*</code> will always contain the selected camera's video stream and information.</p></li>
<li>
<p>The way that the other two streams work depend on the type of Drone.</p>

<ul>
<li>Drone 1</li>
</ul>
<p>Drone 1 supports four modes of video streams: Front camera only, bottom camera only, front camera with bottom camera inside (picture in picture) and bottom camera with front camera inside (picture in picture). According to active configuration mode, the driver decomposes the PIP stream and publishes pure front/bottom streams to corresponding topics. The <code>camera_info</code> topic will include the correct image size.
* Drone 2</p>

<p>Drone 2 does not support PIP feature anymore, therefore only one of <code>ardrone/front</code> or <code>ardrone/bottom</code> topics will be updated based on which camera is selected at the time.</p>
</li>
</ul>
<h3 id="tag-detection">Tag Detection</h3>

<p>The <code>Navdata</code> message also returns the special tags that are detected by the Drone's on-board vision processing system. To learn more about the system and the way it works please consult AR-Drone SDK 2.0's <a href="https://projects.ardrone.org/projects/show/ardrone-api/">developers guide</a>. These tags are being detected on both drone's video cameras on-board at 30fps. To configure (or disable) this feature look at the "Parameters" section in this documentation.</p>

<p>The detected tags' type and position in Drone's camera frame will be published to the following variables in <code>Navdata</code> message:</p>

<ul>
<li>
<code>tags_count</code>: The number of detected tags.</li>
<li>
<code>tags_type[]</code>: Vector of types of detected tags (details below)</li>
<li>
<code>tags_xc[]</code>, <code>tags_yc[]</code>, <code>tags_width[]</code>, <code>tags_height[]</code>: Vector of position components and size components for each tag. These numbers are expressed in numbers between [0,1000]. You need to convert them back to pixel unit using the corresponding camera's resolution (can be obtained front <code>camera_info</code> topic).</li>
<li>
<code>tags_orientation[]</code>: For the tags that support orientation, this is the vector that contains the tag orientation expressed in degrees [0..360).</li>
</ul>
<p>By default, the driver will configure the drone to look for <em>oriented roundels</em> using bottom camera and <em>2D tags v2</em> on indoor shells (<em>orange-yellow</em>) using front camera. For information on how to extract information from <code>tags_type</code> field. Check the FAQ section in the end.</p>

<h3 id="update-frequencies">Update Frequencies</h3>

<p>TBA.</p>

<h2 id="sending-commands-to-ar-drone">Sending Commands to AR-Drone</h2>

<p>The drone will <em>takeoff</em>, <em>land</em> or <em>emergency stop/reset</em> by publishing an <code>Empty</code> ROS messages to the following topics: <code>ardrone/takeoff</code>, <code>ardrone/land</code> and <code>ardrone/reset</code> respectively.</p>

<p>In order to fly the drone after takeoff, you can publish a message of type <a href="http://www.ros.org/doc/api/geometry_msgs/html/msg/Twist.html"><code>geometry_msgs::Twist</code></a> to the <code>cmd_vel</code> topic.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    -linear.x: move backward
    +linear.x: move forward
    -linear.y: move right
    +linear.y: move left
    -linear.z: move down
    +linear.z: move up

    -angular.z: turn left
    +angular.z: turn right
</code></pre></div>
<p>The range for each component should be between -1.0 and 1.0. The maximum range can be configured using ROS parameters discussed later in this document. </p>

<h3 id="hover-modes-:new:">Hover Modes :new:</h3>

<p><code>geometry_msgs::Twist</code> has two other member variable called <code>angular.x</code> and <code>angular.y</code> which can be used to enable/disable "auto-hover" mode. "auto-hover" is enabled when all six components are set to <strong>zero</strong>. If you want the drone not to enter "auto hover" mode in cases you set the first four components to zero, set <code>angular.x</code> and <code>angular.y</code> to arbitrary <strong>non-zero</strong> values.</p>

<h2 id="coordinate-frames">Coordinate Frames</h2>

<p>The driver publishes two <a href="http://www.ros.org/wiki/tf"><code>tf</code></a> transforms between three reference frames: <code>${tf_prefix}/${base_prefix}_link</code>, <code>${tf_prefix}/${base_prefix}_frontcam</code> and <code>${tf_prefix}/${base_prefix}_bottomcam</code>. The <code>${tf_prefix}</code> is ROS standard way to handle multi-robot <code>tf</code> trees and can be set using <code>tf_prefix</code> parameters, by default it is empty. The <code>${base_link}</code> is the shared name prefix of all three reference frames and can also be set using parameters, by default it has the value of <code>ardrone_base</code>. Using default parameters, the three frames would be: <code>ardrone_base_link</code>, <code>ardrone_base_frontcam</code> and <code>ardrone_base_bottomcam</code>. By default the root frame is  <code>ardrone_base_link</code>. Therefor <code>ardrone_base_frontcam</code> and <code>ardrone_base_bottomcam</code> are children of <code>ardrone_base_link</code> in the published <code>tf</code> tree. This can be changed using <code>root_frame</code> parameter.</p>

<p>The <code>frame_id</code> field in header of all published topics (navdata, imu, cameras) will have the appropriate frame names. All frames are <a href="http://www.ros.org/reps/rep-0103.html">ROS REP 103</a> compatible.</p>

<h2 id="services">Services</h2>

<h3 id="toggle-ar-drone's-camera">Toggle AR-Drone's Camera</h3>

<p>Calling <code>ardrone/togglecam</code> service with no parameters will change the active video camera stream. (e.g <code>rosservice call /ardrone/togglecam</code>).</p>

<p><code>ardrone/setcamchannel</code> service directly sets the current active camera channel. One parameter (<code>uint8 channel
</code>) should be sent to this service. For AR-Drone 1.0 the valid values are [0..3] and for AR-Drone 2.0 the valid values are [0..1]. The order is similar to the order described in "Cameras" section.</p>

<h3 id="led-animations">LED Animations</h3>

<p>Calling <code>ardrone/setledanimation</code> service will invoke one of 14 pre-defined LED animations for the drone. The parameters are</p>

<ul>
<li>
<code>uint8 type</code>: The type of animation which is a number in range [0..13]</li>
<li>
<code>float32 freq</code>: The frequency of the animation in Hz</li>
<li>
<code>uint8 duration</code>: The duration of the animation in Seconds.</li>
</ul>
<p>The <code>type</code> parameter will map [in order] to one of these animations (check <code>srv/LedAnim.srv</code> for more details):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    BLINK_GREEN_RED, BLINK_GREEN, BLINK_RED, BLINK_ORANGE,
    SNAKE_GREEN_RED, FIRE, STANDARD, RED, GREEN, RED_SNAKE,BLANK,
    LEFT_GREEN_RIGHT_RED, LEFT_RED_RIGHT_GREEN, BLINK_STANDARD`
</code></pre></div>
<p>You can test these animations in command line using commands like <code>rosservice call /ardrone/setledanimation 1 4 5</code></p>

<h3 id="flight-animations-:new:">Flight Animations :new:</h3>

<p>Calling <code>ardrone/setflightanimation</code> service will execute one of 20 pre-defined flight animations for the drone. The parameters are:</p>

<ul>
<li>
<code>uint8 type</code>: The type of flight animation, a number in range [0..19]</li>
<li>
<code>uint16 duration</code>: The duration of the animation. Use 0 for default duration (recommended)</li>
</ul>
<p>The <code>type</code> parameter will map [in order] to one of these pre-defined animations (check <code>srv/FlightAnim.srv</code> for more details):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">ARDRONE_ANIM_PHI_M30_DEG, ARDRONE_ANIM_PHI_30_DEG, ARDRONE_ANIM_THETA_M30_DEG, ARDRONE_ANIM_THETA_30_DEG,
ARDRONE_ANIM_THETA_20DEG_YAW_200DEG, ARDRONE_ANIM_THETA_20DEG_YAW_M200DEG, ARDRONE_ANIM_TURNAROUND,
ARDRONE_ANIM_TURNAROUND_GODOWN, ARDRONE_ANIM_YAW_SHAKE, ARDRONE_ANIM_YAW_DANCE, ARDRONE_ANIM_PHI_DANCE,
ARDRONE_ANIM_THETA_DANCE, ARDRONE_ANIM_VZ_DANCE, ARDRONE_ANIM_WAVE, ARDRONE_ANIM_PHI_THETA_MIXED,
ARDRONE_ANIM_DOUBLE_PHI_THETA_MIXED, ARDRONE_ANIM_FLIP_AHEAD, ARDRONE_ANIM_FLIP_BEHIND, ARDRONE_ANIM_FLIP_LEFT,
ARDRONE_ANIM_FLIP_RIGHT
</code></pre></div>
<p>You can test these animations in command line using commands like <code>rosservice call /ardrone/setflightanimation 1 0</code> while drone is flying.</p>

<p>Please be extra cautious about using animations, especially flip animations.</p>

<h3 id="imu-calibration">IMU Calibration</h3>

<p>If <code>do_imu_caliberation</code> parameter is set to true, calling <code>ardrone/imu_recalib</code> service will make the driver recalculate the biases in IMU data based on data from a short sampling period.</p>

<h3 id="flat-trim">Flat Trim</h3>

<p>Calling <code>ardrone/flattrim</code> service without any parameter will send a "Flat Trim" request to AR-Drone to re-calibrate its rotation estimates assuming that it is on a flat surface. Do not call this service while Drone is flying or while the drone is not actually on a flat surface.</p>

<h3 id="record-to-usb-stick">Record to USB Stick</h3>

<p>Calling <code>ardrone/setrecord</code> service will enable and disable recording to the USB stick. The service takes a simple <code>1</code> to enable or <code>0</code> to disable. So you can turn on recording to the USB stick with <code>rosservice call /ardrone/setrecord 1</code></p>

<h2 id="parameters">Parameters</h2>

<h3 id="ar-drone-specific-parameters">AR-Drone Specific Parameters</h3>

<p>The parameters listed below are named according to AR-Drone's SDK 2.0 configuration. Unless you set the parameters using <code>rosparam</code> or in your <code>launch</code> file, the default values will be used. These values are applied during driver's initialization phase. Please refer to AR-Drone SDK 2.0's <a href="https://projects.ardrone.org/projects/show/ardrone-api/">developer's guide</a> for information about valid values. Not all the parameters will be needed during regular usage of the AR-Drone, please consult the example launch file <code>launch/ardrone.launch</code> for frequent parameters.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">altitude, altitude_max, altitude_min, ardrone_name, autonomous_flight, bitrate, bitrate_ctrl_mode, 
bitrate_storage, codec_fps, com_watchdog, control_iphone_tilt, control_level, control_vz_max, 
control_yaw, detect_type, detections_select_h, detections_select_v, detections_select_v_hsync, 
enemy_colors, enemy_without_shell, euler_angle_max, flight_anim, flight_without_shell, flying_mode, 
groundstripe_colors, hovering_range, indoor_control_vz_max, indoor_control_yaw, indoor_euler_angle_max, 
latitude, leds_anim, longitude, manual_trim, max_bitrate, max_size, navdata_demo, navdata_options, 
nb_files, outdoor, outdoor_control_vz_max, outdoor_control_yaw, outdoor_euler_angle_max, output, 
owner_mac, ssid_multi_player, ssid_single_player, travelling_enable, travelling_mode, ultrasound_freq, 
ultrasound_watchdog, userbox_cmd, video_channel, video_codec, video_enable, video_file_index, 
video_live_socket, video_on_usb, video_slices, vision_enable, wifi_mode, wifi_rate
</code></pre></div>
<p><a href="https://github.com/AutonomyLab/ardrone_autonomy/wiki/AR-Drone-Parameters">This wiki page</a> includes more information about each of above parameters.</p>

<h3 id="other-parameters">Other Parameters</h3>

<p>These parameters control the behaviour of the driver.</p>

<ul>
<li>
<code>drone_frame_id</code> - The "frame_id" prefix to be used in all <code>tf</code> frame names - default: "ardrone_base"</li>
<li>
<code>root_frame</code> - The default root in drone's <code>tf</code> tree (0: _link, 1: _frontcam, 2: _bottomcam) - Default: 0</li>
<li>
<code>cov/imu_la</code>, <code>cov/imu_av</code> &amp; <code>cov/imu_or</code>: List of 9 covariance values to be used in <code>imu</code>'s topic linear acceleration, angular velocity and orientation fields respectively - Default: 0.0 for all members (Please check the FAQ section for a sample launch file that shows how to set these values)</li>
<li>
<code>do_imu_calibration</code>: [EXPERIMENTAL] Should the drone cancel the biases in IMU data - Default: 0</li>
<li>
<code>enable_legacy_navdata</code>: Enable legacy <code>Navdata</code> publish - Default: True</li>
</ul>
<h2 id="license">License</h2>

<ul>
<li>[The Parrot's license, copyright and disclaimer for <code>ARDroneLib</code>]<a href="https://github.com/AutonomyLab/ardronelib/blob/master/LICENSE">https://github.com/AutonomyLab/ardronelib/blob/master/LICENSE</a>) </li>
<li>Other parts of the code are subject to <code>BSD</code> license.</li>
</ul>
<h2 id="contributors">Contributors</h2>

<p><a href="http://autonomylab.org/ardrone_autonomy/contribution.html">List of all commiters to the repository</a>.</p>

<ul>
<li>@mikehamer - Added support for proper SDK2 way of configuring the Drone via parameter (critical bug fix) (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/26">More Info</a>). Support for zero-command without hovering (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/34">More info</a>). Full configurable Navdata support (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/31">More info</a>). Support for Real-time navdata and video publishing (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/44">More info</a>). Support for configurable data publishing rate.</li>
<li>@JakobEngel</li>
<li>@sameerparekh - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/53">Turn on and off USB stick recording</a> - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/25">Seperate Magnetometer Topic</a>
</li>
<li>@devmax - <a href="https://github.com/AutonomyLab/ardrone_autonomy/issues/18">Flat Trim</a> + Various comments for enhancements</li>
<li>@younata - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/2">Enhanced Navdata for AR-Drone 2.0</a>
</li>
<li>@boris-il-forte &amp; @lesire - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/79">Catkinization</a> <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/82">+</a>
</li>
<li>@kbogert - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/80">Move ARDroneLIB to an external project</a>
</li>
<li>@garyservin - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/109">Fix ffmpeg library link order</a>, <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/110">Moved header files to include directory</a>, <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/117">Add pressure unit</a>
</li>
</ul>
<h2 id="faq">FAQ</h2>

<h3 id="where-should-i-go-next?-is-there-any-ros-package-or-stack-that-can-be-used-as-a-tutorial/sample-to-use-ardrone_autonomy?">Where should I go next? Is there any ROS package or stack that can be used as a tutorial/sample to use ardrone_autonomy?</h3>

<p>Absolutely. Here are some examples:</p>

<ul>
<li><a href="https://github.com/FalkorSystems/falkor_ardrone">falkor_ardrone</a></li>
</ul>
<p>"falkor_ardrone" is a ROS package which uses the "ardrone_autonomy" package to implement autonomous control functionality on an AR.Drone.</p>

<ul>
<li><a href="http://www.ros.org/wiki/tum_ardrone">tum_ardrone</a></li>
</ul>
<p>State Estimation, Autopilot and GUI for ardrone.</p>

<ul>
<li><a href="https://github.com/parcon/arl_ardrone_examples">arl_ardrone_examples</a></li>
</ul>
<p>This ROS stack includes a series of very basic nodes to show users how to develop applications that use the ardrone_autonomy drivers for the AR drone 1.0 and 2.0 quadrotor robot.</p>

<ul>
<li><a href="https://github.com/mikehamer/ardrone_tutorials">AR Drone Tutorials</a></li>
</ul>
<p>This repository contains the source-code for the Up and flying with the AR.Drone and ROS tutorial series, published on <a href="http://www.robohub.org">Robohub</a>.</p>

<h3 id="how-can-i-report-a-bug,-submit-patches-or-ask-for-a-feature?">How can I report a bug, submit patches or ask for a feature?</h3>

<p><code>github</code> offers a nice and convenient issue tracking and social coding platform, it can be used for bug reports and pull/feature request. This is the preferred method. You can also contact the author directly.</p>

<p>If you want to submit a pull request, please submit to <code>dev-unstable</code> branch.</p>

<h3 id="why-the-ardronelib-has-been-patched?">Why the <code>ARDroneLib</code> has been patched?</h3>

<p>The ARDrone 2.0.1 SDK has been patched to 1) Enable the lib only build 2) Make its command line parsing compatible with ROS and 3) To fix its weird <code>main()</code> function issue. The patched SDK is being hosted on an <a href="https://github.com/AutonomyLab/ardronelib">external repository</a>.</p>

<h3 id="why-the-wifi-bandwidth-usage-is-too-much?">Why the wifi bandwidth usage is too much?</h3>

<p>The driver has been configured by default to use the maximum bandwidth allowed to ensure the best quality video stream possible (please take a look at default values in parameters section). That is the reason why the picture quality received from Drone 2.0 using this driver is far better than what you usually get using other software. If for any reason you prefer the lower quality* video stream, change <code>bitrate_ctrl_mode</code>, <code>max_bitrate</code> and <code>bitrate</code> parameters to the default values provided by the AR-Drone developer guide.</p>

<p>(*) Please note that lower quality does not mean lower resolution. By configuring AR-Drone to use bitrate control with limits, the picture gets blurry when there is a movement.</p>

<h3 id="what-is-the-default-configuration-for-the-front-camera-video-stream?">What is the default configuration for the front camera video stream?</h3>

<p><em>Drone 1</em>: 320x240@15fps UVLC Codec
<em>Drone 2</em>: 640x360@20fps H264 codec with no record stream</p>

<h3 id="how-can-i-extract-camera-information-and-tag-type-from-tags_type[]?">How can I extract camera information and tag type from <code>tags_type[]</code>?</h3>

<p><code>tag_type</code> contains information for both source and type of each detected tag. In order to extract information from them you can use the following c macros and enums (taken from <code>ardrone_api.h</code>)</p>
<div class="highlight"><pre><code class="language-c++" data-lang="c++"><span class="cp">#define DETECTION_EXTRACT_SOURCE(type)  ( ((type)&gt;&gt;16) &amp; 0x0FF )</span>
<span class="cp">#define DETECTION_EXTRACT_TAG(type)     ( (type) &amp; 0x0FF )</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <span class="n">DETECTION_SOURCE_CAMERA_HORIZONTAL</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="cm">/*&lt;! Tag was detected on the front camera picture */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_VERTICAL</span><span class="p">,</span>       <span class="cm">/*&lt;! Tag was detected on the vertical camera picture at full speed */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_VERTICAL_HSYNC</span><span class="p">,</span> <span class="cm">/*&lt;! Tag was detected on the vertical camera picture inside the horizontal pipeline */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_NUM</span><span class="p">,</span>
<span class="p">}</span> <span class="n">DETECTION_SOURCE_CAMERA</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <span class="n">TAG_TYPE_NONE</span>             <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">TAG_TYPE_SHELL_TAG</span>        <span class="p">,</span>
  <span class="n">TAG_TYPE_ROUNDEL</span>          <span class="p">,</span>
  <span class="n">TAG_TYPE_ORIENTED_ROUNDEL</span> <span class="p">,</span>
  <span class="n">TAG_TYPE_STRIPE</span>           <span class="p">,</span>
  <span class="n">TAG_TYPE_CAP</span>              <span class="p">,</span>
  <span class="n">TAG_TYPE_SHELL_TAG_V2</span>     <span class="p">,</span>
  <span class="n">TAG_TYPE_TOWER_SIDE</span>       <span class="p">,</span>
  <span class="n">TAG_TYPE_BLACK_ROUNDEL</span>    <span class="p">,</span>
  <span class="n">TAG_TYPE_NUM</span>
<span class="p">}</span> <span class="n">TAG_TYPE</span><span class="p">;</span>
</code></pre></div>
<h3 id="how-can-i-calibrate-the-ardrone-front/bottom-camera?">How can I calibrate the ardrone front/bottom camera?</h3>

<p>It is easy to calibrate both cameras using ROS <a href="http://www.ros.org/wiki/camera_calibration">Camera Calibration</a> package.</p>

<p>First, run the camera_calibration node with appropriate arguments: (For the bottom camera, replace front with bottom)</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">rosrun camera_calibration cameracalibrator.py --size <span class="o">[</span>SIZE<span class="o">]</span> --square <span class="o">[</span>SQUARESIZE<span class="o">]</span> image:<span class="o">=</span>/ardrone/front/image_raw camera:<span class="o">=</span>/ardrone/front
</code></pre></div>
<p>After successful calibration, press the <code>commit</code> button in the UI. The driver will receive the data from the camera calibration node, then will save the information by default in <code>~/.ros/camera_info/ardrone_front.yaml</code>. From this point on, whenever you run the driver on the same computer this file will be loaded automatically by the driver and its information will be published to appropriate <code>camera_info</code> topic. Sample calibration files for AR-Drone 2.0's cameras are provided in <code>data/camera_info</code> folder.</p>

<h3 id="can-i-see-a-sample-ardrone-node-in-a-launch-file-to-learn-how-to-set-parameters?">Can I see a sample ardrone node in a launch file to learn how to set parameters?</h3>

<p>Yes, you can check the <code>launch</code> folder for sample lanuch file.</p>

<h3 id="can-i-control-multiple-drones-using-a-single-pc?-or-can-i-make-my-drone-connect-to-a-wireless-router?">Can I control multiple drones using a single PC? or can I make my drone connect to a wireless router?</h3>

<p>With some hacking yes! This <a href="https://github.com/AutonomyLab/ardrone_autonomy/wiki/Multiple-AR-Drones">wiki page</a> contains some information regarding this issue.</p>

<h3 id="how-to-re-compile-parrot-sdk?">How to re-compile parrot SDK?</h3>

<p>If the <code>git</code> updates include a SDK upgrade, you'd better cleanup previous vuild files.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd </span>ARDroneLib/Soft/Build
make clean
rm -rf targets_versions
</code></pre></div>
<p>Build the SDK and driver again.</p>

<h2 id="todo">TODO</h2>

<ul>
<li>Make the <code>tf</code> publish optional.</li>
<li>Add the currently selected camera name to <code>Navdata</code>
</li>
<li>[DONE] Add separate topic for drone's debug stream (<code>navdata_demo</code>)</li>
<li>[DONE] Make the <code>togglecam</code> service accept parameters</li>
<li>[DONE] Enrich <code>Navdata</code> with magneto meter and baro meter information</li>
</ul>
</div></body></html>

            
          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-groovy">
    <div class="container-fluid">
      
        <div class="panel panel-default">
          
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/AutonomyLab/ardrone_autonomy.git">https://github.com/AutonomyLab/ardrone_autonomy.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">groovy-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2014-09-08
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNMAINTAINED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-primary"><span class="glyphicon glyphicon-flash"></span> RELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ardrone_autonomy/github-AutonomyLab-ardrone_autonomy">ardrone_autonomy</a></td>
                    <td>1.3.7</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="rendered-markdown">
<h1 id="ardrone_autonomy-:-a-ros-driver-for-ardrone-1.0-&amp;-2.0">ardrone_autonomy : A ROS Driver for ARDrone 1.0 &amp; 2.0</h1>

<p><a href="http://jenkins.ros.org/job/devel-groovy-ardrone_autonomy"><img src="http://jenkins.ros.org/buildStatus/icon?job=devel-groovy-ardrone_autonomy" alt=""></a></p>

<p>ardrone_autonomy is a <a href="http://ros.org/" title="Robot Operating System">ROS</a> driver for <a href="http://ardrone2.parrot.com/">Parrot AR-Drone</a> quadrocopter. This driver is based on official <a href="https://projects.ardrone.org/">AR-Drone SDK</a> version 2.0.1. The driver supports both AR-Drone 1.0 and 2.0. "ardrone_autonomy" is a fork of <a href="http://code.google.com/p/brown-ros-pkg/wiki/ardrone_brown">AR-Drone Brown</a> driver. This package has been developed in <a href="http://autonomy.cs.sfu.ca">Autonomy Lab</a> of <a href="http://www.sfu.ca">Simon Fraser University</a> by <a href="http://sfu.ca/%7Emmonajje">Mani Monajjemi</a> ( +other <a href="#contributors">contributors</a>).</p>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
<li><a href="#updates">Updates</a></li>
<li>
<a href="#installation">Installation</a>

<ul>
<li><a href="#binary-install">Binary Install</a></li>
<li><a href="#compile-and-install-from-source">Compile and Install from Source</a></li>
</ul>
</li>
<li><a href="#how-to-run">How to Run</a></li>
<li>
<a href="#reading-from-ar-drone">Reading from AR-Drone</a>

<ul>
<li><a href="#update-frequencies-new">Update Frequencies </a></li>
<li><a href="#legacy-navigation-data">Legacy Navigation Data</a></li>
<li><a href="#imu-data">IMU data</a></li>
<li><a href="#magnetometer-data">Magnetometer Data</a></li>
<li><a href="#selective-navdata-advanced-new">Selective Navdata (Advanced) </a></li>
<li><a href="#cameras">Cameras</a></li>
<li><a href="#tag-detection">Tag Detection</a></li>
<li><a href="#update-frequencies">Update Frequencies</a></li>
</ul>
</li>
<li>
<a href="#sending-commands-to-ar-drone">Sending Commands to AR-Drone</a>

<ul>
<li>
<a href="#hover-modes-new">Hover Modes </a> :new:</li>
</ul>
</li>
<li><a href="#coordinate-frames">Coordinate Frames</a></li>
<li>
<a href="#services">Services</a>

<ul>
<li><a href="#toggle-ar-drones-camera">Toggle AR-Drone's Camera</a></li>
<li><a href="#led-animations">LED Animations</a></li>
<li><a href="#flight-animations-new">Flight Animations </a></li>
<li><a href="#imu-calibration">IMU Calibration</a></li>
<li><a href="#flat-trim">Flat Trim</a></li>
<li>
<a href="#record-to-usb-stick">Record to USB Stick</a> :new:</li>
</ul>
</li>
<li>
<a href="#parameters">Parameters</a>

<ul>
<li><a href="#ar-drone-specific-parameters">AR-Drone Specific Parameters</a></li>
<li><a href="#other-parameters">Other Parameters</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
<li><a href="#contributors">Contributors</a></li>
<li>
<a href="#faq">FAQ</a> :new:</li>
</ul>
<h2 id="updates">Updates</h2>

<ul>
<li>
<em>September 3 2014</em>: 1.3.5 <a href="https://github.com/AutonomyLab/ardrone_autonomy/milestones/1.3.5">Bug Fixes &amp; Minor Improvements</a>
</li>
<li>
<em>March 14 2014</em>: The binary packages of the driver are now built on <a href="http://wiki.ros.org/BuildFarm">ROS build farm</a>. You can install the driver for ROS <em>Hydro</em> and <em>Groovy</em> using <code>apt-get</code> on <em>Ubuntu</em>.</li>
<li>
<em>January 17 2014</em>: Fully <em>catkinized</em> package (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/75">#75</a> &amp; <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/79">#79</a>). ARDroneLib has been configured to be built as an external project. The ARDroneLib is replaced by the vanilla SDK's stripped tarball. (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/80">More info</a>).</li>
<li>
<em>October 22 2013</em>: Update to Parrot SDK 2.0.1 (Fixes crashes on 2.4.x firmwares, no support for flight recorder (yet). <strong>Please check the FAQ section for instructions on how to re-compile the SDK</strong>. (Tested on 2.3.3 and 2.4.x firmwares) </li>
<li>
<em>February 13 2013</em>: Support for USB key recording (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/53">More info</a>). Motor PWM added to legacy Navdata.</li>
<li>
<em>January 9 2013</em>: ROS Groovy support. Support for zero-command without hovering (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/34">More info</a>). Full configurable Navdata support (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/31">More info</a>). Support for "Flight Animations". Support for Real-time navdata and video publishing (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/44">More info</a>). Support for configurable data publishing rate.</li>
<li>
<em>November 9 2012</em>: Critical Bug in sending configurations to drone fixed and more parameters are supported (<a href="https://github.com/AutonomyLab/ardrone_autonomy/issues/24">More info</a>). Separate topic for magnetometer data added (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/25">More info</a>).</li>
<li>
<em>September 5 2012</em>: Experimental automatic IMU bias removal.</li>
<li>
<em>August 27 2012</em>: Thread-safe SDK data access. Synchronized <code>navdata</code> and <code>camera</code> topics.</li>
<li>
<em>August 20 2012</em>: The driver is now provides ROS standard camera interface.</li>
<li>
<em>August 17 2012</em>: Experimental <code>tf</code> support added. New published topic <code>imu</code>.</li>
<li>
<em>August 1 2012</em>: Enhanced <code>Navdata</code> message. <code>Navdata</code> now includes magnetometer data, barometer data, temperature and wind information for AR-Drone 2. <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/2">Issue #2</a>
</li>
<li>
<em>July 27 2012</em>: LED Animation Support added to the driver as a service</li>
<li>
<em>July 19 2012</em>: Initial Public Release</li>
</ul>
<h2 id="installation">Installation</h2>

<h3 id="binary-install">Binary Install</h3>

<p>On supported <em>Ubuntu</em> platform and for ROS <em>Hydro</em> and <em>Groovy</em> you can install the driver using <code>apt-get install ros-*-ardrone-autonomy</code> e.g. <code>apt-get install ros-hydro-ardrone-autonomy</code>.</p>

<h3 id="compile-and-install-from-source">Compile and Install from Source</h3>

<p>The bundled AR-Drone SDK has its own build system which usually handles system wide dependencies itself. The ROS package depends on these standard ROS packages: <code>roscpp</code>, <code>image_transport</code>, <code>sensor_msgs</code>, <code>tf</code>, <code>camera_info_manager</code> and <code>std_srvs</code>.</p>

<p>The installation follows the same steps needed usually to compile a ROS driver using <a href="http://wiki.ros.org/catkin">catkin</a>. Clone (or download and unpack) the driver to the <code>src</code> folder of a new or existing catkin <a href="http://wiki.ros.org/catkin/Tutorials/create_a_workspace">workspace</a> (e.g <code>~/catkin_ws/src</code>) and use <code>catkin_make</code> to compile. Assuming you are compiling for ROS <em>Hydro</em>:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws/src
<span class="nv">$ </span>git clone https://github.com/AutonomyLab/ardrone_autonomy.git -b groovy-devel
<span class="nv">$ </span><span class="nb">cd</span> ~/catkin_ws
<span class="nv">$ </span>catkin_make
</code></pre></div>
<p>If you need to compile for older ROS distros or you are bound to use <code>rosbuild</code>, please check the <code>fuerte-devel</code> branch.</p>

<h2 id="how-to-run">How to Run</h2>

<p>The driver's executable node is <code>ardrone_driver</code>. You can either use <code>rosrun ardrone_autonomy ardrone_driver</code> or put it in a custom launch file with your desired parameters.</p>

<h2 id="reading-from-ar-drone">Reading from AR-Drone</h2>

<h3 id="update-frequencies-:new:">Update Frequencies :new:</h3>

<p><strong>Drone Update Frequencies</strong>: The drone's data transmission update frequency depends on <code>navdata_demo</code> parameter. When it is 1, the transmission frequency will be 15Hz, otherwise it will be 200Hz. (<code>navdata_demo</code> is a numeric parameter not Boolean, so use 1 and 0 (not True/False) to set/unset it)</p>

<p><strong>Driver Update Frequencies</strong>: The driver can operate in two modes: real-time or fixed rate. When the <code>realtime_navdata</code> parameter is set to True, the driver will publish the received information instantly. However when it is set to False, the driver will cache the most recent received data, then it will publish that at a fixed rate, configured by <code>looprate</code> parameter. The default configuration is: <code>realtime_navdata=False</code> and <code>looprate=50</code>. </p>

<p>Please note that if the <code>looprate</code> is smaller than the drone's transmission frequency, there will be data loss. The driver's start-up output shows the current configuration. You can also use <code>rostopic hz</code> command to check the publish rate of the driver.</p>

<pre>
# Default Setting - 50Hz non-realtime update, the drone transmission rate is 200Hz
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=False  _navdata_demo:=0

# 200Hz real-time update
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=True _navdata_demo:=0

# 15Hz real-rime update
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=True _navdata_demo:=1
</pre>

<h3 id="legacy-navigation-data">Legacy Navigation Data</h3>

<p>Information received from the drone will be published to the <code>ardrone/navdata</code> topic. The message type is <code>ardrone_autonomy::Navdata</code> and contains the following information:</p>

<ul>
<li>
<code>header</code>: ROS message header</li>
<li>
<code>batteryPercent</code>: The remaining charge of the drone's battery (%)</li>
<li>
<code>state</code>: The Drone's current state:
    * 0: Unknown
    * 1: Inited
    * 2: Landed
    * 3,7: Flying
    * 4: Hovering
    * 5: Test (?)
    * 6: Taking off
    * 8: Landing
    * 9: Looping (?)</li>
<li>
<code>rotX</code>: Left/right tilt in degrees (rotation about the X axis)</li>
<li>
<code>rotY</code>: Forward/backward tilt in degrees (rotation about the Y axis)</li>
<li>
<code>rotZ</code>: Orientation in degrees (rotation about the Z axis)</li>
<li>
<code>magX</code>, <code>magY</code>, <code>magZ</code>: Magnetometer readings (AR-Drone 2.0 Only) (TBA: Convention)</li>
<li>
<code>pressure</code>: Pressure sensed by Drone's barometer (AR-Drone 2.0 Only) (Pa)</li>
<li>
<code>temp</code> : Temperature sensed by Drone's sensor (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_speed</code>: Estimated wind speed (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_angle</code>: Estimated wind angle (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_comp_angle</code>: Estimated wind angle compensation (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>altd</code>: Estimated altitude (mm)</li>
<li>
<code>motor1..4</code>: Motor PWM values</li>
<li>
<code>vx</code>, <code>vy</code>, <code>vz</code>: Linear velocity (mm/s) [TBA: Convention]</li>
<li>
<code>ax</code>, <code>ay</code>, <code>az</code>: Linear acceleration (g) [TBA: Convention]</li>
<li>
<code>tm</code>: Timestamp of the data returned by the Drone returned as number of micro-seconds passed since Drone's boot-up.</li>
</ul>
<p><strong>NOTE:</strong> The legacy Navdata publishing can be disabled by setting the <code>enable_legacy_navdata</code> parameter to <code>False</code> (legacy navdata is enabled by default).</p>

<h3 id="imu-data">IMU data</h3>

<p>The linear acceleration, angular velocity and orientation from the <code>Navdata</code> is also published to a standard ROS <a href="http://www.ros.org/doc/api/sensor_msgs/html/msg/Imu.html"><code>sensor_msgs/Imu</code></a> message. The units are all metric and the reference frame is in <code>Base</code> frame. This topic is experimental. The covariance values are specified by specific parameters.</p>

<h3 id="magnetometer-data">Magnetometer Data</h3>

<p>The normalized magnetometer readings are also published to <code>ardrone/mag</code> topic as a standard ROS <a href="http://www.ros.org/doc/api/geometry_msgs/html/msg/Vector3Stamped.html"><code>geometry_msgs/Vector3Stamped</code></a> message.</p>

<h3 id="selective-navdata-(advanced)-:new:">Selective Navdata (Advanced) :new:</h3>

<p>You can access almost all sensor readings, debug values and status reports sent from the AR-Drone by using "Selective Navdata". If you set any of following parameters to "True", their corresponding <code>Navdata</code> information will be published to a separate topic. For example if you enable <code>enable_navdata_time</code>, the driver will publish AR-Drone time information to <code>ardrone/navdata_time</code> topic. Most of the names are self-explanatory. Please consult AR-Drone SDK 2.0's documentation (or source code) for more information. All parameters are set to False by default.</p>

<pre>
enable_navdata_trims            enable_navdata_rc_references    enable_navdata_pwm              enable_navdata_altitude 
enable_navdata_vision_raw       enable_navdata_vision_of        enable_navdata_vision           enable_navdata_vision_perf  
enable_navdata_trackers_send    enable_navdata_vision_detect    enable_navdata_watchdog         enable_navdata_adc_data_frame   
enable_navdata_video_stream     enable_navdata_games            enable_navdata_pressure_raw     enable_navdata_magneto  
enable_navdata_wind_speed       enable_navdata_kalman_pressure  enable_navdata_hdvideo_stream   enable_navdata_wifi enable_navdata_zimmu_3000   
</pre>

<p><strong>HINT:</strong> You can <code>rostopic type ardrone/navdata_time | rosmsg show</code> command for each topic to inspect its published message's data structure.</p>

<h3 id="cameras">Cameras</h3>

<p>Both AR-Drone 1.0 and 2.0 are equipped with two cameras. One frontal camera pointing forward and one vertical camera pointing downward. This driver will create three topics for each drone: <code>ardrone/image_raw</code>, <code>ardrone/front/image_raw</code> and <code>ardrone/bottom/image_raw</code>. Each of these three are standard <a href="http://ros.org/wiki/camera_drivers">ROS camera interface</a> and publish messages of type <a href="http://www.ros.org/wiki/image_transport">image transport</a>. The driver is also a standard <a href="http://www.ros.org/wiki/camera_drivers">ROS camera driver</a>, therefor if camera calibration information is provided either as a set of ROS parameters or appropriate <code>ardrone_front.yaml</code> and/or <code>ardrone_bottom.yaml</code>, the information will be published in appropriate <code>camera_info</code> topics. Please check the FAQ section for more information.</p>

<ul>
<li><p>The <code>ardrone/*</code> will always contain the selected camera's video stream and information.</p></li>
<li>
<p>The way that the other two streams work depend on the type of Drone.</p>

<ul>
<li>Drone 1</li>
</ul>
<p>Drone 1 supports four modes of video streams: Front camera only, bottom camera only, front camera with bottom camera inside (picture in picture) and bottom camera with front camera inside (picture in picture). According to active configuration mode, the driver decomposes the PIP stream and publishes pure front/bottom streams to corresponding topics. The <code>camera_info</code> topic will include the correct image size.
* Drone 2</p>

<p>Drone 2 does not support PIP feature anymore, therefore only one of <code>ardrone/front</code> or <code>ardrone/bottom</code> topics will be updated based on which camera is selected at the time.</p>
</li>
</ul>
<h3 id="tag-detection">Tag Detection</h3>

<p>The <code>Navdata</code> message also returns the special tags that are detected by the Drone's on-board vision processing system. To learn more about the system and the way it works please consult AR-Drone SDK 2.0's <a href="https://projects.ardrone.org/projects/show/ardrone-api/">developers guide</a>. These tags are being detected on both drone's video cameras on-board at 30fps. To configure (or disable) this feature look at the "Parameters" section in this documentation.</p>

<p>The detected tags' type and position in Drone's camera frame will be published to the following variables in <code>Navdata</code> message:</p>

<ul>
<li>
<code>tags_count</code>: The number of detected tags.</li>
<li>
<code>tags_type[]</code>: Vector of types of detected tags (details below)</li>
<li>
<code>tags_xc[]</code>, <code>tags_yc[]</code>, <code>tags_width[]</code>, <code>tags_height[]</code>: Vector of position components and size components for each tag. These numbers are expressed in numbers between [0,1000]. You need to convert them back to pixel unit using the corresponding camera's resolution (can be obtained front <code>camera_info</code> topic).</li>
<li>
<code>tags_orientation[]</code>: For the tags that support orientation, this is the vector that contains the tag orientation expressed in degrees [0..360).</li>
</ul>
<p>By default, the driver will configure the drone to look for <em>oriented roundels</em> using bottom camera and <em>2D tags v2</em> on indoor shells (<em>orange-yellow</em>) using front camera. For information on how to extract information from <code>tags_type</code> field. Check the FAQ section in the end.</p>

<h3 id="update-frequencies">Update Frequencies</h3>

<p>TBA.</p>

<h2 id="sending-commands-to-ar-drone">Sending Commands to AR-Drone</h2>

<p>The drone will <em>takeoff</em>, <em>land</em> or <em>emergency stop/reset</em> by publishing an <code>Empty</code> ROS messages to the following topics: <code>ardrone/takeoff</code>, <code>ardrone/land</code> and <code>ardrone/reset</code> respectively.</p>

<p>In order to fly the drone after takeoff, you can publish a message of type <a href="http://www.ros.org/doc/api/geometry_msgs/html/msg/Twist.html"><code>geometry_msgs::Twist</code></a> to the <code>cmd_vel</code> topic.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    -linear.x: move backward
    +linear.x: move forward
    -linear.y: move right
    +linear.y: move left
    -linear.z: move down
    +linear.z: move up

    -angular.z: turn left
    +angular.z: turn right
</code></pre></div>
<p>The range for each component should be between -1.0 and 1.0. The maximum range can be configured using ROS parameters discussed later in this document. </p>

<h3 id="hover-modes-:new:">Hover Modes :new:</h3>

<p><code>geometry_msgs::Twist</code> has two other member variable called <code>angular.x</code> and <code>angular.y</code> which can be used to enable/disable "auto-hover" mode. "auto-hover" is enabled when all six components are set to <strong>zero</strong>. If you want the drone not to enter "auto hover" mode in cases you set the first four components to zero, set <code>angular.x</code> and <code>angular.y</code> to arbitrary <strong>non-zero</strong> values.</p>

<h2 id="coordinate-frames">Coordinate Frames</h2>

<p>The driver publishes two <a href="http://www.ros.org/wiki/tf"><code>tf</code></a> transforms between three reference frames: <code>${tf_prefix}/${base_prefix}_link</code>, <code>${tf_prefix}/${base_prefix}_frontcam</code> and <code>${tf_prefix}/${base_prefix}_bottomcam</code>. The <code>${tf_prefix}</code> is ROS standard way to handle multi-robot <code>tf</code> trees and can be set using <code>tf_prefix</code> parameters, by default it is empty. The <code>${base_link}</code> is the shared name prefix of all three reference frames and can also be set using parameters, by default it has the value of <code>ardrone_base</code>. Using default parameters, the three frames would be: <code>ardrone_base_link</code>, <code>ardrone_base_frontcam</code> and <code>ardrone_base_bottomcam</code>. By default the root frame is  <code>ardrone_base_link</code>. Therefor <code>ardrone_base_frontcam</code> and <code>ardrone_base_bottomcam</code> are children of <code>ardrone_base_link</code> in the published <code>tf</code> tree. This can be changed using <code>root_frame</code> parameter.</p>

<p>The <code>frame_id</code> field in header of all published topics (navdata, imu, cameras) will have the appropriate frame names. All frames are <a href="http://www.ros.org/reps/rep-0103.html">ROS REP 103</a> compatible.</p>

<h2 id="services">Services</h2>

<h3 id="toggle-ar-drone's-camera">Toggle AR-Drone's Camera</h3>

<p>Calling <code>ardrone/togglecam</code> service with no parameters will change the active video camera stream. (e.g <code>rosservice call /ardrone/togglecam</code>).</p>

<p><code>ardrone/setcamchannel</code> service directly sets the current active camera channel. One parameter (<code>uint8 channel
</code>) should be sent to this service. For AR-Drone 1.0 the valid values are [0..3] and for AR-Drone 2.0 the valid values are [0..1]. The order is similar to the order described in "Cameras" section.</p>

<h3 id="led-animations">LED Animations</h3>

<p>Calling <code>ardrone/setledanimation</code> service will invoke one of 14 pre-defined LED animations for the drone. The parameters are</p>

<ul>
<li>
<code>uint8 type</code>: The type of animation which is a number in range [0..13]</li>
<li>
<code>float32 freq</code>: The frequency of the animation in Hz</li>
<li>
<code>uint8 duration</code>: The duration of the animation in Seconds.</li>
</ul>
<p>The <code>type</code> parameter will map [in order] to one of these animations (check <code>srv/LedAnim.srv</code> for more details):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    BLINK_GREEN_RED, BLINK_GREEN, BLINK_RED, BLINK_ORANGE,
    SNAKE_GREEN_RED, FIRE, STANDARD, RED, GREEN, RED_SNAKE,BLANK,
    LEFT_GREEN_RIGHT_RED, LEFT_RED_RIGHT_GREEN, BLINK_STANDARD`
</code></pre></div>
<p>You can test these animations in command line using commands like <code>rosservice call /ardrone/setledanimation 1 4 5</code></p>

<h3 id="flight-animations-:new:">Flight Animations :new:</h3>

<p>Calling <code>ardrone/setflightanimation</code> service will execute one of 20 pre-defined flight animations for the drone. The parameters are:</p>

<ul>
<li>
<code>uint8 type</code>: The type of flight animation, a number in range [0..19]</li>
<li>
<code>uint16 duration</code>: The duration of the animation. Use 0 for default duration (recommended)</li>
</ul>
<p>The <code>type</code> parameter will map [in order] to one of these pre-defined animations (check <code>srv/FlightAnim.srv</code> for more details):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">ARDRONE_ANIM_PHI_M30_DEG, ARDRONE_ANIM_PHI_30_DEG, ARDRONE_ANIM_THETA_M30_DEG, ARDRONE_ANIM_THETA_30_DEG,
ARDRONE_ANIM_THETA_20DEG_YAW_200DEG, ARDRONE_ANIM_THETA_20DEG_YAW_M200DEG, ARDRONE_ANIM_TURNAROUND,
ARDRONE_ANIM_TURNAROUND_GODOWN, ARDRONE_ANIM_YAW_SHAKE, ARDRONE_ANIM_YAW_DANCE, ARDRONE_ANIM_PHI_DANCE,
ARDRONE_ANIM_THETA_DANCE, ARDRONE_ANIM_VZ_DANCE, ARDRONE_ANIM_WAVE, ARDRONE_ANIM_PHI_THETA_MIXED,
ARDRONE_ANIM_DOUBLE_PHI_THETA_MIXED, ARDRONE_ANIM_FLIP_AHEAD, ARDRONE_ANIM_FLIP_BEHIND, ARDRONE_ANIM_FLIP_LEFT,
ARDRONE_ANIM_FLIP_RIGHT
</code></pre></div>
<p>You can test these animations in command line using commands like <code>rosservice call /ardrone/setflightanimation 1 0</code> while drone is flying.</p>

<p>Please be extra cautious about using animations, especially flip animations.</p>

<h3 id="imu-calibration">IMU Calibration</h3>

<p>If <code>do_imu_caliberation</code> parameter is set to true, calling <code>ardrone/imu_recalib</code> service will make the driver recalculate the biases in IMU data based on data from a short sampling period.</p>

<h3 id="flat-trim">Flat Trim</h3>

<p>Calling <code>ardrone/flattrim</code> service without any parameter will send a "Flat Trim" request to AR-Drone to re-calibrate its rotation estimates assuming that it is on a flat surface. Do not call this service while Drone is flying or while the drone is not actually on a flat surface.</p>

<h3 id="record-to-usb-stick">Record to USB Stick</h3>

<p>Calling <code>ardrone/setrecord</code> service will enable and disable recording to the USB stick. The service takes a simple <code>1</code> to enable or <code>0</code> to disable. So you can turn on recording to the USB stick with <code>rosservice call /ardrone/setrecord 1</code></p>

<h2 id="parameters">Parameters</h2>

<h3 id="ar-drone-specific-parameters">AR-Drone Specific Parameters</h3>

<p>The parameters listed below are named according to AR-Drone's SDK 2.0 configuration. Unless you set the parameters using <code>rosparam</code> or in your <code>launch</code> file, the default values will be used. These values are applied during driver's initialization phase. Please refer to AR-Drone SDK 2.0's <a href="https://projects.ardrone.org/projects/show/ardrone-api/">developer's guide</a> for information about valid values. Not all the parameters will be needed during regular usage of the AR-Drone, please consult the example launch file <code>launch/ardrone.launch</code> for frequent parameters.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">altitude, altitude_max, altitude_min, ardrone_name, autonomous_flight, bitrate, bitrate_ctrl_mode, 
bitrate_storage, codec_fps, com_watchdog, control_iphone_tilt, control_level, control_vz_max, 
control_yaw, detect_type, detections_select_h, detections_select_v, detections_select_v_hsync, 
enemy_colors, enemy_without_shell, euler_angle_max, flight_anim, flight_without_shell, flying_mode, 
groundstripe_colors, hovering_range, indoor_control_vz_max, indoor_control_yaw, indoor_euler_angle_max, 
latitude, leds_anim, longitude, manual_trim, max_bitrate, max_size, navdata_demo, navdata_options, 
nb_files, outdoor, outdoor_control_vz_max, outdoor_control_yaw, outdoor_euler_angle_max, output, 
owner_mac, ssid_multi_player, ssid_single_player, travelling_enable, travelling_mode, ultrasound_freq, 
ultrasound_watchdog, userbox_cmd, video_channel, video_codec, video_enable, video_file_index, 
video_live_socket, video_on_usb, video_slices, vision_enable, wifi_mode, wifi_rate
</code></pre></div>
<p><a href="https://github.com/AutonomyLab/ardrone_autonomy/wiki/AR-Drone-Parameters">This wiki page</a> includes more information about each of above parameters.</p>

<h3 id="other-parameters">Other Parameters</h3>

<p>These parameters control the behaviour of the driver.</p>

<ul>
<li>
<code>drone_frame_id</code> - The "frame_id" prefix to be used in all <code>tf</code> frame names - default: "ardrone_base"</li>
<li>
<code>root_frame</code> - The default root in drone's <code>tf</code> tree (0: _link, 1: _frontcam, 2: _bottomcam) - Default: 0</li>
<li>
<code>cov/imu_la</code>, <code>cov/imu_av</code> &amp; <code>cov/imu_or</code>: List of 9 covariance values to be used in <code>imu</code>'s topic linear acceleration, angular velocity and orientation fields respectively - Default: 0.0 for all members (Please check the FAQ section for a sample launch file that shows how to set these values)</li>
<li>
<code>do_imu_calibration</code>: [EXPERIMENTAL] Should the drone cancel the biases in IMU data - Default: 0</li>
<li>
<code>enable_legacy_navdata</code>: Enable legacy <code>Navdata</code> publish - Default: True</li>
</ul>
<h2 id="license">License</h2>

<ul>
<li>[The Parrot's license, copyright and disclaimer for <code>ARDroneLib</code>]<a href="https://github.com/AutonomyLab/ardronelib/blob/master/LICENSE">https://github.com/AutonomyLab/ardronelib/blob/master/LICENSE</a>) </li>
<li>Other parts of the code are subject to <code>BSD</code> license.</li>
</ul>
<h2 id="contributors">Contributors</h2>

<p><a href="http://autonomylab.org/ardrone_autonomy/contribution.html">List of all commiters to the repository</a>.</p>

<ul>
<li>@mikehamer - Added support for proper SDK2 way of configuring the Drone via parameter (critical bug fix) (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/26">More Info</a>). Support for zero-command without hovering (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/34">More info</a>). Full configurable Navdata support (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/31">More info</a>). Support for Real-time navdata and video publishing (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/44">More info</a>). Support for configurable data publishing rate.</li>
<li>@JakobEngel</li>
<li>@sameerparekh - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/53">Turn on and off USB stick recording</a> - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/25">Seperate Magnetometer Topic</a>
</li>
<li>@devmax - <a href="https://github.com/AutonomyLab/ardrone_autonomy/issues/18">Flat Trim</a> + Various comments for enhancements</li>
<li>@younata - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/2">Enhanced Navdata for AR-Drone 2.0</a>
</li>
<li>@boris-il-forte &amp; @lesire - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/79">Catkinization</a> <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/82">+</a>
</li>
<li>@kbogert - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/80">Move ARDroneLIB to an external project</a>
</li>
<li>@garyservin - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/109">Fix ffmpeg library link order</a>, <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/110">Moved header files to include directory</a>, <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/117">Add pressure unit</a>
</li>
</ul>
<h2 id="faq">FAQ</h2>

<h3 id="where-should-i-go-next?-is-there-any-ros-package-or-stack-that-can-be-used-as-a-tutorial/sample-to-use-ardrone_autonomy?">Where should I go next? Is there any ROS package or stack that can be used as a tutorial/sample to use ardrone_autonomy?</h3>

<p>Absolutely. Here are some examples:</p>

<ul>
<li><a href="https://github.com/FalkorSystems/falkor_ardrone">falkor_ardrone</a></li>
</ul>
<p>"falkor_ardrone" is a ROS package which uses the "ardrone_autonomy" package to implement autonomous control functionality on an AR.Drone.</p>

<ul>
<li><a href="http://www.ros.org/wiki/tum_ardrone">tum_ardrone</a></li>
</ul>
<p>State Estimation, Autopilot and GUI for ardrone.</p>

<ul>
<li><a href="https://github.com/parcon/arl_ardrone_examples">arl_ardrone_examples</a></li>
</ul>
<p>This ROS stack includes a series of very basic nodes to show users how to develop applications that use the ardrone_autonomy drivers for the AR drone 1.0 and 2.0 quadrotor robot.</p>

<ul>
<li><a href="https://github.com/mikehamer/ardrone_tutorials">AR Drone Tutorials</a></li>
</ul>
<p>This repository contains the source-code for the Up and flying with the AR.Drone and ROS tutorial series, published on <a href="http://www.robohub.org">Robohub</a>.</p>

<h3 id="how-can-i-report-a-bug,-submit-patches-or-ask-for-a-feature?">How can I report a bug, submit patches or ask for a feature?</h3>

<p><code>github</code> offers a nice and convenient issue tracking and social coding platform, it can be used for bug reports and pull/feature request. This is the preferred method. You can also contact the author directly.</p>

<p>If you want to submit a pull request, please submit to <code>dev-unstable</code> branch.</p>

<h3 id="why-the-ardronelib-has-been-patched?">Why the <code>ARDroneLib</code> has been patched?</h3>

<p>The ARDrone 2.0.1 SDK has been patched to 1) Enable the lib only build 2) Make its command line parsing compatible with ROS and 3) To fix its weird <code>main()</code> function issue. The patched SDK is being hosted on an <a href="https://github.com/AutonomyLab/ardronelib">external repository</a>.</p>

<h3 id="why-the-wifi-bandwidth-usage-is-too-much?">Why the wifi bandwidth usage is too much?</h3>

<p>The driver has been configured by default to use the maximum bandwidth allowed to ensure the best quality video stream possible (please take a look at default values in parameters section). That is the reason why the picture quality received from Drone 2.0 using this driver is far better than what you usually get using other software. If for any reason you prefer the lower quality* video stream, change <code>bitrate_ctrl_mode</code>, <code>max_bitrate</code> and <code>bitrate</code> parameters to the default values provided by the AR-Drone developer guide.</p>

<p>(*) Please note that lower quality does not mean lower resolution. By configuring AR-Drone to use bitrate control with limits, the picture gets blurry when there is a movement.</p>

<h3 id="what-is-the-default-configuration-for-the-front-camera-video-stream?">What is the default configuration for the front camera video stream?</h3>

<p><em>Drone 1</em>: 320x240@15fps UVLC Codec
<em>Drone 2</em>: 640x360@20fps H264 codec with no record stream</p>

<h3 id="how-can-i-extract-camera-information-and-tag-type-from-tags_type[]?">How can I extract camera information and tag type from <code>tags_type[]</code>?</h3>

<p><code>tag_type</code> contains information for both source and type of each detected tag. In order to extract information from them you can use the following c macros and enums (taken from <code>ardrone_api.h</code>)</p>
<div class="highlight"><pre><code class="language-c++" data-lang="c++"><span class="cp">#define DETECTION_EXTRACT_SOURCE(type)  ( ((type)&gt;&gt;16) &amp; 0x0FF )</span>
<span class="cp">#define DETECTION_EXTRACT_TAG(type)     ( (type) &amp; 0x0FF )</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <span class="n">DETECTION_SOURCE_CAMERA_HORIZONTAL</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="cm">/*&lt;! Tag was detected on the front camera picture */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_VERTICAL</span><span class="p">,</span>       <span class="cm">/*&lt;! Tag was detected on the vertical camera picture at full speed */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_VERTICAL_HSYNC</span><span class="p">,</span> <span class="cm">/*&lt;! Tag was detected on the vertical camera picture inside the horizontal pipeline */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_NUM</span><span class="p">,</span>
<span class="p">}</span> <span class="n">DETECTION_SOURCE_CAMERA</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <span class="n">TAG_TYPE_NONE</span>             <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">TAG_TYPE_SHELL_TAG</span>        <span class="p">,</span>
  <span class="n">TAG_TYPE_ROUNDEL</span>          <span class="p">,</span>
  <span class="n">TAG_TYPE_ORIENTED_ROUNDEL</span> <span class="p">,</span>
  <span class="n">TAG_TYPE_STRIPE</span>           <span class="p">,</span>
  <span class="n">TAG_TYPE_CAP</span>              <span class="p">,</span>
  <span class="n">TAG_TYPE_SHELL_TAG_V2</span>     <span class="p">,</span>
  <span class="n">TAG_TYPE_TOWER_SIDE</span>       <span class="p">,</span>
  <span class="n">TAG_TYPE_BLACK_ROUNDEL</span>    <span class="p">,</span>
  <span class="n">TAG_TYPE_NUM</span>
<span class="p">}</span> <span class="n">TAG_TYPE</span><span class="p">;</span>
</code></pre></div>
<h3 id="how-can-i-calibrate-the-ardrone-front/bottom-camera?">How can I calibrate the ardrone front/bottom camera?</h3>

<p>It is easy to calibrate both cameras using ROS <a href="http://www.ros.org/wiki/camera_calibration">Camera Calibration</a> package.</p>

<p>First, run the camera_calibration node with appropriate arguments: (For the bottom camera, replace front with bottom)</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">rosrun camera_calibration cameracalibrator.py --size <span class="o">[</span>SIZE<span class="o">]</span> --square <span class="o">[</span>SQUARESIZE<span class="o">]</span> image:<span class="o">=</span>/ardrone/front/image_raw camera:<span class="o">=</span>/ardrone/front
</code></pre></div>
<p>After successful calibration, press the <code>commit</code> button in the UI. The driver will receive the data from the camera calibration node, then will save the information by default in <code>~/.ros/camera_info/ardrone_front.yaml</code>. From this point on, whenever you run the driver on the same computer this file will be loaded automatically by the driver and its information will be published to appropriate <code>camera_info</code> topic. Sample calibration files for AR-Drone 2.0's cameras are provided in <code>data/camera_info</code> folder.</p>

<h3 id="can-i-see-a-sample-ardrone-node-in-a-launch-file-to-learn-how-to-set-parameters?">Can I see a sample ardrone node in a launch file to learn how to set parameters?</h3>

<p>Yes, you can check the <code>launch</code> folder for sample lanuch file.</p>

<h3 id="can-i-control-multiple-drones-using-a-single-pc?-or-can-i-make-my-drone-connect-to-a-wireless-router?">Can I control multiple drones using a single PC? or can I make my drone connect to a wireless router?</h3>

<p>With some hacking yes! This <a href="https://github.com/AutonomyLab/ardrone_autonomy/wiki/Multiple-AR-Drones">wiki page</a> contains some information regarding this issue.</p>

<h3 id="how-to-re-compile-parrot-sdk?">How to re-compile parrot SDK?</h3>

<p>If the <code>git</code> updates include a SDK upgrade, you'd better cleanup previous vuild files.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd </span>ARDroneLib/Soft/Build
make clean
rm -rf targets_versions
</code></pre></div>
<p>Build the SDK and driver again.</p>

<h2 id="todo">TODO</h2>

<ul>
<li>Make the <code>tf</code> publish optional.</li>
<li>Add the currently selected camera name to <code>Navdata</code>
</li>
<li>[DONE] Add separate topic for drone's debug stream (<code>navdata_demo</code>)</li>
<li>[DONE] Make the <code>togglecam</code> service accept parameters</li>
<li>[DONE] Enrich <code>Navdata</code> with magneto meter and baro meter information</li>
</ul>
</div></body></html>

            
          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-fuerte">
    <div class="container-fluid">
      
        <div class="panel panel-default">
          
          
          <div class="panel-heading"><h3 class="panel-title">Repository Summary</h3></div>
          <div class="panel-body" style="overflow-x: auto">
            

  <table class="table table-condensed">
    <tr>
      <td style="width:100px;" class="text-right"><b>Checkout URI</b></td>
      <td><a class="label label-default" href="https://github.com/AutonomyLab/ardrone_autonomy.git">https://github.com/AutonomyLab/ardrone_autonomy.git</a></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Type</b></td>
      <td><span class="label label-default">git</span></td>
    </tr>
    <tr>
      <td class="text-right"><b>VCS Version</b></td>
      <td><span class="label label-default">fuerte-devel</span></td>
    </tr>
    <tr>
      <td style="white-space: nowrap;" class="text-right"><b>Last Updated</b></div>
      <td>
        
          <span class="label label-default"><span class="glyphicon glyphicon-time"></span> 2013-11-15
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Dev Status</b></td>
      <td>
        
          <span class="label label-warning">UNMAINTAINED
        </span>
      </td>
    </tr>
    <tr>
      <td class="text-right"><b>Released</b></td>
      <td>
        
          <span class="label label-default">UNRELEASED
        </span>
      </td>
    </tr>
  </table>

          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">Packages</h3></div>
          <div class="panel-body">
            
            
              <table class="table table-condensed table-hover table-striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Version</th>
                  </tr>
                </thead>
                <tbody>
                
                  <tr>
                    <td><a href="/p/ardrone_autonomy/github-AutonomyLab-ardrone_autonomy">ardrone_autonomy</a></td>
                    <td>UNKNOWN</td>
                  </tr>
                
                </tbody>
              </table>
            
          </div>
        </div>

        <div class="panel panel-default">
          <div class="panel-heading"><h3 class="panel-title">README</h3></div>
          <div class="panel-body">
            
              <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div class="rendered-markdown">
<h1 id="ardrone_autonomy-:-a-ros-driver-for-ardrone-1.0-&amp;-2.0">ardrone_autonomy : A ROS Driver for ARDrone 1.0 &amp; 2.0</h1>

<p>"ardrone_autonomy" is a <a href="http://ros.org/" title="Robot Operating System">ROS</a> driver for <a href="http://http://ardrone.parrot.com/parrot-ar-drone/select-site">Parrot AR-Drone</a> quadrocopter. This driver is based on official <a href="https://projects.ardrone.org/">AR-Drone SDK</a> version 2.0 and supports both AR-Drone 1.0 and 2.0. "ardrone_autonomy" is a fork of <a href="http://code.google.com/p/brown-ros-pkg/wiki/ardrone_brown">AR-Drone Brown</a> driver. This package has been developed in <a href="http://autonomy.cs.sfu.ca">Autonomy Lab</a> of <a href="http://www.sfu.ca">Simon Fraser University</a> by <a href="http://sfu.ca/%7Emmonajje">Mani Monajjemi</a> ( +other <a href="#contributors">contributors</a>).</p>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
<li><a href="#updates">Updates</a></li>
<li>
<a href="#installation">Installation</a>

<ul>
<li><a href="#pre-requirements">Pre-requirements</a></li>
<li><a href="#installation-steps">Installation Steps</a></li>
</ul>
</li>
<li><a href="#how-to-run">How to Run</a></li>
<li>
<a href="#reading-from-ar-drone">Reading from AR-Drone</a>

<ul>
<li><a href="#update-frequencies-new">Update Frequencies </a></li>
<li><a href="#legacy-navigation-data">Legacy Navigation Data</a></li>
<li><a href="#imu-data">IMU data</a></li>
<li><a href="#magnetometer-data">Magnetometer Data</a></li>
<li><a href="#selective-navdata-advanced-new">Selective Navdata (Advanced) </a></li>
<li><a href="#cameras">Cameras</a></li>
<li><a href="#tag-detection">Tag Detection</a></li>
<li><a href="#update-frequencies">Update Frequencies</a></li>
</ul>
</li>
<li>
<a href="#sending-commands-to-ar-drone">Sending Commands to AR-Drone</a>

<ul>
<li>
<a href="#hover-modes-new">Hover Modes </a> :new:</li>
</ul>
</li>
<li><a href="#coordinate-frames">Coordinate Frames</a></li>
<li>
<a href="#services">Services</a>

<ul>
<li><a href="#toggle-ar-drones-camera">Toggle AR-Drone's Camera</a></li>
<li><a href="#led-animations">LED Animations</a></li>
<li><a href="#flight-animations-new">Flight Animations </a></li>
<li><a href="#imu-calibration">IMU Calibration</a></li>
<li><a href="#flat-trim">Flat Trim</a></li>
<li>
<a href="#record-to-usb-stick">Record to USB Stick</a> :new:</li>
</ul>
</li>
<li>
<a href="#parameters">Parameters</a>

<ul>
<li><a href="#ar-drone-specific-parameters">AR-Drone Specific Parameters</a></li>
<li><a href="#other-parameters">Other Parameters</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
<li><a href="#contributors">Contributors</a></li>
<li>
<a href="#faq">FAQ</a> :new:</li>
</ul>
<h2 id="updates">Updates</h2>

<ul>
<li>
<em>October 22 2013</em>: Update to Parrot SDK 2.0.1 (Fixes crashes on 2.4.x firmwares, no support for flight recorder (yet). <strong>Please check the FAQ section for instructions on how to re-compile the SDK</strong>. (Tested on 2.3.3 and 2.4.x firmwares) </li>
<li>
<em>February 13 2013</em>: Support for USB key recording (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/53">More info</a>). Motor PWM added to legacy Navdata.</li>
<li>
<em>January 9 2013</em>: ROS Groovy support. Support for zero-command without hovering (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/34">More info</a>). Full configurable Navdata support (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/31">More info</a>). Support for "Flight Animations". Support for Real-time navdata and video publishing (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/44">More info</a>). Support for configurable data publishing rate.</li>
<li>
<em>November 9 2012</em>: Critical Bug in sending configurations to drone fixed and more parameters are supported (<a href="https://github.com/AutonomyLab/ardrone_autonomy/issues/24">More info</a>). Separate topic for magnetometer data added (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/25">More info</a>).</li>
<li>
<em>September 5 2012</em>: Experimental automatic IMU bias removal.</li>
<li>
<em>August 27 2012</em>: Thread-safe SDK data access. Synchronized <code>navdata</code> and <code>camera</code> topics.</li>
<li>
<em>August 20 2012</em>: The driver is now provides ROS standard camera interface.</li>
<li>
<em>August 17 2012</em>: Experimental <code>tf</code> support added. New published topic <code>imu</code>.</li>
<li>
<em>August 1 2012</em>: Enhanced <code>Navdata</code> message. <code>Navdata</code> now includes magnetometer data, barometer data, temperature and wind information for AR-Drone 2. <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/2">Issue #2</a>
</li>
<li>
<em>July 27 2012</em>: LED Animation Support added to the driver as a service</li>
<li>
<em>July 19 2012</em>: Initial Public Release</li>
</ul>
<h2 id="installation">Installation</h2>

<h3 id="pre-requirements">Pre-requirements</h3>

<p>This driver has been tested on Linux machines running Ubuntu 11.10, 12.04 &amp; 12.10 (32 bit and 64 bit). However it should also work on any other mainstream Linux distribution. The driver has been tested on both ROS "electric" and "fuerte". The AR-Drone SDK has its own build system which usually handles system wide dependencies itself. The ROS package depends on these standard ROS packages: <code>roscpp</code>, <code>image_transport</code>, <code>sensor_msgs</code>, <code>tf</code>, <code>camera_info_manager</code> and <code>std_srvs</code>.</p>

<h3 id="installation-steps">Installation Steps</h3>

<p>The installation follows the same steps needed usually to compile a ROS driver.</p>

<ul>
<li>Get the code: Clone (or download and unpack) the driver to your personal ROS stacks folder (e.g. ~/ros/stacks) and <code>cd</code> to it. Please make sure that this folder is in your <code>ROS_PACKAGE_PATH</code> environmental variable.</li>
</ul>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">        <span class="nv">$ </span><span class="nb">cd</span> ~/ros/stacks
        <span class="nv">$ </span>git clone https://github.com/AutonomyLab/ardrone_autonomy.git
        <span class="nv">$ </span>rosstack profile <span class="o">&amp;&amp;</span> rospack profile
        <span class="nv">$ </span>roscd ardrone_autonomy
</code></pre></div>
<p><strong>NOTE (For advanced users):</strong> Instead of the <code>master</code> branch you can use the <code>dev-unstable</code> branch for the latest <em>unstable</em> code which may contain bug fixes or new features. This is the branch that all developments happen on. Please use this branch to submit pull requests.</p>

<ul>
<li>Compile the AR-Drone SDK: The driver contains a slightly patched version of AR-Drone 2.0 SDK which is located in <code>ARDroneLib</code> directory. To compile it, execute the <code>./build_sdk.sh</code>. Any system-wide dependency will be managed by the SDK's build script. You may be asked to install some packages during the installation procedure (e.g <code>daemontools</code>). You can verify the success of the SDK's build by checking the <code>lib</code> folder.</li>
</ul>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">        <span class="nv">$ </span>./build_sdk.sh
        <span class="nv">$ </span><span class="o">[</span>After a couple of minutes<span class="o">]</span>
        <span class="nv">$ </span>ls ./lib

        libavcodec.a   libavformat.a    libpc_ardrone_notool.a  libvlib.a
        libavdevice.a  libavutil.a      libsdk.a
        libavfilter.a  libpc_ardrone.a  libswscale.a
</code></pre></div>
<ul>
<li>Compile the driver: You can easily compile the driver by using <code>rosmake ardrone_autonomy</code> command.</li>
</ul>
<h2 id="how-to-run">How to Run</h2>

<p>The driver's executable node is <code>ardrone_driver</code>. You can either use <code>rosrun ardrone_autonomy ardrone_driver</code> or put it in a custom launch file with your desired parameters.</p>

<h2 id="reading-from-ar-drone">Reading from AR-Drone</h2>

<h3 id="update-frequencies-:new:">Update Frequencies :new:</h3>

<p><strong>Drone Update Frequencies</strong>: The drone's data transmission update frequency depends on <code>navdata_demo</code> parameter. When it is 1, the transmission frequency will be 15Hz, otherwise it will be 200Hz. (<code>navdata_demo</code> is a numeric parameter not Boolean, so use 1 and 0 (not True/False) to set/unset it)</p>

<p><strong>Driver Update Frequencies</strong>: The driver can operate in two modes: real-time or fixed rate. When the <code>realtime_navdata</code> parameter is set to True, the driver will publish the received information instantly. However when it is set to False, the driver will cache the most recent received data, then it will publish that at a fixed rate, configured by <code>looprate</code> parameter. The default configuration is: <code>realtime_navdata=False</code> and <code>looprate=50</code>. </p>

<p>Please note that if the <code>looprate</code> is smaller than the drone's transmission frequency, there will be data loss. The driver's start-up output shows the current configuration. You can also use <code>rostopic hz</code> command to check the publish rate of the driver.</p>

<pre>
# Default Setting - 50Hz non-realtime update, the drone transmission rate is 200Hz
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=False  _navdata_demo:=0

# 200Hz real-time update
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=True _navdata_demo:=0

# 15Hz real-rime update
rosrun ardrone_autonomy ardrone_driver _realtime_navdata:=True _navdata_demo:=1
</pre>

<h3 id="legacy-navigation-data">Legacy Navigation Data</h3>

<p>Information received from the drone will be published to the <code>ardrone/navdata</code> topic. The message type is <code>ardrone_autonomy::Navdata</code> and contains the following information:</p>

<ul>
<li>
<code>header</code>: ROS message header</li>
<li>
<code>batteryPercent</code>: The remaining charge of the drone's battery (%)</li>
<li>
<code>state</code>: The Drone's current state:
    * 0: Unknown
    * 1: Inited
    * 2: Landed
    * 3,7: Flying
    * 4: Hovering
    * 5: Test (?)
    * 6: Taking off
    * 8: Landing
    * 9: Looping (?)</li>
<li>
<code>rotX</code>: Left/right tilt in degrees (rotation about the X axis)</li>
<li>
<code>rotY</code>: Forward/backward tilt in degrees (rotation about the Y axis)</li>
<li>
<code>rotZ</code>: Orientation in degrees (rotation about the Z axis)</li>
<li>
<code>magX</code>, <code>magY</code>, <code>magZ</code>: Magnetometer readings (AR-Drone 2.0 Only) (TBA: Convention)</li>
<li>
<code>pressure</code>: Pressure sensed by Drone's barometer (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>temp</code> : Temperature sensed by Drone's sensor (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_speed</code>: Estimated wind speed (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_angle</code>: Estimated wind angle (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>wind_comp_angle</code>: Estimated wind angle compensation (AR-Drone 2.0 Only) (TBA: Unit)</li>
<li>
<code>altd</code>: Estimated altitude (mm)</li>
<li>
<code>motor1..4</code>: Motor PWM values</li>
<li>
<code>vx</code>, <code>vy</code>, <code>vz</code>: Linear velocity (mm/s) [TBA: Convention]</li>
<li>
<code>ax</code>, <code>ay</code>, <code>az</code>: Linear acceleration (g) [TBA: Convention]</li>
<li>
<code>tm</code>: Timestamp of the data returned by the Drone returned as number of micro-seconds passed since Drone's boot-up.</li>
</ul>
<p><strong>NOTE:</strong> The legacy Navdata publishing can be disabled by setting the <code>enable_legacy_navdata</code> parameter to <code>False</code> (legacy navdata is enabled by default).</p>

<h3 id="imu-data">IMU data</h3>

<p>The linear acceleration, angular velocity and orientation from the <code>Navdata</code> is also published to a standard ROS <a href="http://www.ros.org/doc/api/sensor_msgs/html/msg/Imu.html"><code>sensor_msgs/Imu</code></a> message. The units are all metric and the reference frame is in <code>Base</code> frame. This topic is experimental. The covariance values are specified by specific parameters.</p>

<h3 id="magnetometer-data">Magnetometer Data</h3>

<p>The normalized magnetometer readings are also published to <code>ardrone/mag</code> topic as a standard ROS <a href="http://www.ros.org/doc/api/geometry_msgs/html/msg/Vector3Stamped.html"><code>geometry_msgs/Vector3Stamped</code></a> message.</p>

<h3 id="selective-navdata-(advanced)-:new:">Selective Navdata (Advanced) :new:</h3>

<p>You can access almost all sensor readings, debug values and status reports sent from the AR-Drone by using "Selective Navdata". If you set any of following parameters to "True", their corresponding <code>Navdata</code> information will be published to a separate topic. For example if you enable <code>enable_navdata_time</code>, the driver will publish AR-Drone time information to <code>ardrone/navdata_time</code> topic. Most of the names are self-explanatory. Please consult AR-Drone SDK 2.0's documentation (or source code) for more information. All parameters are set to False by default.</p>

<pre>
enable_navdata_trims            enable_navdata_rc_references    enable_navdata_pwm              enable_navdata_altitude 
enable_navdata_vision_raw       enable_navdata_vision_of        enable_navdata_vision           enable_navdata_vision_perf  
enable_navdata_trackers_send    enable_navdata_vision_detect    enable_navdata_watchdog         enable_navdata_adc_data_frame   
enable_navdata_video_stream     enable_navdata_games            enable_navdata_pressure_raw     enable_navdata_magneto  
enable_navdata_wind_speed       enable_navdata_kalman_pressure  enable_navdata_hdvideo_stream   enable_navdata_wifi enable_navdata_zimmu_3000   
</pre>

<p><strong>HINT:</strong> You can <code>rostopic type ardrone/navdata_time | rosmsg show</code> command for each topic to inspect its published message's data structure.</p>

<h3 id="cameras">Cameras</h3>

<p>Both AR-Drone 1.0 and 2.0 are equipped with two cameras. One frontal camera pointing forward and one vertical camera pointing downward. This driver will create three topics for each drone: <code>ardrone/image_raw</code>, <code>ardrone/front/image_raw</code> and <code>ardrone/bottom/image_raw</code>. Each of these three are standard <a href="http://ros.org/wiki/camera_drivers">ROS camera interface</a> and publish messages of type <a href="http://www.ros.org/wiki/image_transport">image transport</a>. The driver is also a standard <a href="http://www.ros.org/wiki/camera_drivers">ROS camera driver</a>, therefor if camera calibration information is provided either as a set of ROS parameters or appropriate <code>ardrone_front.yaml</code> and/or <code>ardrone_bottom.yaml</code>, the information will be published in appropriate <code>camera_info</code> topics. Please check the FAQ section for more information.</p>

<ul>
<li><p>The <code>ardrone/*</code> will always contain the selected camera's video stream and information.</p></li>
<li>
<p>The way that the other two streams work depend on the type of Drone.</p>

<ul>
<li>Drone 1</li>
</ul>
<p>Drone 1 supports four modes of video streams: Front camera only, bottom camera only, front camera with bottom camera inside (picture in picture) and bottom camera with front camera inside (picture in picture). According to active configuration mode, the driver decomposes the PIP stream and publishes pure front/bottom streams to corresponding topics. The <code>camera_info</code> topic will include the correct image size.
* Drone 2</p>

<p>Drone 2 does not support PIP feature anymore, therefore only one of <code>ardrone/front</code> or <code>ardrone/bottom</code> topics will be updated based on which camera is selected at the time.</p>
</li>
</ul>
<h3 id="tag-detection">Tag Detection</h3>

<p>The <code>Navdata</code> message also returns the special tags that are detected by the Drone's on-board vision processing system. To learn more about the system and the way it works please consult AR-Drone SDK 2.0's <a href="https://projects.ardrone.org/projects/show/ardrone-api/">developers guide</a>. These tags are being detected on both drone's video cameras on-board at 30fps. To configure (or disable) this feature look at the "Parameters" section in this documentation.</p>

<p>The detected tags' type and position in Drone's camera frame will be published to the following variables in <code>Navdata</code> message:</p>

<ul>
<li>
<code>tags_count</code>: The number of detected tags.</li>
<li>
<code>tags_type[]</code>: Vector of types of detected tags (details below)</li>
<li>
<code>tags_xc[]</code>, <code>tags_yc[]</code>, <code>tags_width[]</code>, <code>tags_height[]</code>: Vector of position components and size components for each tag. These numbers are expressed in numbers between [0,1000]. You need to convert them back to pixel unit using the corresponding camera's resolution (can be obtained front <code>camera_info</code> topic).</li>
<li>
<code>tags_orientation[]</code>: For the tags that support orientation, this is the vector that contains the tag orientation expressed in degrees [0..360).</li>
</ul>
<p>By default, the driver will configure the drone to look for <em>oriented roundels</em> using bottom camera and <em>2D tags v2</em> on indoor shells (<em>orange-yellow</em>) using front camera. For information on how to extract information from <code>tags_type</code> field. Check the FAQ section in the end.</p>

<h3 id="update-frequencies">Update Frequencies</h3>

<p>TBA.</p>

<h2 id="sending-commands-to-ar-drone">Sending Commands to AR-Drone</h2>

<p>The drone will <em>takeoff</em>, <em>land</em> or <em>emergency stop/reset</em> by publishing an <code>Empty</code> ROS messages to the following topics: <code>ardrone/takeoff</code>, <code>ardrone/land</code> and <code>ardrone/reset</code> respectively.</p>

<p>In order to fly the drone after takeoff, you can publish a message of type <a href="http://www.ros.org/doc/api/geometry_msgs/html/msg/Twist.html"><code>geometry_msgs::Twist</code></a> to the <code>cmd_vel</code> topic.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    -linear.x: move backward
    +linear.x: move forward
    -linear.y: move right
    +linear.y: move left
    -linear.z: move down
    +linear.z: move up

    -angular.z: turn left
    +angular.z: turn right
</code></pre></div>
<p>The range for each component should be between -1.0 and 1.0. The maximum range can be configured using ROS parameters discussed later in this document. </p>

<h3 id="hover-modes-:new:">Hover Modes :new:</h3>

<p><code>geometry_msgs::Twist</code> has two other member variable called <code>angular.x</code> and <code>angular.y</code> which can be used to enable/disable "auto-hover" mode. "auto-hover" is enabled when all six components are set to <strong>zero</strong>. If you want the drone not to enter "auto hover" mode in cases you set the first four components to zero, set <code>angular.x</code> and <code>angular.y</code> to arbitrary <strong>non-zero</strong> values.</p>

<h2 id="coordinate-frames">Coordinate Frames</h2>

<p>The driver publishes two <a href="http://www.ros.org/wiki/tf"><code>tf</code></a> transforms between three reference frames: <code>${tf_prefix}/${base_prefix}_link</code>, <code>${tf_prefix}/${base_prefix}_frontcam</code> and <code>${tf_prefix}/${base_prefix}_bottomcam</code>. The <code>${tf_prefix}</code> is ROS standard way to handle multi-robot <code>tf</code> trees and can be set using <code>tf_prefix</code> parameters, by default it is empty. The <code>${base_link}</code> is the shared name prefix of all three reference frames and can also be set using parameters, by default it has the value of <code>ardrone_base</code>. Using default parameters, the three frames would be: <code>ardrone_base_link</code>, <code>ardrone_base_frontcam</code> and <code>ardrone_base_bottomcam</code>. By default the root frame is  <code>ardrone_base_link</code>. Therefor <code>ardrone_base_frontcam</code> and <code>ardrone_base_bottomcam</code> are children of <code>ardrone_base_link</code> in the published <code>tf</code> tree. This can be changed using <code>root_frame</code> parameter.</p>

<p>The <code>frame_id</code> field in header of all published topics (navdata, imu, cameras) will have the appropriate frame names. All frames are <a href="http://www.ros.org/reps/rep-0103.html">ROS REP 103</a> compatible.</p>

<h2 id="services">Services</h2>

<h3 id="toggle-ar-drone's-camera">Toggle AR-Drone's Camera</h3>

<p>Calling <code>ardrone/togglecam</code> service with no parameters will change the active video camera stream. (e.g <code>rosservice call /ardrone/togglecam</code>).</p>

<p><code>ardrone/setcamchannel</code> service directly sets the current active camera channel. One parameter (<code>uint8 channel
</code>) should be sent to this service. For AR-Drone 1.0 the valid values are [0..3] and for AR-Drone 2.0 the valid values are [0..1]. The order is similar to the order described in "Cameras" section.</p>

<h3 id="led-animations">LED Animations</h3>

<p>Calling <code>ardrone/setledanimation</code> service will invoke one of 14 pre-defined LED animations for the drone. The parameters are</p>

<ul>
<li>
<code>uint8 type</code>: The type of animation which is a number in range [0..13]</li>
<li>
<code>float32 freq</code>: The frequency of the animation in Hz</li>
<li>
<code>uint8 duration</code>: The duration of the animation in Seconds.</li>
</ul>
<p>The <code>type</code> parameter will map [in order] to one of these animations (check <code>srv/LedAnim.srv</code> for more details):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">    BLINK_GREEN_RED, BLINK_GREEN, BLINK_RED, BLINK_ORANGE,
    SNAKE_GREEN_RED, FIRE, STANDARD, RED, GREEN, RED_SNAKE,BLANK,
    LEFT_GREEN_RIGHT_RED, LEFT_RED_RIGHT_GREEN, BLINK_STANDARD`
</code></pre></div>
<p>You can test these animations in command line using commands like <code>rosservice call /ardrone/setledanimation 1 4 5</code></p>

<h3 id="flight-animations-:new:">Flight Animations :new:</h3>

<p>Calling <code>ardrone/setflightanimation</code> service will execute one of 20 pre-defined flight animations for the drone. The parameters are:</p>

<ul>
<li>
<code>uint8 type</code>: The type of flight animation, a number in range [0..19]</li>
<li>
<code>uint16 duration</code>: The duration of the animation. Use 0 for default duration (recommended)</li>
</ul>
<p>The <code>type</code> parameter will map [in order] to one of these pre-defined animations (check <code>srv/FlightAnim.srv</code> for more details):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">ARDRONE_ANIM_PHI_M30_DEG, ARDRONE_ANIM_PHI_30_DEG, ARDRONE_ANIM_THETA_M30_DEG, ARDRONE_ANIM_THETA_30_DEG,
ARDRONE_ANIM_THETA_20DEG_YAW_200DEG, ARDRONE_ANIM_THETA_20DEG_YAW_M200DEG, ARDRONE_ANIM_TURNAROUND,
ARDRONE_ANIM_TURNAROUND_GODOWN, ARDRONE_ANIM_YAW_SHAKE, ARDRONE_ANIM_YAW_DANCE, ARDRONE_ANIM_PHI_DANCE,
ARDRONE_ANIM_THETA_DANCE, ARDRONE_ANIM_VZ_DANCE, ARDRONE_ANIM_WAVE, ARDRONE_ANIM_PHI_THETA_MIXED,
ARDRONE_ANIM_DOUBLE_PHI_THETA_MIXED, ARDRONE_ANIM_FLIP_AHEAD, ARDRONE_ANIM_FLIP_BEHIND, ARDRONE_ANIM_FLIP_LEFT,
ARDRONE_ANIM_FLIP_RIGHT
</code></pre></div>
<p>You can test these animations in command line using commands like <code>rosservice call /ardrone/setflightanimation 1 0</code> while drone is flying.</p>

<p>Please be extra cautious about using animations, especially flip animations.</p>

<h3 id="imu-calibration">IMU Calibration</h3>

<p>If <code>do_imu_caliberation</code> parameter is set to true, calling <code>ardrone/imu_recalib</code> service will make the driver recalculate the biases in IMU data based on data from a short sampling period.</p>

<h3 id="flat-trim">Flat Trim</h3>

<p>Calling <code>ardrone/flattrim</code> service without any parameter will send a "Flat Trim" request to AR-Drone to re-calibrate its rotation estimates assuming that it is on a flat surface. Do not call this service while Drone is flying or while the drone is not actually on a flat surface.</p>

<h3 id="record-to-usb-stick">Record to USB Stick</h3>

<p>Calling <code>ardrone/setrecord</code> service will enable and disable recording to the USB stick. The service takes a simple <code>1</code> to enable or <code>0</code> to disable. So you can turn on recording to the USB stick with <code>rosservice call /ardrone/setrecord 1</code></p>

<h2 id="parameters">Parameters</h2>

<h3 id="ar-drone-specific-parameters">AR-Drone Specific Parameters</h3>

<p>The parameters listed below are named according to AR-Drone's SDK 2.0 configuration. Unless you set the parameters using <code>rosparam</code> or in your <code>launch</code> file, the default values will be used. These values are applied during driver's initialization phase. Please refer to AR-Drone SDK 2.0's <a href="https://projects.ardrone.org/projects/show/ardrone-api/">developer's guide</a> for information about valid values. Not all the parameters will be needed during regular usage of the AR-Drone, please consult the example launch file <code>launch/ardrone.launch</code> for frequent parameters.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">altitude, altitude_max, altitude_min, ardrone_name, autonomous_flight, bitrate, bitrate_ctrl_mode, 
bitrate_storage, codec_fps, com_watchdog, control_iphone_tilt, control_level, control_vz_max, 
control_yaw, detect_type, detections_select_h, detections_select_v, detections_select_v_hsync, 
enemy_colors, enemy_without_shell, euler_angle_max, flight_anim, flight_without_shell, flying_mode, 
groundstripe_colors, hovering_range, indoor_control_vz_max, indoor_control_yaw, indoor_euler_angle_max, 
latitude, leds_anim, longitude, manual_trim, max_bitrate, max_size, navdata_demo, navdata_options, 
nb_files, outdoor, outdoor_control_vz_max, outdoor_control_yaw, outdoor_euler_angle_max, output, 
owner_mac, ssid_multi_player, ssid_single_player, travelling_enable, travelling_mode, ultrasound_freq, 
ultrasound_watchdog, userbox_cmd, video_channel, video_codec, video_enable, video_file_index, 
video_live_socket, video_on_usb, video_slices, vision_enable, wifi_mode, wifi_rate
</code></pre></div>
<p><a href="https://github.com/AutonomyLab/ardrone_autonomy/wiki/AR-Drone-Parameters">This wiki page</a> includes more information about each of above parameters.</p>

<h3 id="other-parameters">Other Parameters</h3>

<p>These parameters control the behaviour of the driver.</p>

<ul>
<li>
<code>drone_frame_id</code> - The "frame_id" prefix to be used in all <code>tf</code> frame names - default: "ardrone_base"</li>
<li>
<code>root_frame</code> - The default root in drone's <code>tf</code> tree (0: _link, 1: _frontcam, 2: _bottomcam) - Default: 0</li>
<li>
<code>cov/imu_la</code>, <code>cov/imu_av</code> &amp; <code>cov/imu_or</code>: List of 9 covariance values to be used in <code>imu</code>'s topic linear acceleration, angular velocity and orientation fields respectively - Default: 0.0 for all members (Please check the FAQ section for a sample launch file that shows how to set these values)</li>
<li>
<code>do_imu_calibration</code>: [EXPERIMENTAL] Should the drone cancel the biases in IMU data - Default: 0</li>
<li>
<code>enable_legacy_navdata</code>: Enable legacy <code>Navdata</code> publish - Default: True</li>
</ul>
<h2 id="license">License</h2>

<p>The Parrot's license, copyright and disclaimer for <code>ARDroneLib</code> are included with the package and can be found in <code>ParrotLicense.txt</code> and <code>ParrotCopyrightAndDisclaimer.txt</code> files respectively. The other parts of the code are subject to <code>BSD</code> license.</p>

<h2 id="contributors">Contributors</h2>

<p><a href="http://autonomylab.org/ardrone_autonomy/contribution.html">List of all commiters to the repository</a>.</p>

<ul>
<li>
<a href="https://github.com/mikehamer">Mike Hamer</a> - Added support for proper SDK2 way of configuring the Drone via parameter (critical bug fix) (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/26">More Info</a>). Support for zero-command without hovering (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/34">More info</a>). Full configurable Navdata support (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/31">More info</a>). Support for Real-time navdata and video publishing (<a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/44">More info</a>). Support for configurable data publishing rate.</li>
<li><a href="https://github.com/JakobEngel">Jacokb Engel</a></li>
<li>
<a href="https://github.com/sameerparekh">Sameer Parekh</a> - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/53">Turn on and off USB stick recording</a> - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/25">Seperate Magnetometer Topic</a>
</li>
<li>
<a href="https://github.com/devmax">Devmax</a> - <a href="https://github.com/AutonomyLab/ardrone_autonomy/issues/18">Flat Trim</a> + Various
comments for enhancements</li>
<li>
<a href="https://github.com/younata">Rachel Brindle</a> - <a href="https://github.com/AutonomyLab/ardrone_autonomy/pull/2">Enhanced Navdata for AR-Drone 2.0</a>
</li>
</ul>
<h2 id="faq">FAQ</h2>

<h3 id="where-should-i-go-next?-is-there-any-ros-package-or-stack-that-can-be-used-as-a-tutorial/sample-to-use-ardrone_autonomy?">Where should I go next? Is there any ROS package or stack that can be used as a tutorial/sample to use ardrone_autonomy?</h3>

<p>Absolutely. Here are some examples:</p>

<ul>
<li><a href="https://github.com/FalkorSystems/falkor_ardrone">falkor_ardrone</a></li>
</ul>
<p>"falkor_ardrone" is a ROS package which uses the "ardrone_autonomy" package to implement autonomous control functionality on an AR.Drone.</p>

<ul>
<li><a href="http://www.ros.org/wiki/tum_ardrone">tum_ardrone</a></li>
</ul>
<p>State Estimation, Autopilot and GUI for ardrone.</p>

<ul>
<li><a href="https://github.com/parcon/arl_ardrone_examples">arl_ardrone_examples</a></li>
</ul>
<p>This ROS stack includes a series of very basic nodes to show users how to develop applications that use the ardrone_autonomy drivers for the AR drone 1.0 and 2.0 quadrotor robot.</p>

<ul>
<li><a href="https://github.com/mikehamer/ardrone_tutorials">AR Drone Tutorials</a></li>
</ul>
<p>This repository contains the source-code for the Up and flying with the AR.Drone and ROS tutorial series, published on <a href="http://www.robohub.org">Robohub</a>.</p>

<h3 id="how-can-i-report-a-bug,-submit-patches-or-ask-for-a-feature?">How can I report a bug, submit patches or ask for a feature?</h3>

<p><code>github</code> offers a nice and convenient issue tracking and social coding platform, it can be used for bug reports and pull/feature request. This is the preferred method. You can also contact the author directly.</p>

<p>If you want to submit a pull request, please submit to <code>dev-unstable</code> branch.</p>

<h3 id="why-the-ardronelib-has-been-patched?">Why the <code>ARDroneLib</code> has been patched?</h3>

<p>The ARDrone 2.0 SDK has been patched to 1) Enable the lib only build 2) Make its command parsing compatible with ROS and 3) To fix its weird <code>main()</code> function issue</p>

<h3 id="why-the-wifi-bandwidth-usage-is-too-much?">Why the wifi bandwidth usage is too much?</h3>

<p>The driver has been configured by default to use the maximum bandwidth allowed to ensure the best quality video stream possible (please take a look at default values in parameters section). That is the reason why the picture quality received from Drone 2.0 using this driver is far better than what you usually get using other software. If for any reason you prefer the lower quality* video stream, change <code>bitrate_ctrl_mode</code>, <code>max_bitrate</code> and <code>bitrate</code> parameters to the default values provided by the AR-Drone developer guide.</p>

<p>(*) Please note that lower quality does not mean lower resolution. By configuring AR-Drone to use bitrate control with limits, the picture gets blurry when there is a movement.</p>

<h3 id="what-is-the-default-configuration-for-the-front-camera-video-stream?">What is the default configuration for the front camera video stream?</h3>

<p><em>Drone 1</em>: 320x240@15fps UVLC Codec
<em>Drone 2</em>: 640x360@20fps H264 codec with no record stream</p>

<h3 id="how-can-i-extract-camera-information-and-tag-type-from-tags_type[]?">How can I extract camera information and tag type from <code>tags_type[]</code>?</h3>

<p><code>tag_type</code> contains information for both source and type of each detected tag. In order to extract information from them you can use the following c macros and enums (taken from <code>ardrone_api.h</code>)</p>
<div class="highlight"><pre><code class="language-c++" data-lang="c++"><span class="cp">#define DETECTION_EXTRACT_SOURCE(type)  ( ((type)&gt;&gt;16) &amp; 0x0FF )</span>
<span class="cp">#define DETECTION_EXTRACT_TAG(type)     ( (type) &amp; 0x0FF )</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <span class="n">DETECTION_SOURCE_CAMERA_HORIZONTAL</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>   <span class="cm">/*&lt;! Tag was detected on the front camera picture */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_VERTICAL</span><span class="p">,</span>       <span class="cm">/*&lt;! Tag was detected on the vertical camera picture at full speed */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_VERTICAL_HSYNC</span><span class="p">,</span> <span class="cm">/*&lt;! Tag was detected on the vertical camera picture inside the horizontal pipeline */</span>
  <span class="n">DETECTION_SOURCE_CAMERA_NUM</span><span class="p">,</span>
<span class="p">}</span> <span class="n">DETECTION_SOURCE_CAMERA</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <span class="n">TAG_TYPE_NONE</span>             <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">TAG_TYPE_SHELL_TAG</span>        <span class="p">,</span>
  <span class="n">TAG_TYPE_ROUNDEL</span>          <span class="p">,</span>
  <span class="n">TAG_TYPE_ORIENTED_ROUNDEL</span> <span class="p">,</span>
  <span class="n">TAG_TYPE_STRIPE</span>           <span class="p">,</span>
  <span class="n">TAG_TYPE_CAP</span>              <span class="p">,</span>
  <span class="n">TAG_TYPE_SHELL_TAG_V2</span>     <span class="p">,</span>
  <span class="n">TAG_TYPE_TOWER_SIDE</span>       <span class="p">,</span>
  <span class="n">TAG_TYPE_BLACK_ROUNDEL</span>    <span class="p">,</span>
  <span class="n">TAG_TYPE_NUM</span>
<span class="p">}</span> <span class="n">TAG_TYPE</span><span class="p">;</span>
</code></pre></div>
<h3 id="how-can-i-calibrate-the-ardrone-front/bottom-camera?">How can I calibrate the ardrone front/bottom camera?</h3>

<p>It is easy to calibrate both cameras using ROS <a href="http://www.ros.org/wiki/camera_calibration">Camera Calibration</a> package.</p>

<p>First, run the camera_calibration node with appropriate arguments: (For the bottom camera, replace front with bottom)</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">rosrun camera_calibration cameracalibrator.py --size <span class="o">[</span>SIZE<span class="o">]</span> --square <span class="o">[</span>SQUARESIZE<span class="o">]</span> image:<span class="o">=</span>/ardrone/front/image_raw camera:<span class="o">=</span>/ardrone/front
</code></pre></div>
<p>After successful calibration, press the <code>commit</code> button in the UI. The driver will receive the data from the camera calibration node, then will save the information by default in <code>~/.ros/camera_info/ardrone_front.yaml</code>. From this point on, whenever you run the driver on the same computer this file will be loaded automatically by the driver and its information will be published to appropriate <code>camera_info</code> topic. Sample calibration files for AR-Drone 2.0's cameras are provided in <code>data/camera_info</code> folder.</p>

<h3 id="can-i-see-a-sample-ardrone-node-in-a-launch-file-to-learn-how-to-set-parameters?">Can I see a sample ardrone node in a launch file to learn how to set parameters?</h3>

<p>Yes, you can check the <code>launch</code> folder for sample lanuch file.</p>

<h3 id="can-i-control-multiple-drones-using-a-single-pc?-or-can-i-make-my-drone-connect-to-a-wireless-router?">Can I control multiple drones using a single PC? or can I make my drone connect to a wireless router?</h3>

<p>With some hacking yes! This <a href="https://github.com/AutonomyLab/ardrone_autonomy/wiki/Multiple-AR-Drones">wiki page</a> contains some information regarding this issue.</p>

<h3 id="how-to-re-compile-parrot-sdk?">How to re-compile parrot SDK?</h3>

<p>If the <code>git</code> updates include a SDK upgrade, you'd better cleanup previous vuild files.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd </span>ARDroneLib/Soft/Build
make clean
rm -rf targets_versions
</code></pre></div>
<p>Build the SDK and driver again.</p>

<h2 id="todo">TODO</h2>

<ul>
<li>Make the <code>tf</code> publish optional.</li>
<li>Add the currently selected camera name to <code>Navdata</code>
</li>
<li>[DONE] Add separate topic for drone's debug stream (<code>navdata_demo</code>)</li>
<li>[DONE] Make the <code>togglecam</code> service accept parameters</li>
<li>[DONE] Enrich <code>Navdata</code> with magneto meter and baro meter information</li>
</ul>
</div></body></html>

            
          </div>
        </div>
      
    </div>
  </div>

  <div class="distro distro-electric">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>electric</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>

  <div class="distro distro-diamondback">
    <div class="container-fluid">
      
        <div class="alert alert-warning" role="alert">No version for distro <strong>diamondback</strong>. Known supported distros are highlighted in the buttons above.</div>
      
    </div>
  </div>


<script src="/js/distro_switch.js"></script>

      </div>
    </div>

    <footer class="site-footer">
  <div class="wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-4 col-md-4">
          
            <a href="https://github.com/rosindex">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>

            <span class="username">rosindex</span>
          </a>
          |
          <em>generated on 2015-01-30</em>
        
        </div>
        <div class="col-sm-8 col-md-8 text-right">
          <p class="text">a community-maintained index of robotics software
 | <a href="/privacy.txt">privacy</a></p>
        </div>
      </div>
    </div>
  </div>

</footer>


  </body>

</html>
